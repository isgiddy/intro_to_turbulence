
<!DOCTYPE html>


<html lang="en" data-content_root="./" >

  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=device-width, initial-scale=1" />

    <title>Assignment: The observation and interpretation of turbulence dissipation &#8212; A brief introduction to turbulence in the ocean</title>
  
  
  
  <script data-cfasync="false">
    document.documentElement.dataset.mode = localStorage.getItem("mode") || "";
    document.documentElement.dataset.theme = localStorage.getItem("theme") || "";
  </script>
  
  <!-- Loaded before other Sphinx assets -->
  <link href="_static/styles/theme.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
<link href="_static/styles/bootstrap.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
<link href="_static/styles/pydata-sphinx-theme.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />

  
  <link href="_static/vendor/fontawesome/6.5.2/css/all.min.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
  <link rel="preload" as="font" type="font/woff2" crossorigin href="_static/vendor/fontawesome/6.5.2/webfonts/fa-solid-900.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="_static/vendor/fontawesome/6.5.2/webfonts/fa-brands-400.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="_static/vendor/fontawesome/6.5.2/webfonts/fa-regular-400.woff2" />

    <link rel="stylesheet" type="text/css" href="_static/pygments.css?v=03e43079" />
    <link rel="stylesheet" type="text/css" href="_static/styles/sphinx-book-theme.css?v=eba8b062" />
    <link rel="stylesheet" type="text/css" href="_static/togglebutton.css?v=13237357" />
    <link rel="stylesheet" type="text/css" href="_static/copybutton.css?v=76b2166b" />
    <link rel="stylesheet" type="text/css" href="_static/mystnb.4510f1fc1dee50b3e5859aac5469c37c29e427902b24a333a5f9fcb2f0b3ac41.css?v=be8a1c11" />
    <link rel="stylesheet" type="text/css" href="_static/sphinx-thebe.css?v=4fa983c6" />
    <link rel="stylesheet" type="text/css" href="_static/sphinx-design.min.css?v=95c83b7e" />
  
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="_static/scripts/bootstrap.js?digest=dfe6caa3a7d634c4db9b" />
<link rel="preload" as="script" href="_static/scripts/pydata-sphinx-theme.js?digest=dfe6caa3a7d634c4db9b" />
  <script src="_static/vendor/fontawesome/6.5.2/js/all.min.js?digest=dfe6caa3a7d634c4db9b"></script>

    <script src="_static/documentation_options.js?v=9eb32ce0"></script>
    <script src="_static/doctools.js?v=9a2dae69"></script>
    <script src="_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="_static/clipboard.min.js?v=a7894cd8"></script>
    <script src="_static/copybutton.js?v=f281be69"></script>
    <script src="_static/scripts/sphinx-book-theme.js?v=887ef09a"></script>
    <script>let toggleHintShow = 'Click to show';</script>
    <script>let toggleHintHide = 'Click to hide';</script>
    <script>let toggleOpenOnPrint = 'true';</script>
    <script src="_static/togglebutton.js?v=4a39c7ea"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script src="_static/design-tabs.js?v=f930bc37"></script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"; const thebe_selector = ".thebe,.cell"; const thebe_selector_input = "pre"; const thebe_selector_output = ".output, .cell_output"</script>
    <script async="async" src="_static/sphinx-thebe.js?v=c100c467"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"; const thebe_selector = ".thebe,.cell"; const thebe_selector_input = "pre"; const thebe_selector_output = ".output, .cell_output"</script>
    <script>window.MathJax = {"options": {"processHtmlClass": "tex2jax_process|mathjax_process|math|output_area"}}</script>
    <script defer="defer" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <script>DOCUMENTATION_OPTIONS.pagename = 'obs_of_shear';</script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="References" href="references.html" />
    <link rel="prev" title="The importance of turbulence in the ocean" href="role_of_turbulence.html" />
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta name="docsearch:language" content="en"/>
  </head>
  
  
  <body data-bs-spy="scroll" data-bs-target=".bd-toc-nav" data-offset="180" data-bs-root-margin="0px 0px -60%" data-default-mode="">

  
  
  <div id="pst-skip-link" class="skip-link d-print-none"><a href="#main-content">Skip to main content</a></div>
  
  <div id="pst-scroll-pixel-helper"></div>
  
  <button type="button" class="btn rounded-pill" id="pst-back-to-top">
    <i class="fa-solid fa-arrow-up"></i>Back to top</button>

  
  <input type="checkbox"
          class="sidebar-toggle"
          id="pst-primary-sidebar-checkbox"/>
  <label class="overlay overlay-primary" for="pst-primary-sidebar-checkbox"></label>
  
  <input type="checkbox"
          class="sidebar-toggle"
          id="pst-secondary-sidebar-checkbox"/>
  <label class="overlay overlay-secondary" for="pst-secondary-sidebar-checkbox"></label>
  
  <div class="search-button__wrapper">
    <div class="search-button__overlay"></div>
    <div class="search-button__search-container">
<form class="bd-search d-flex align-items-center"
      action="search.html"
      method="get">
  <i class="fa-solid fa-magnifying-glass"></i>
  <input type="search"
         class="form-control"
         name="q"
         id="search-input"
         placeholder="Search this book..."
         aria-label="Search this book..."
         autocomplete="off"
         autocorrect="off"
         autocapitalize="off"
         spellcheck="false"/>
  <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd>K</kbd></span>
</form></div>
  </div>

  <div class="pst-async-banner-revealer d-none">
  <aside id="bd-header-version-warning" class="d-none d-print-none" aria-label="Version warning"></aside>
</div>

  
    <header class="bd-header navbar navbar-expand-lg bd-navbar d-print-none">
    </header>
  

  <div class="bd-container">
    <div class="bd-container__inner bd-page-width">
      
      
      
      <div class="bd-sidebar-primary bd-sidebar">
        

  
  <div class="sidebar-header-items sidebar-primary__section">
    
    
    
    
  </div>
  
    <div class="sidebar-primary-items__start sidebar-primary__section">
        <div class="sidebar-primary-item">

  
    
  

<a class="navbar-brand logo" href="intro.html">
  
  
  
  
  
    
    
      
    
    
    <img src="_static/logo.png" class="logo__image only-light" alt="A brief introduction to turbulence in the ocean - Home"/>
    <script>document.write(`<img src="_static/logo.png" class="logo__image only-dark" alt="A brief introduction to turbulence in the ocean - Home"/>`);</script>
  
  
</a></div>
        <div class="sidebar-primary-item">

 <script>
 document.write(`
   <button class="btn search-button-field search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass"></i>
    <span class="search-button__default-text">Search</span>
    <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd class="kbd-shortcut__modifier">K</kbd></span>
   </button>
 `);
 </script></div>
        <div class="sidebar-primary-item"><nav class="bd-links bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item navbar-nav active">
        
        <ul class="nav bd-sidenav bd-sidenav__home-link">
            <li class="toctree-l1">
                <a class="reference internal" href="intro.html">
                    An introduction to observing turbulence in the ocean
                </a>
            </li>
        </ul>
        <ul class="current nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="what_is_turbulence.html">What is turbulence</a></li>
<li class="toctree-l1"><a class="reference internal" href="equations_of_motion.html">Predicting turbulent flows</a></li>
<li class="toctree-l1"><a class="reference internal" href="observing_turbulence.html">Observing turbulence</a></li>
<li class="toctree-l1"><a class="reference internal" href="boundary_layer_turbulence.html">Boundary Layer Turbulence</a></li>
<li class="toctree-l1"><a class="reference internal" href="role_of_turbulence.html">The importance of turbulence in the ocean</a></li>
<li class="toctree-l1 current active"><a class="current reference internal" href="#">Assignment: The observation and interpretation of turbulence dissipation</a></li>
<li class="toctree-l1"><a class="reference internal" href="references.html">References</a></li>
</ul>

    </div>
</nav></div>
    </div>
  
  
  <div class="sidebar-primary-items__end sidebar-primary__section">
  </div>
  
  <div id="rtd-footer-container"></div>


      </div>
      
      <main id="main-content" class="bd-main" role="main">
        
        

<div class="sbt-scroll-pixel-helper"></div>

          <div class="bd-content">
            <div class="bd-article-container">
              
              <div class="bd-header-article d-print-none">
<div class="header-article-items header-article__inner">
  
    <div class="header-article-items__start">
      
        <div class="header-article-item"><button class="sidebar-toggle primary-toggle btn btn-sm" title="Toggle primary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
  <span class="fa-solid fa-bars"></span>
</button></div>
      
    </div>
  
  
    <div class="header-article-items__end">
      
        <div class="header-article-item">

<div class="article-header-buttons">





<div class="dropdown dropdown-source-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Source repositories">
    <i class="fab fa-github"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="https://github.com/isgiddy/intro_to_turbulence" target="_blank"
   class="btn btn-sm btn-source-repository-button dropdown-item"
   title="Source repository"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fab fa-github"></i>
  </span>
<span class="btn__text-container">Repository</span>
</a>
</li>
      
      
      
      
      <li><a href="https://github.com/isgiddy/intro_to_turbulence/issues/new?title=Issue%20on%20page%20%2Fobs_of_shear.html&body=Your%20issue%20content%20here." target="_blank"
   class="btn btn-sm btn-source-issues-button dropdown-item"
   title="Open an issue"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-lightbulb"></i>
  </span>
<span class="btn__text-container">Open issue</span>
</a>
</li>
      
  </ul>
</div>






<div class="dropdown dropdown-download-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Download this page">
    <i class="fas fa-download"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="_sources/obs_of_shear.ipynb" target="_blank"
   class="btn btn-sm btn-download-source-button dropdown-item"
   title="Download source file"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file"></i>
  </span>
<span class="btn__text-container">.ipynb</span>
</a>
</li>
      
      
      
      
      <li>
<button onclick="window.print()"
  class="btn btn-sm btn-download-pdf-button dropdown-item"
  title="Print to PDF"
  data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file-pdf"></i>
  </span>
<span class="btn__text-container">.pdf</span>
</button>
</li>
      
  </ul>
</div>




<button onclick="toggleFullScreen()"
  class="btn btn-sm btn-fullscreen-button"
  title="Fullscreen mode"
  data-bs-placement="bottom" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-expand"></i>
  </span>

</button>



<script>
document.write(`
  <button class="btn btn-sm nav-link pst-navbar-icon theme-switch-button" title="light/dark" aria-label="light/dark" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="theme-switch fa-solid fa-sun fa-lg" data-mode="light"></i>
    <i class="theme-switch fa-solid fa-moon fa-lg" data-mode="dark"></i>
    <i class="theme-switch fa-solid fa-circle-half-stroke fa-lg" data-mode="auto"></i>
  </button>
`);
</script>


<script>
document.write(`
  <button class="btn btn-sm pst-navbar-icon search-button search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass fa-lg"></i>
  </button>
`);
</script>
<button class="sidebar-toggle secondary-toggle btn btn-sm" title="Toggle secondary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="fa-solid fa-list"></span>
</button>
</div></div>
      
    </div>
  
</div>
</div>
              
              

<div id="jb-print-docs-body" class="onlyprint">
    <h1>Assignment: The observation and interpretation of turbulence dissipation</h1>
    <!-- Table of contents -->
    <div id="print-main-content">
        <div id="jb-print-toc">
            
            <div>
                <h2> Contents </h2>
            </div>
            <nav aria-label="Page">
                <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#part-i">Part I</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#baltic-sea-a-quiescent-region">Baltic Sea - A quiescent region</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#plot-vertical-profile-of-temperature">Plot vertical profile of temperature</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#plot-time-series">Plot time series</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#create-model-nasmyth-spectra-for-chosen-dissipation-rates-in-the-data">Create model Nasmyth Spectra for chosen dissipation rates in the data</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#dissipation-estimates-from-shear-spectra">Dissipation estimates from shear spectra</a></li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#haro-straight-a-tidal-channel">Haro Straight - A tidal channel.</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#plot-vertical-profile-of-temperature-salinity-and-density">Plot vertical profile of temperature, salinity and density</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#id4">Plot time series</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#id5">Create model Nasmyth Spectra for chosen dissipation rates in the data</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#id6">Dissipation estimates from shear spectra</a></li>
</ul>
</li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#part-ii">Part II</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#weddell-sea">Weddell Sea</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#plot-vertical-profile-of-temperature-salinity-density-and-vertical-stratification">Plot vertical profile of temperature, salinity, density and vertical stratification</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#id8">Plot time series</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#id9">Create model Nasmyth Spectra for chosen dissipation rates in the data</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#id10">Dissipation estimates from shear spectra</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#compute-the-vertical-turbulent-heat-flux">Compute the vertical turbulent heat flux</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#compare-the-law-of-the-wall-model-for-turbulent-dissipation-in-a-boundary-layer-with-the-observations">Compare the law-of-the-wall model for turbulent dissipation in a boundary layer with the observations</a></li>
</ul>
</li>
</ul>
</li>
</ul>
            </nav>
        </div>
    </div>
</div>

              
                
<div id="searchbox"></div>
                <article class="bd-article">
                  
  <section class="tex2jax_ignore mathjax_ignore" id="assignment-the-observation-and-interpretation-of-turbulence-dissipation">
<h1>Assignment: The observation and interpretation of turbulence dissipation<a class="headerlink" href="#assignment-the-observation-and-interpretation-of-turbulence-dissipation" title="Link to this heading">#</a></h1>
<p>Turbulent flow is ubiquitous, but not homogeneously distributed.</p>
<p>One method for observing turbulence is the observation of microstructure shear, from which the rate of turbulence dissipation can be directly computed. Such observations are crucial for understanding the contributions of various sources of turbulence production in the ocean, the turbulence flux of properties and the processes by which TKE is dissipated.</p>
<p>In this assignment, you will become familiar with the analysis of profiles of the dissipation rate of TKE under a range of forcing conditions.</p>
<p>Best practices for the processing of microstructure shear data are described in <span id="id1">[<a class="reference internal" href="references.html#id4" title="Rolf Lueck, Ilker Fer, Cynthia Bluteau, Marcus Dengler, Peter Holtermann, Ryuichiro Inoue, Arnaud LeBoyer, Sarah-Anne Nicholson, Kirstin Schulz, and Craig Stevens. Best practices recommendations for estimating dissipation rates from shear probes. Frontiers in Marine Science, 11:1334327, 2024. URL: https://www.frontiersin.org/articles/10.3389/fmars.2024.1334327/full (visited on 2025-02-18), doi:10.3389/fmars.2024.1334327.">LFB+24</a>]</span></p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span><span class="w"> </span><span class="nn">numpy</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">np</span> 
<span class="kn">import</span><span class="w"> </span><span class="nn">matplotlib.pyplot</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">plt</span> 
<span class="kn">import</span><span class="w"> </span><span class="nn">xarray</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">xr</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">pandas</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">pd</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">gsw</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># A function we will use later</span>

<span class="k">def</span><span class="w"> </span><span class="nf">Nasfunc</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="n">eps</span><span class="p">,</span><span class="n">vis</span><span class="o">=</span><span class="mf">1.6e-6</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot; out=Nasfunc(x,eps,vis)</span>
<span class="sd">     x is the wavenumber, eps is the dissipation</span>
<span class="sd">     returns the Nasmyth&#39;s dissipation spectrum.</span>
<span class="sd">     The function form is given in Lueck et</span>
<span class="sd">     J. Oceanogr. 2002.</span>
<span class="sd">     default vis=1.6e-6 #m2/s kinematic viscocity</span>
<span class="sd">     See also Nasfunc_log&quot;&quot;&quot;</span>

    <span class="n">ks</span> <span class="o">=</span> <span class="p">(</span><span class="n">eps</span><span class="o">*</span><span class="p">(</span><span class="n">vis</span><span class="o">**-</span><span class="mi">3</span><span class="p">))</span><span class="o">**</span><span class="p">(</span><span class="mi">1</span><span class="o">/</span><span class="mi">4</span><span class="p">)</span>
    <span class="n">x1</span><span class="o">=</span> <span class="n">x</span><span class="o">/</span><span class="n">ks</span>

    <span class="c1">#fit provided by Fabian Wolk -see Lueck et al paper in J. Oceanogr. 2002</span>
    <span class="n">G</span><span class="o">=</span><span class="p">(</span><span class="mf">8.05</span><span class="o">*</span><span class="p">(</span><span class="n">x1</span><span class="o">**</span><span class="p">(</span><span class="mi">1</span><span class="o">/</span><span class="mi">3</span><span class="p">)))</span> <span class="o">/</span> <span class="p">(</span><span class="mi">1</span><span class="o">+</span> <span class="p">((</span><span class="mi">20</span><span class="o">*</span><span class="n">x1</span><span class="p">)</span><span class="o">**</span><span class="mf">3.7</span><span class="p">))</span>
    <span class="k">return</span> <span class="p">((</span><span class="n">ks</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span><span class="o">*</span><span class="p">((</span><span class="n">eps</span><span class="o">*</span><span class="p">(</span><span class="n">vis</span><span class="o">**</span><span class="mi">5</span><span class="p">))</span><span class="o">**</span><span class="p">(</span><span class="mi">1</span><span class="o">/</span><span class="mi">4</span><span class="p">)))</span><span class="o">*</span><span class="n">G</span>   <span class="c1">#in s-2/cpm</span>
</pre></div>
</div>
</div>
</div>
<section id="part-i">
<h2>Part I<a class="headerlink" href="#part-i" title="Link to this heading">#</a></h2>
<p>Become familiar with the observation of microstructure shear</p>
<section id="baltic-sea-a-quiescent-region">
<h3>Baltic Sea - A quiescent region<a class="headerlink" href="#baltic-sea-a-quiescent-region" title="Link to this heading">#</a></h3>
<figure class="align-center" id="fig-mss">
<a class="reference internal image-reference" href="_images/microstructure_probe_mss.png"><img alt="_images/microstructure_probe_mss.png" src="_images/microstructure_probe_mss.png" style="width: 15%;" />
</a>
<figcaption>
<p><span class="caption-number">Fig. 23 </span><span class="caption-text">A Sea and Sun Technology Microstructure Probe.</span><a class="headerlink" href="#fig-mss" title="Link to this image">#</a></p>
</figcaption>
</figure>
<p>This dataset can be downloaded here:</p>
<p>Holtermann, P. ATOMIX shear probes benchmark data: Example microstructure data from a Sea &amp; Sun Technology MSS microstructure profiler, Bornholm Basin, Baltic Sea. NERC EDS British Oceanographic Data Centre NOC., <a class="reference external" href="https://doi.org/10.5285/0e35f96f-57e3-540b-e063-6c86abc06660">https://doi.org/10.5285/0e35f96f-57e3-540b-e063-6c86abc06660</a> (2024).</p>
<p>The Baltic Sea profile was taken in September 2008 in the Bornholm Basin from the Research Vessel Poseidon. The oceanographic context and a detailed analysis of the data collected during this cruise are given in van der Lee and Umlauf (2011). The total depth was about 85 m. The instrument used was a MSS-Microstructure profiler with the serial number 38, produced by Sea &amp; Sun Technology, Germany. It was equipped with two randomly oriented shear probes, one FP07 thermistor, and one PT100 temperature sensor and a conductivity cell for precision temperature and salinity measurements. The probe was also fitted with a vibration sensor, which is similar in design to a shear probe sensor, except that the airfoil is replaced by a small mass and is mounted inside the probe. The probe was connected with a cable to a ship-board data acquisition system and was operated with an electrical winch from the stern of the ship. During the profiling, the ship slowly moved along a transect with a speed of approximately 0.5 m s−1. The transect was oriented such that wind and surface currents came from the bow, such that the loosely tethered cable was always at a safe distance to the ship’s propeller. Using a sensor protection cage, it was possible to obtain nearly full-depth vertical profiles to within 0.1 m above the seafloor, with a descent speed of approximately 0.5 m s−1 .</p>
<p><strong>First we will take a look at a few metrics to get familiar with dissipation data</strong></p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># The data is stored as a grouped NetCDF file.</span>
<span class="c1"># First look at the global attributes.</span>
<span class="n">dat_b</span><span class="o">=</span><span class="n">xr</span><span class="o">.</span><span class="n">open_dataset</span><span class="p">(</span><span class="s1">&#39;assignment/baltic/MSS_Baltic.nc&#39;</span><span class="p">,</span> <span class="n">engine</span><span class="o">=</span><span class="s2">&quot;h5netcdf&quot;</span><span class="p">,</span><span class="n">group</span><span class="o">=</span><span class="s2">&quot;&quot;</span><span class="p">)</span>
<span class="n">dat_b</span><span class="o">.</span><span class="n">attrs</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>{&#39;title&#39;: &#39;Example microstructure data from a Sea &amp; Sun Technology MSS microstructure profiler&#39;,
 &#39;summary&#39;: &#39;Vertical microstructure profile&#39;,
 &#39;comment&#39;: &#39;The profile was collected on 20-Sep-2008 during the cruise POS373 onboard R.V. Poseidon, using the tethered free-fall MSS90-L profiler (Sea &amp; Sun Technology, Germany, SN038). The dissipation rate was measured using two airfoil shear probes. In addition a fast-response FP07 thermistor, pressure, temperature, conductivity, vibration and oxygen sensors were mounted. All sensor were sampled with 1024 Hz. The processing of the data and the format of this data set follows the recommendations and guidelines of the SCOR Working Group #160, ATOMIX (https://wiki.uib.no/atomix). The netCDF file includes four hierarchical groups, corresponding to the four levels of microstructure data in the ATOMIX format. L1_converted : time series from all sensors converted into physical units L2_cleaned : selected signals that are filtered and/or despiked before spectral analysis. Time stamp and length of the signals are the same as in L1. L3_spectra : wavenumber spectra from shear probes and vibration sensors L4_dissipation: dissipation estimates together with quality control parameters L2_cleaned time series used for spectral analysis are marked with section numbers.&#39;,
 &#39;platform_type&#39;: &#39;research vessel&#39;,
 &#39;creation_time&#39;: &#39;2024-01-17T15:18:42Z&#39;,
 &#39;date_update&#39;: &#39;2024-01-17T15:18:42Z&#39;,
 &#39;date_created&#39;: &#39;2024-01-17&#39;,
 &#39;time_reference_year&#39;: np.float64(2008.0),
 &#39;fs_fast&#39;: np.float64(1024.0),
 &#39;fs_ctd&#39;: np.float64(1024.0),
 &#39;profiling_direction&#39;: &#39;vertical&#39;,
 &#39;HP_cut&#39;: np.float64(0.15),
 &#39;despike_shear_fraction_limit&#39;: np.float64(0.05),
 &#39;FOM_limit&#39;: np.float64(1.15),
 &#39;despike_iterations_limit&#39;: np.float64(8.0),
 &#39;diss_ratio_limit&#39;: np.float64(2.77),
 &#39;variance_resolved_limit&#39;: np.float64(0.5),
 &#39;fft_length&#39;: np.float64(2048.0),
 &#39;diss_length&#39;: np.float64(5120.0),
 &#39;overlap&#39;: np.float64(2560.0),
 &#39;goodman&#39;: np.float64(1.0),
 &#39;geospatial_lat_min&#39;: np.float64(55.235416666666666),
 &#39;geospatial_lat_max&#39;: np.float64(55.235416666666666),
 &#39;geospatial_lon_min&#39;: np.float64(15.978098333333334),
 &#39;geospatial_lon_max&#39;: np.float64(15.978098333333334),
 &#39;geospatial_vertical_min&#39;: np.float64(0.0),
 &#39;geospatial_vertical_max&#39;: np.float64(88.0),
 &#39;geospatial_vertical_positive&#39;: &#39;down&#39;,
 &#39;time_coverage_start&#39;: &#39;2008-09-20T10:50:04Z&#39;,
 &#39;time_coverage_end&#39;: &#39;2008-09-20T10:52:49Z&#39;,
 &#39;conventions&#39;: &#39;CF-1.6, ACDD-1.3, ATOMIX&#39;,
 &#39;history&#39;: &#39;v2.2&#39;,
 &#39;data_mode&#39;: &#39;D&#39;,
 &#39;area&#39;: &#39;western Baltic Sea&#39;,
 &#39;principal_investigator&#39;: &#39;Lars Umlauf&#39;,
 &#39;institution&#39;: &#39;Leibniz Institute for Baltic Sea Research, Warnemuende&#39;,
 &#39;references&#39;: &#39;E. M. van der Lee and L. Umlauf, Internal wave mixing in the Baltic Sea: Near-inertial waves in the absence of tides, Journal of Geophysical Research: Oceans, vol. 116, no. C10, Oct. 2011, doi: 10.1029/2011JC007072.&#39;,
 &#39;authors&#39;: &#39;E. M. van der Lee and L. Umlauf&#39;,
 &#39;contact&#39;: &#39;lars.umlauf@io-warnemuende.de&#39;,
 &#39;project_name&#39;: &#39;SHIC&#39;,
 &#39;cruise&#39;: &#39;POS373&#39;,
 &#39;vessel&#39;: &#39;RV Poseidon&#39;,
 &#39;creator_name&#39;: &#39;Peter Holtermann&#39;,
 &#39;creator_email&#39;: &#39;peter.holtermann@io-warnemuende.de&#39;,
 &#39;license&#39;: &#39;http://creativecommons.org/licenses/by/4.0/&#39;,
 &#39;citation&#39;: &#39;Holtermann, Peter (2024). ATOMIX shear probes benchmark data: Example microstructure data from a Sea &amp; Sun Technology MSS microstructure profiler, Bornholm Basin, Baltic Sea. British Oceanographic Data Centre. DOI: 10.5285/0e35f96f-57e3-540b-e063-6c86abc06660&#39;,
 &#39;DOI&#39;: &#39;10.5285/0e35f96f-57e3-540b-e063-6c86abc06660&#39;}
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># open each group separately</span>

<span class="n">dat_bL1</span><span class="o">=</span><span class="n">xr</span><span class="o">.</span><span class="n">open_dataset</span><span class="p">(</span><span class="s1">&#39;assignment/baltic/MSS_Baltic.nc&#39;</span><span class="p">,</span> <span class="n">engine</span><span class="o">=</span><span class="s2">&quot;h5netcdf&quot;</span><span class="p">,</span><span class="n">group</span><span class="o">=</span><span class="s2">&quot;L1_converted&quot;</span><span class="p">)</span>
<span class="n">dat_bL2</span><span class="o">=</span><span class="n">xr</span><span class="o">.</span><span class="n">open_dataset</span><span class="p">(</span><span class="s1">&#39;assignment/baltic/MSS_Baltic.nc&#39;</span><span class="p">,</span> <span class="n">engine</span><span class="o">=</span><span class="s2">&quot;h5netcdf&quot;</span><span class="p">,</span><span class="n">group</span><span class="o">=</span><span class="s2">&quot;L2_cleaned&quot;</span><span class="p">)</span>
<span class="n">dat_bL3</span><span class="o">=</span><span class="n">xr</span><span class="o">.</span><span class="n">open_dataset</span><span class="p">(</span><span class="s1">&#39;assignment/baltic/MSS_Baltic.nc&#39;</span><span class="p">,</span> <span class="n">engine</span><span class="o">=</span><span class="s2">&quot;h5netcdf&quot;</span><span class="p">,</span><span class="n">group</span><span class="o">=</span><span class="s2">&quot;L3_spectra&quot;</span><span class="p">)</span>
<span class="n">dat_bL4</span><span class="o">=</span><span class="n">xr</span><span class="o">.</span><span class="n">open_dataset</span><span class="p">(</span><span class="s1">&#39;assignment/baltic/MSS_Baltic.nc&#39;</span><span class="p">,</span> <span class="n">engine</span><span class="o">=</span><span class="s2">&quot;h5netcdf&quot;</span><span class="p">,</span><span class="n">group</span><span class="o">=</span><span class="s2">&quot;L4_dissipation&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<section id="plot-vertical-profile-of-temperature">
<h4>Plot vertical profile of temperature<a class="headerlink" href="#plot-vertical-profile-of-temperature" title="Link to this heading">#</a></h4>
<p>1.1 Describe what you can about the hydrographic structure from this plot. Can refer to <span id="id2">[<a class="reference internal" href="references.html#id2" title="E. M. Van der Lee and L. Umlauf. Internal wave mixing in the baltic sea: near-inertial waves in the absence of tides. Journal of Geophysical Research, Oceans, 2011. URL: https://agupubs.onlinelibrary.wiley.com/doi/full/10.1029/2011JC007072.">VdLU11</a>]</span> for context.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">4</span><span class="p">,</span><span class="mi">5</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">dat_bL1</span><span class="o">.</span><span class="n">TEMP_CTD</span><span class="p">,</span><span class="n">dat_bL1</span><span class="o">.</span><span class="n">PRES</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylim</span><span class="p">(</span><span class="mi">90</span><span class="p">,</span><span class="mi">0</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;Pressure [db]&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;Temperature [°C]&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Text(0.5, 0, &#39;Temperature [°C]&#39;)
</pre></div>
</div>
<img alt="_images/3cb10581716655fcefc55f3b059ef34b6be7d3ddf1d92d1c29ca636f70c48113.png" src="_images/3cb10581716655fcefc55f3b059ef34b6be7d3ddf1d92d1c29ca636f70c48113.png" />
</div>
</div>
</section>
<section id="plot-time-series">
<h4>Plot time series<a class="headerlink" href="#plot-time-series" title="Link to this heading">#</a></h4>
<p>Below are time series of a) Pressure and Velocity through water, b) vertical shear, c) platform vibrations and d) turbulence dissipation rate.</p>
<p>1.2) Interpret what might be causing enhanced vibrations in c.<br />
1.3a) Describe the vertical profile of the dissipation rate of turbulence (where dissipation rate is high, where it is low) with reference to the distance from the surface and the temperature profile.<br />
1.3b) Select two points, one with high dissipation rate and one with low dissipation rate and overlay vertical lines at these chosen points in subpanels d).</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">fig</span><span class="p">,</span><span class="n">ax</span><span class="o">=</span><span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">4</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span><span class="mi">8</span><span class="p">),</span><span class="n">sharex</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

<span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">dat_bL1</span><span class="o">.</span><span class="n">TIME</span><span class="p">,</span><span class="n">dat_bL1</span><span class="o">.</span><span class="n">PRES</span><span class="p">,</span><span class="n">lw</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;Pressure [db]&#39;</span><span class="p">)</span>

<span class="n">axa</span><span class="o">=</span><span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">twinx</span><span class="p">()</span>
<span class="n">axa</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">dat_bL1</span><span class="o">.</span><span class="n">TIME</span><span class="p">,</span><span class="n">dat_bL1</span><span class="o">.</span><span class="n">PSPD_REL</span><span class="p">,</span><span class="n">c</span><span class="o">=</span><span class="s1">&#39;tab:orange&#39;</span><span class="p">,</span><span class="n">lw</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
<span class="n">axa</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;W [ms$^{-1}$]&#39;</span><span class="p">,</span><span class="n">c</span><span class="o">=</span><span class="s1">&#39;tab:orange&#39;</span><span class="p">)</span>


<span class="n">ax</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">dat_bL2</span><span class="o">.</span><span class="n">TIME</span><span class="p">,</span><span class="n">dat_bL2</span><span class="o">.</span><span class="n">SHEAR</span><span class="p">[</span><span class="mi">0</span><span class="p">,:])</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">dat_bL2</span><span class="o">.</span><span class="n">TIME</span><span class="p">,</span><span class="n">dat_bL2</span><span class="o">.</span><span class="n">SHEAR</span><span class="p">[</span><span class="mi">1</span><span class="p">,:])</span>

<span class="n">ax</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;$\partial u / \partial z$ [s$^{-1}$]&#39;</span><span class="p">)</span>

<span class="n">ax</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">dat_bL2</span><span class="o">.</span><span class="n">TIME</span><span class="p">,</span><span class="n">dat_bL2</span><span class="o">.</span><span class="n">VIB</span><span class="p">[</span><span class="mi">0</span><span class="p">,:])</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;VIB [ms$^{-2}$]&#39;</span><span class="p">)</span>


<span class="n">ax</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">dat_bL4</span><span class="o">.</span><span class="n">TIME</span><span class="p">,</span><span class="n">dat_bL4</span><span class="o">.</span><span class="n">EPSI</span><span class="p">[</span><span class="mi">0</span><span class="p">,:],</span><span class="n">label</span><span class="o">=</span><span class="sa">r</span><span class="s1">&#39;$\epsilon_1$&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">dat_bL4</span><span class="o">.</span><span class="n">TIME</span><span class="p">,</span><span class="n">dat_bL4</span><span class="o">.</span><span class="n">EPSI</span><span class="p">[</span><span class="mi">1</span><span class="p">,:],</span><span class="n">label</span><span class="o">=</span><span class="sa">r</span><span class="s1">&#39;$\epsilon_2$&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">dat_bL4</span><span class="o">.</span><span class="n">TIME</span><span class="p">,</span><span class="n">dat_bL4</span><span class="o">.</span><span class="n">EPSI_FINAL</span><span class="p">,</span><span class="n">c</span><span class="o">=</span><span class="s1">&#39;k&#39;</span><span class="p">,</span><span class="n">marker</span><span class="o">=</span><span class="s1">&#39;x&#39;</span><span class="p">,</span><span class="n">label</span><span class="o">=</span><span class="sa">r</span><span class="s1">&#39;$\epsilon$&#39;</span><span class="p">)</span>


<span class="c1">### EDIT HERE, only dummies used</span>
<span class="c1"># 1.3b: identify two regions of dissipation (strong versus quiescent) </span>
<span class="n">i</span><span class="o">=</span> <span class="mi">1</span>   <span class="c1"># strong dissipation</span>
<span class="n">j</span><span class="o">=</span> <span class="mi">2</span>   <span class="c1"># weak dissipation</span>

<span class="n">ax</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span><span class="o">.</span><span class="n">axvline</span><span class="p">(</span><span class="n">pd</span><span class="o">.</span><span class="n">to_datetime</span><span class="p">(</span><span class="n">dat_bL4</span><span class="o">.</span><span class="n">TIME</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">),</span><span class="n">c</span><span class="o">=</span><span class="s1">&#39;grey&#39;</span><span class="p">,</span><span class="n">lw</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span><span class="o">.</span><span class="n">axvline</span><span class="p">(</span><span class="n">pd</span><span class="o">.</span><span class="n">to_datetime</span><span class="p">(</span><span class="n">dat_bL4</span><span class="o">.</span><span class="n">TIME</span><span class="p">[</span><span class="n">j</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">),</span><span class="n">c</span><span class="o">=</span><span class="s1">&#39;grey&#39;</span><span class="p">,</span><span class="n">lw</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>

<span class="n">ax</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span><span class="o">.</span><span class="n">set_yscale</span><span class="p">(</span><span class="s1">&#39;log&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;$\epsilon \mathrm{[W kg^{-1}]}$&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;time&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Text(0.5, 0, &#39;time&#39;)
</pre></div>
</div>
<img alt="_images/8a6266afa3b9f6390b49ab0ed84e18cedd9f32e92a1008c7d710b8682a3c738c.png" src="_images/8a6266afa3b9f6390b49ab0ed84e18cedd9f32e92a1008c7d710b8682a3c738c.png" />
</div>
</div>
</section>
<section id="create-model-nasmyth-spectra-for-chosen-dissipation-rates-in-the-data">
<h4>Create model Nasmyth Spectra for chosen dissipation rates in the data<a class="headerlink" href="#create-model-nasmyth-spectra-for-chosen-dissipation-rates-in-the-data" title="Link to this heading">#</a></h4>
<p>1.4) Using the Nasmyth model, create spectra for your selected dissipation rates.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># print dissipation values for chosen spectra and create model nasmyth shear spectra</span>

<span class="n">knas_strong</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">100</span><span class="p">,</span><span class="nb">len</span><span class="p">(</span><span class="n">dat_bL3</span><span class="o">.</span><span class="n">KCYC</span><span class="p">[:,</span><span class="n">i</span><span class="p">]))</span>
<span class="nb">print</span><span class="p">(</span><span class="n">dat_bL4</span><span class="o">.</span><span class="n">EPSI_FINAL</span><span class="p">[</span><span class="n">i</span><span class="p">])</span>
<span class="n">nasmyth_strong</span> <span class="o">=</span> <span class="n">Nasfunc</span><span class="p">(</span><span class="n">knas_strong</span><span class="p">,</span><span class="n">dat_bL4</span><span class="o">.</span><span class="n">EPSI_FINAL</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="n">dat_bL4</span><span class="o">.</span><span class="n">EPSI_FINAL</span><span class="p">[</span><span class="n">j</span><span class="p">])</span>
<span class="n">knas_weak</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">100</span><span class="p">,</span><span class="nb">len</span><span class="p">(</span><span class="n">dat_bL3</span><span class="o">.</span><span class="n">KCYC</span><span class="p">[:,</span><span class="n">j</span><span class="p">]))</span>
<span class="n">nasmyth_weak</span> <span class="o">=</span> <span class="n">Nasfunc</span><span class="p">(</span><span class="n">knas_weak</span><span class="p">,</span><span class="n">dat_bL4</span><span class="o">.</span><span class="n">EPSI_FINAL</span><span class="p">[</span><span class="n">j</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&lt;xarray.DataArray &#39;EPSI_FINAL&#39; ()&gt; Size: 8B
array(7.880893e-08)
Attributes:
    standard_name:  specific_turbulent_kinetic_energy_dissipation_in_sea_water
    units:          W kg-1
    long_name:      dissipation rate of turbulent kinetic energy per unit mas...
&lt;xarray.DataArray &#39;EPSI_FINAL&#39; ()&gt; Size: 8B
array(5.477681e-08)
Attributes:
    standard_name:  specific_turbulent_kinetic_energy_dissipation_in_sea_water
    units:          W kg-1
    long_name:      dissipation rate of turbulent kinetic energy per unit mas...
</pre></div>
</div>
</div>
</div>
</section>
<section id="dissipation-estimates-from-shear-spectra">
<h4>Dissipation estimates from shear spectra<a class="headerlink" href="#dissipation-estimates-from-shear-spectra" title="Link to this heading">#</a></h4>
<p>Look at the agreement between dissipation estimates from the two spectra. Generally, turbulence can be observed to within a factor of two <span id="id3">[<a class="reference internal" href="references.html#id7" title="J.N. Moum, M.C. Gregg, R.C. Lien, and M.E. Carr. Comparison of turbulence kinetic energy dissipation rate estimates from two ocean microstructure profilers. Journal of Atmospheric and Oceanic Technology, 12(2):346–366, 1995.">MGLC95</a>]</span>.</p>
<p>1.5) Plot shear spectra at the two dissipation rates that you chose earlier. How does shear spectra relate to dissipation rates?</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">fig</span><span class="p">,</span><span class="n">ax</span><span class="o">=</span><span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span><span class="mi">4</span><span class="p">))</span>
<span class="n">fig</span><span class="o">.</span><span class="n">subplots_adjust</span><span class="p">(</span><span class="n">wspace</span><span class="o">=</span><span class="mf">0.3</span><span class="p">)</span>

<span class="c1">## Dissipation plot</span>

<span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">dat_bL4</span><span class="o">.</span><span class="n">EPSI</span><span class="p">[</span><span class="mi">0</span><span class="p">,:],</span><span class="n">dat_bL4</span><span class="o">.</span><span class="n">EPSI</span><span class="p">[</span><span class="mi">1</span><span class="p">,:],</span><span class="n">marker</span><span class="o">=</span><span class="s1">&#39;^&#39;</span><span class="p">,</span><span class="n">s</span><span class="o">=</span><span class="mi">5</span><span class="p">)</span>

<span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_yscale</span><span class="p">(</span><span class="s1">&#39;log&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_xscale</span><span class="p">(</span><span class="s1">&#39;log&#39;</span><span class="p">)</span>

<span class="c1"># Define the range for the 1-to-1 and confidence interval lines</span>
<span class="n">x_vals</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">logspace</span><span class="p">(</span><span class="o">-</span><span class="mi">10</span><span class="p">,</span> 
                     <span class="o">-</span><span class="mi">5</span><span class="p">,</span> <span class="mi">100</span><span class="p">)</span>

<span class="c1"># Plot 1:1 line</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x_vals</span><span class="p">,</span> <span class="n">x_vals</span><span class="p">,</span> <span class="s1">&#39;k&#39;</span><span class="p">)</span>

<span class="c1"># Plot factor of 2 confidence intervals</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x_vals</span><span class="p">,</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">x_vals</span><span class="p">,</span> <span class="s1">&#39;k:&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x_vals</span><span class="p">,</span> <span class="mf">0.5</span><span class="o">*</span> <span class="n">x_vals</span><span class="p">,</span> <span class="s1">&#39;k:&#39;</span><span class="p">)</span>

<span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">(</span><span class="mf">1e-10</span><span class="p">,</span><span class="mf">1e-5</span><span class="p">)</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">(</span><span class="mf">1e-10</span><span class="p">,</span><span class="mf">1e-5</span><span class="p">)</span>

<span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;$\epsilon_1 \mathrm{[W kg^{-1}]}$&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;$\epsilon_2 \mathrm{[W kg^{-1}]}$&#39;</span><span class="p">)</span>


<span class="c1">## Spectra</span>

<span class="n">ax</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">dat_bL3</span><span class="o">.</span><span class="n">KCYC</span><span class="p">[:,</span><span class="n">i</span><span class="p">],</span><span class="n">dat_bL3</span><span class="o">.</span><span class="n">SH_SPEC_CLEAN</span><span class="p">[</span><span class="mi">0</span><span class="p">,:,</span><span class="n">i</span><span class="p">],</span><span class="n">c</span><span class="o">=</span><span class="s1">&#39;tab:blue&#39;</span><span class="p">,</span><span class="n">lw</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="n">label</span><span class="o">=</span><span class="sa">r</span><span class="s1">&#39;$\Psi_</span><span class="si">{1}</span><span class="s1">$&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">dat_bL3</span><span class="o">.</span><span class="n">KCYC</span><span class="p">[:,</span><span class="n">i</span><span class="p">],</span><span class="n">dat_bL3</span><span class="o">.</span><span class="n">SH_SPEC_CLEAN</span><span class="p">[</span><span class="mi">1</span><span class="p">,:,</span><span class="n">i</span><span class="p">],</span><span class="n">c</span><span class="o">=</span><span class="s1">&#39;tab:orange&#39;</span><span class="p">,</span><span class="n">lw</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="n">label</span><span class="o">=</span><span class="sa">r</span><span class="s1">&#39;$\Psi_</span><span class="si">{2}</span><span class="s1">$&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">knas_strong</span><span class="p">,</span><span class="n">nasmyth_strong</span><span class="p">,</span><span class="n">c</span><span class="o">=</span><span class="s1">&#39;grey&#39;</span><span class="p">,</span><span class="n">lw</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="n">label</span><span class="o">=</span><span class="s1">&#39;Nasmyth Spectra&#39;</span><span class="p">)</span>

<span class="n">ax</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">dat_bL3</span><span class="o">.</span><span class="n">KCYC</span><span class="p">[:,</span><span class="n">j</span><span class="p">],</span><span class="n">dat_bL3</span><span class="o">.</span><span class="n">SH_SPEC_CLEAN</span><span class="p">[</span><span class="mi">0</span><span class="p">,:,</span><span class="n">j</span><span class="p">],</span><span class="n">c</span><span class="o">=</span><span class="s1">&#39;tab:blue&#39;</span><span class="p">,</span><span class="n">lw</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">dat_bL3</span><span class="o">.</span><span class="n">KCYC</span><span class="p">[:,</span><span class="n">j</span><span class="p">],</span><span class="n">dat_bL3</span><span class="o">.</span><span class="n">SH_SPEC_CLEAN</span><span class="p">[</span><span class="mi">1</span><span class="p">,:,</span><span class="n">j</span><span class="p">],</span><span class="n">c</span><span class="o">=</span><span class="s1">&#39;tab:orange&#39;</span><span class="p">,</span><span class="n">lw</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">knas_weak</span><span class="p">,</span><span class="n">nasmyth_weak</span><span class="p">,</span><span class="n">c</span><span class="o">=</span><span class="s1">&#39;grey&#39;</span><span class="p">,</span><span class="n">lw</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>

<span class="n">ax</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_yscale</span><span class="p">(</span><span class="s1">&#39;log&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_xscale</span><span class="p">(</span><span class="s1">&#39;log&#39;</span><span class="p">)</span>

<span class="n">ax</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">(</span><span class="mf">0.5</span><span class="p">,</span><span class="mf">1e2</span><span class="p">)</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">(</span><span class="mf">1e-7</span><span class="p">,</span><span class="mf">1e-2</span><span class="p">)</span>

<span class="n">ax</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>

<span class="n">ax</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;$k$ [cpm]&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;$\Psi$ $[s^{-2}\mathrm</span><span class="si">{cpm}</span><span class="s1">^{-1}]$&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Text(0, 0.5, &#39;$\\Psi$ $[s^{-2}\\mathrm{cpm}^{-1}]$&#39;)
</pre></div>
</div>
<img alt="_images/c86dc739fba4c769b0102aa471a9004b0ccc7857f22f5b33bfb8aee30d9837b9.png" src="_images/c86dc739fba4c769b0102aa471a9004b0ccc7857f22f5b33bfb8aee30d9837b9.png" />
</div>
</div>
</section>
</section>
<section id="haro-straight-a-tidal-channel">
<h3>Haro Straight - A tidal channel.<a class="headerlink" href="#haro-straight-a-tidal-channel" title="Link to this heading">#</a></h3>
<figure class="align-center" id="fig-vmp">
<a class="reference internal image-reference" href="_images/vmp250.png"><img alt="_images/vmp250.png" src="_images/vmp250.png" style="width: 40%;" />
</a>
<figcaption>
<p><span class="caption-number">Fig. 24 </span><span class="caption-text">A Rockland Scientific VMP250.</span><a class="headerlink" href="#fig-vmp" title="Link to this image">#</a></p>
</figcaption>
</figure>
<p>This dataset can be downloaded here:</p>
<p>Lueck, R. ATOMIX shear probes benchmark data: a dissipation profile from Haro Strait, British Columbia, Canada obtained with a vertical microstructure profiler in October 2016. NERC EDS British Oceanographic Data Centre NOC., <a class="reference external" href="https://doi.org/10.5285/0ec16a65-abdf-2822-e063-6c86abc06533">https://doi.org/10.5285/0ec16a65-abdf-2822-e063-6c86abc06533</a> (2024).</p>
<p>This turbulence profile was taken in a side channel adjacent to Haro Strait on the east coast of Vancouver Island, British Columbia, Canada, on 19 October 2016. The instrument was a VMP-250-IR (internally recording and serial number 215) vertical profiler from Rockland Scientific, Canada. It was configured to collect data while descending, with two shear probes oriented to measure two orthogonal components of the vertical shear of horizontal current, one FP07 thermistor, and two vibration sensors, all of which were anti-alias low-pass filtered at 98 Hz and sampled at a rate of 512 s−1.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># First look at the global attributes</span>
<span class="n">dat_h</span><span class="o">=</span><span class="n">xr</span><span class="o">.</span><span class="n">open_dataset</span><span class="p">(</span><span class="s1">&#39;assignment/haro_straight/VMP250_TidalChannel_024.nc&#39;</span><span class="p">,</span> <span class="n">engine</span><span class="o">=</span><span class="s2">&quot;h5netcdf&quot;</span><span class="p">,</span><span class="n">group</span><span class="o">=</span><span class="s2">&quot;&quot;</span><span class="p">)</span>
<span class="n">dat_h</span><span class="o">.</span><span class="n">attrs</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>{&#39;authors&#39;: &#39;Rolf Lueck&#39;,
 &#39;type&#39;: &#39;Time series from a VMP&#39;,
 &#39;source&#39;: &#39;VMP-250&#39;,
 &#39;platform_type&#39;: &#39;Research Vessel&#39;,
 &#39;title&#39;: &#39;ATOMIX shear probes benchmark data: a dissipation profile from Haro Strait, British Columbia, Canada obtained with a vertical microstructure profiler in October 2016&#39;,
 &#39;summary&#39;: &#39;This file was processed using a speed equal to the rate-of-change of pressure. The profile was collected using a tethered free-fall vertical microstructure profiler (VMP-250IR, Rockland Scientific, Canada), prepared as a benchmark shear-probe data example for the Scientific Committee on Oceanographic Research (SCOR) Working Group #160, &quot;Analyzing ocean turbulence observations to quantify mixing&quot; (ATOMIX, https://wiki.uib.no/atomix). The profile was collected on 2016-10-19 17:49:11 from R.V. Strickland in Haro Strait for a demonstration class. The bottom depth at this location is approximately 80 meters. The dissipation rate was measured using two airfoil shear probes. The dataset has been processed and formatted in accordance with ATOMIX guidelines and recommendations. The provided file is organized in four hierarchical groups including continuous time series of data converted into physical units, cleaned time series used for spectral analysis, wavenumber spectra, and dissipation rate estimates. For more detailed information, please refer to the comments within the data file.&#39;,
 &#39;comment&#39;: &#39;The profile was collected on 2016-10-19 17:49:11 in Haro Strait to demonstrate to a class of student how one uses a vertical downward-profiling microstructure instrument. Additional sensors include one fast-response FP07 thermistor and a SBE micro-conductivity sensor, a 2-axis vibration sensor, a pressure transducer, a 2-axis inclinometer, and a high-accuracy JAC temperature and conductivity. The turbulence and acceleration channels were sampled at a rate of 512 Hz, while the other channels were sampled at 64 Hz.\n\tThe processing of the data and the format of this data set follows the recommendations and guidelines of the SCOR Working Group #160, ATOMIX (https://wiki.uib.no/atomix). The processing was based on the standard Matlab routines provided by Rockland Scientific, which were adjusted for the ATOMIX recommendations. The netCDF file includes four hierarchical groups, corresponding to the four levels of microstructure data in the ATOMIX format.\n\tL1_converted : time series from all sensors converted into physical units. \n\tL2_cleaned : selected signals that are filtered and/or de-spiked before spectral analysis. Time stamp and length of the signals are the same as in L1. \n\tL3_spectra : wavenumber spectra from shear probes and vibration sensors. \n\tL4_dissipation: dissipation estimates together with quality control parameters. \n\tL2_cleaned time series used for spectral analysis are marked with section numbers. A section (a more general term for a profile) is a continuous segment of the time series with dissipation estimates. There is only 1 section (profile) in this example data set. Spectra (L3) and dissipation rate (L4) estimates are given only for this one section. Choices of filter and de-spiking parameters and various thresholds for quality assurance are given in the global attributes. Spectral calculation and dissipation rate estimate details are given in the attributes and processing parameters. \n\tL3 includes the cyclic wavenumber spectra obtained using half-overlapping record lengths of 5 s and FFT lengths of 1 s that are cosine windowed and overlapped by 50%. Vibration-coherent noise is removed using the method of Goodman et al. (2006). Shear and vibration spectra, and the cleaned shear spectra using the Goodman method are provided. \n\tL4 includes estimates from both shear probes, using the cleaned spectra, as well as a final estimate (average over estimates that passed the quality checks), together with quality control parameters. The figure of merit (FOM) and mean absolute deviation (MAD) relative to the Lueck model spectrum are used. Data quality flags for dissipation estimates are summarized in the attributes of the variable EPSI_FLAGS in the L4 group. A final dissipation estimate, EPSI_FINAL, failing the data quality control is reported as NaN. However, the individual dissipation estimates from each probe are accessible in the EPSI parameter.&#39;,
 &#39;acknowledgement&#39;: &#39;The support of the captain and crew of the RV Strickland is appreciated.&#39;,
 &#39;citation&#39;: &#39;Lueck, Rolf, (2024). ATOMIX shear probes benchmark data: a dissipation profile from Haro Strait, British Columbia, Canada obtained with a vertical microstructure profiler in October 2016. NERC EDS British Oceanographic Data Centre NOC. doi:10.5285/0ec16a65-abdf-2822-e063-6c86abc06533&#39;,
 &#39;references&#39;: &#39;Goodman, L., Levine, E. R., and Lueck, R. G. (2006). On Measuring the Terms of the Turbulent Kinetic Energy Budget from an AUV, Journal of Atmospheric and Oceanic Technology, 23, 977\udce2\udc80\udc93990, https://doi.org/10.1175/JTECH1889.1, 2006. Lueck, R. G. (2022a). The statistics of oceanic turbulence measurements. Part 1: Shear variance and dissipation rates. Journal of Atmospheric and Oceanic Technology 39, 1259\udce2\udc80\udc931271. doi:10.1175/JTECH-D-21-0051.1 Lueck, R. (2022b). The statistics of oceanic turbulence measurements. Part 2: Shear spectra and a new spectral model. Journal of Atmospheric and Oceanic Technology 39, 1273\udce2\udc80\udc931282. doi:10.1175/JTECH-D-21-0050.1.&#39;,
 &#39;institution&#39;: &#39;Rockland Scientific International, Inc.&#39;,
 &#39;area&#39;: &#39;Haro Strait&#39;,
 &#39;PI&#39;: &#39;Rolf Lueck&#39;,
 &#39;contact&#39;: &#39;Rolf Lueck&#39;,
 &#39;project_name&#39;: &#39;&#39;,
 &#39;cruise&#39;: &#39;&#39;,
 &#39;vessel&#39;: &#39;RV Strickland&#39;,
 &#39;creation_time&#39;: &#39;2024-01-19 13:55:54&#39;,
 &#39;date_updated&#39;: &#39;&#39;,
 &#39;time_reference_year&#39;: np.float64(2016.0),
 &#39;creator_name&#39;: &#39;Rolf Lueck&#39;,
 &#39;creator_initials&#39;: &#39;RGL&#39;,
 &#39;creator_email&#39;: &#39;rolf@rocklandscientific.com&#39;,
 &#39;creator_url&#39;: &#39;&#39;,
 &#39;conventions&#39;: &#39;CF-1.6, ACDD-1.3, ATOMIX&#39;,
 &#39;history&#39;: &#39;Version 1&#39;,
 &#39;data_mode&#39;: &#39;D #(D)elayed&#39;,
 &#39;geospatial_lat_min&#39;: np.float64(48.673),
 &#39;geospatial_lat_max&#39;: np.float64(48.673),
 &#39;geospatial_lon_min&#39;: np.float64(-123.368),
 &#39;geospatial_lon_max&#39;: np.float64(-123.368),
 &#39;keywords&#39;: &#39;turbulence, mixing, dissipation rate, shear probes&#39;,
 &#39;license&#39;: &#39;http://creativecommons.org/licenses/by/4.0/&#39;,
 &#39;instrument&#39;: &#39;VMP-250&#39;,
 &#39;profiling_direction&#39;: &#39;down&#39;,
 &#39;instrument_sampling_rate&#39;: np.float64(512.0),
 &#39;instrument_serial_number&#39;: array([], dtype=float64),
 &#39;despike_shear_fraction_limit&#39;: np.float64(0.05),
 &#39;despike_shear_iterations_limit&#39;: np.float64(8.0),
 &#39;diss_ratio_limit&#39;: np.float64(2.7718585822512662),
 &#39;variance_resolved_limit&#39;: np.float64(0.6),
 &#39;max_depth&#39;: np.float64(68.14594054397587),
 &#39;fs_fast&#39;: np.float64(512.0327777777778),
 &#39;fs_slow&#39;: np.float64(64.00409722222223),
 &#39;date_created&#39;: &#39;2024-01-19 13:55:54&#39;,
 &#39;profile_dir&#39;: &#39;down&#39;,
 &#39;time_coverage_start&#39;: &#39;2016-10-19 17:50:44&#39;,
 &#39;time_coverage_end&#39;: &#39;2016-10-19 17:52:02&#39;,
 &#39;FOM_limit&#39;: np.float64(1.15),
 &#39;HP_cut&#39;: np.float64(0.4),
 &#39;LP_cut&#39;: np.float64(30.0),
 &#39;P_end&#39;: array([], dtype=float64),
 &#39;P_start&#39;: array([], dtype=float64),
 &#39;YD_0&#39;: np.float64(0.0),
 &#39;despike_A&#39;: array([ inf, 0.5 , 0.04]),
 &#39;despike_C&#39;: array([10.  ,  1.  ,  0.04]),
 &#39;despike_sh&#39;: array([8.  , 0.5 , 0.04]),
 &#39;despike_shear_limit&#39;: np.float64(0.05),
 &#39;despike_shear_pass_limit&#39;: np.float64(8.0),
 &#39;diss_length&#39;: np.float64(2560.0),
 &#39;f_AA&#39;: np.float64(98.0),
 &#39;f_limit&#39;: np.float64(inf),
 &#39;fft_length&#39;: np.float64(512.0),
 &#39;fit_2_isr&#39;: np.float64(1.5e-05),
 &#39;fit_order&#39;: np.float64(3.0),
 &#39;fname&#39;: &#39;VMP250_TidalChannel_024&#39;,
 &#39;goodman&#39;: np.float64(1.0),
 &#39;goodman_depth_range&#39;: array([  10., 1000.]),
 &#39;goodman_fft_length&#39;: np.float64(2.0),
 &#39;make_figures&#39;: np.float64(0.0),
 &#39;op_area&#39;: &#39;open_ocean&#39;,
 &#39;overlap&#39;: np.float64(1280.0),
 &#39;plot_battery&#39;: np.float64(0.0),
 &#39;plot_dissipation&#39;: np.float64(0.0),
 &#39;plot_kinematics&#39;: np.float64(0.0),
 &#39;plot_rawaccel&#39;: np.float64(0.0),
 &#39;plot_sensors&#39;: np.float64(0.0),
 &#39;plot_spectra&#39;: np.float64(0.0),
 &#39;plot_spectrograms&#39;: np.float64(0.0),
 &#39;profile_min_P&#39;: np.float64(3.0),
 &#39;profile_min_W&#39;: np.float64(0.5),
 &#39;profile_min_duration&#39;: np.float64(20.0),
 &#39;profile_num&#39;: np.float64(1.0),
 &#39;MF_extra_points&#39;: np.float64(0.0),
 &#39;MF_k&#39;: np.float64(4.0),
 &#39;MF_k_mag&#39;: np.float64(1.7),
 &#39;MF_len&#39;: np.float64(256.0),
 &#39;MF_st_dev&#39;: &#39;st_dev&#39;,
 &#39;MF_threshold&#39;: array([], dtype=float64),
 &#39;aoa&#39;: np.float64(0.0),
 &#39;constant_speed&#39;: array([], dtype=float64),
 &#39;constant_temp&#39;: array([], dtype=float64),
 &#39;gradC_method&#39;: &#39;high_pass&#39;,
 &#39;gradT_method&#39;: &#39;high_pass&#39;,
 &#39;hotel_file&#39;: array([], dtype=float64),
 &#39;speed_cutout&#39;: np.float64(0.05),
 &#39;speed_tau&#39;: np.float64(1.5),
 &#39;time_offset&#39;: np.float64(0.0),
 &#39;vehicle&#39;: &#39;vmp&#39;,
 &#39;dof_spec&#39;: np.float64(17.099999999999998),
 &#39;num_fft_segments&#39;: np.float64(9.0),
 &#39;fft_length_sec&#39;: np.float64(1.0),
 &#39;diss_length_sec&#39;: np.float64(5.0),
 &#39;overlap_sec&#39;: np.float64(2.5),
 &#39;temperature_source&#39;: &#39;T1_fast&#39;,
 &#39;speed_source&#39;: &#39;Rate of change of pressure&#39;,
 &#39;ssetupfilestr&#39;: &#39;; 2017-10-31 12:03:54 patched configuration string\n; Standard configuration setup.cfg file for a downward profiling VMP.\n; Change the vehicle type in the [instrument_info] section to rvmp for an\n;  uprising profiler.\n; Created by RSI, 2015-12-17\n; Modified by Andrew Bourget, 2016-09-19 with coefficients\n; Edited pressure coefficient to zero by subtracting 0.85 from coeff 0  2016-09-19 \n; Made for Victor\n; Changed Sh1 probe to M1111 2017_10_31\n;\n; Any line that starts with a semicolon, &quot;;&quot;, is a comment and is ignored by \n;  software. Likewise, everything to the right of a semicolon is ignored.\n;  Use this feature to leave notes and to indicate that you have made changes \n;  to this file. Indicate the date (YYYY-MM-DD), your name and a brief \n;  description of your changes.\n\n; The first section is the [root] section. It determines the data \n;  acquisition parameters. It does not need to be declared explicitly.\n\nrate        = 512    ; the sampling rate of &quot;fast&quot; channels\nprefix      = VMP_   ; the base name of your data files. A 3-digit file number is \n\t\t\t\t\t ; appended to this base name. The limit is 8 characters\n                     ; total for internally recording instruments.\ndisk        = /data  ; the directory for the data files. It must exist. The directory \n\t\t\t\t\t ; should be /data for internally recording instruments. For \n\t\t\t\t\t ; real-time instruments it is best to leave this blank, so \n\t\t\t\t\t ; that it defaults to the local directory.\nrecsize     = 1      ; the size of a record in seconds\nman_com_rate= 3      ; the communication rate for real-time VMPs. This value must\n                     ; match the jumper settings of the RSTRANS in your VMP. \n                     ; It is not needed for internally recording instruments.\nno-fast     = 7      ; number of fast &quot;columns&quot; in the address matrix (see below).\nno-slow     = 2      ; number of slow &quot;columns&quot; in the address matrix.\n\n; -----------------\n;This section presents the address [matrix] of your instrument and \n;  automatically ends the [root] section above. The first columns are &quot;slow&quot;\n;  channels as defined by the &quot;no-slow&quot; parameter in the [root] section.\n;  The remainder are &quot;fast&quot; columns (&quot;no-fast&quot;).\n[matrix]\nnum_rows=8\nrow01   =\t255\t0\t1\t2\t5\t8\t9\t64\t65\t\nrow02   =\t32\t40\t1\t2\t5\t8\t9\t64\t65\t\nrow03   =\t41\t42\t1\t2\t5\t8\t9\t64\t65\t\nrow04   =\t4\t0\t1\t2\t5\t8\t9\t64\t65\t\nrow05   =\t10\t11\t1\t2\t5\t8\t9\t64\t65\t\nrow06   =\t12\t48\t1\t2\t5\t8\t9\t64\t65\t\nrow07   =\t0\t49\t1\t2\t5\t8\t9\t64\t65\t\nrow08   =\t0\t50\t1\t2\t5\t8\t9\t64\t65\t\n\n; --------------------\n;This section identifies your instrument. Only the vehicle is important.\n[instrument_info]\nvehicle = vmp      ; downward profiling. Use either vmp or rvmp but not both.\n;vehicle= rvmp     ; upward profiling\nmodel   = vmp-250IR  ; The actual model. Used for trouble shooting.\nsn      = 215      ; The serial numnber of the instrument. For trouble shooting\n\n; --------------------\n; The next section is optional and can be expanded. Do not use the parameter &quot;id = &quot;.\n[cruise_info]\noperator    = \nproject     = 2017 Ocean Turbulence Workshop\nship        =\nleg         =\n\n; --------------------\n; Next come the [channel] sections. These are used to convert your data \n;  into physical units, and to save them into a mat-file. \n;  They also determine the name given to various signals \n;  in your data file. Please, stick to the convention of \n;  RSI because data visualization using the RSI Matlab Library of functions\n;  assumes particular names. However, data will be converted into physical\n;  units regardless of the name of the channels. If you change the names,\n;  then data visualization and further processing is your responsibility.\n;  A list of typical channel addresses (id) and their names and functions\n;  is at the end of this file.\n\n; Each channel section consists of a part that is unique to your instrument.\n;  It does not need to be changed. The second part is dependent on your \n;  sensors (shear probes, FP07 thermistors, etc.) and must be updated \n;  whenever you change a probe.\n;\n; The record average value is display for some channels with a real-time\n;  instrument. Display can be forced or suppressed using \n;  display = true, or display = false. Internally recording instruments\n;  have no display. The units used for display can be specified with\n;  units = [unit_symbols]. Keep it short for best display. \n\n; The ground reference channel.\n[channel]\n; instrument dependent parameters\nid      = 0   ; the channel address, 0 to 254.  Listed in the [matrix] section.\nname    = Gnd ; the name it will have in the mat-file.\ntype    = gnd ; the algorithm used to convert raw data into physical units.\n;coef0   = 0   ; the coefficients required for conversion. None in this case.\n\n; --------------\n; The piezo-vibration sensors\n[channel]\n; instrument dependent parameters\nid      = 1\nname    = Ax\ntype    = piezo\n\n[channel]\n; instrument dependent parameters\nid      = 2\nname    = Ay\ntype    = piezo\n\n; -----------------\n; The thermistor channels\n; without pre-emphasis\n[channel]\n; instrument dependent parameters\nid          = 4\nname        = T1\ntype        = therm\nadc_fs      = 4.096\nadc_bits    = 16\na           = -9.4\nb           = 0.9991\nG           = 6\nE_B         = 0.68222\n; sensor dependent parameters\nSN          = T1000\nbeta_1      = 2.6297e3\nbeta_2      = 1.9189e3\nT_0         = 281.9394\ncal_date    = 2017-10-31\nunits       = [C]\n\n; with pre-emphasis\n[channel]\n; instrument dependent parameter\nid          = 5\nname        = T1_dT1\ntype        = therm\ndiff_gain   = 0.925\n\n; -----------------\n; The shear probe channels\n[channel]\n; instrument dependent parameters\nid          = 8 \nname        = sh1\ntype        = shear\nadc_fs      = 4.096\nadc_bits    = 16\ndiff_gain   = 0.933\n; sensor dependent parameters\nsens        = 0.0716\nSN          = M1000\ncal_date    = 2016-09-07\n\n[channel]\n; instrument dependent parameters\nid          = 9\nname        = sh2\ntype        = shear\nadc_fs      = 4.096\nadc_bits    = 16\ndiff_gain   = 0.944\n; sensor dependent parameters\nsens        = 0.0705\nSN          = M1111\ncal_date    = 2016-09-07\n\n; -----------------\n; The pressure transducder\n; without pre-emphasis\n[channel]\n; instrument dependent parameters\nid          = 10\nname        = P\ntype        = poly\n; sensor dependent parameters\ncoef0       = -1.83303\ncoef1       = 0.029257\ncoef2       = 0\ncal_date    = 2016-09-07\nunits       = [dBar]\n\n; with pre-emphasis\n[channel]\n; instrument dependent parameters\nid          = 11\nname        = P_dP\ntype        = poly\ndiff_gain   = 20.29\n\n; pressure transducer voltage\n[channel]\n; instrument dependent parameters\nid      = 12\nname    = PV\ntype    = poly\ncoef0   = 4.096\ncoef1   = 1.25e-4\nunits   = [V]\n\n; -----------------\n; Battery voltage or power supply voltage\n[channel]\n; instrument dependent parameters\nid          = 32\nname        = V_Bat\ntype        = voltage\nG           = 0.1\nadc_fs      = 4.096\nadc_bits    = 16\nunits       = [V]\n\n; -----------------\n; The ADIS precision inclinometer with built in thermometer\n[channel]\n; instrument dependent parameters\nid      = 40\nname    = Incl_Y\ntype    = inclxy\n; sensor dependent parameters\ncoef0   = 0\ncoef1   = 0.025\nunits   = [deg]\n\n[channel]\n; instrument dependent parameters\nid      = 41\nname    = Incl_X\ntype    = inclxy\n; sensor dependent parameters\ncoef0   = 0\ncoef1   = 0.025\nunits   = [deg]\n\n[channel]\n; instrument dependent parameters\nid      = 42\nname    = Incl_T\ntype    = inclt\n; sensor dependent parameters\ncoef0   = 624\ncoef1   =-0.47\nunits   = [C]\n\n; -----------------\n; the JAC CT. Remove, if you are using a Sea-Bird CT,and \n;  remember to update the [matrix] section.\n[channel]\n; instrument dependent parameters\nid          = 48, 49\nname        = JAC_C\ntype        = jac_c\n; sensor dependent parameters\na           = -2.421830e-2\nb           = 3.820497e1\nc           = -4.313915e-2\nSN          = 27\ncal_date    = 2016-08-10\nunits       = [mS/cm]\n\n; the JAC CT. Remove, if you are using a Sea-Bird CT,and \n;  remember to update the [matrix] section.\n[channel]\n; instrument dependent parameters\nid          = 50\nname        = JAC_T\ntype        = jac_t\n; sensor dependent parameters\na           =-5.705548e0\nb           = 1.070777e-3\nc           =-1.282631e-8\nd           = 3.010162e-13\ne           =-3.726064e-18\nf           = 2.678006e-23\nSN          = 27\ncal_date    = 2016-08-10\nunits       = [C]\n\n; -------------------------\n; the micro-conductivity sensor. Remove if not installed\n; first, without pre-emphasis\n[channel]\n; instrument dependent parameters\nid          = 64\nname        = C1\ntype        = ucond\na           =-0.7618\nb           = 112.7\nadc_fs      = 4.096\nadc_bits    = 16\n; sensor dependent parameters\nSN          =\nK           = 1.03e-3 ; the cell constant\ncal_date    =\nunits       = [mS/cm]\n\n; with pre-emphasis\n[channel]\n; instrument dependent parameters\nid          = 65\nname        = C1_dC1\ntype        = ucond\ndiff_gain   = 0.3948\nunits       = [mS/cm]\n\n; ------------------\n; This is a list of typical channels (addresses) and their signals\n; Only some of these channels will be in any particular instrument\n;  id    Name    - rate - Description\n; -------------------------------------------------------------------\n;  0     Gnd     - slow - Reference ground\n;  1     Ax      - fast - horizontal acceleration in the direction of the pressure port or ON/OFF magnet\n;  2     Ay      - fast - horizontal acceleration orthogonal to the direction of the pressure port\n;  3     Az      - fast - vertical acceleration, positive up\n;  4     T1      - slow - Temperature from Thermistor 1 without pre-emphasis\n;  5     T1_dT1  - fast - Temperature from Thermistor 1 with pre-emphasis\n;  8     sh1     - fast - velocity derivative from shear probe 1\n;  9     sh2     - fast - velocity derivative from shear probe 2\n; 10     P       - slow - pressure signal without pre-emphasis\n; 11     P_dP    - slow - pressure signal with pre-emphasis\n; 12     PV      - slow - voltage on pressure transducer\n; 32     V_Bat   - slow - Battery or power supply voltage\n; 40     Incl_Y  - slow - Inclinometer, rotation around the y-axis\n; 41     Incl_X  - slow - Inclinometer, rotation around the x-axis\n; 42     Incl_T  - slow - Inclinometer, its temperature \n; 48, 49 JAC_C   - slow - JAC conductivity sensor\n; 50     JAC_T   - slow - JAC thermometer\n; 64     C1      - fast - micro-conductivity without pre-emphasis\n; 65     C1_dC1  - fast - micro-conductivity with pre-emphasis\n; 255    sp_char - slow - special Character that always returns 32752D or 7FF0H and \n;                         is used to test the integrity of communication.\n\n; End of setup configuration file.\n\n\n\n; ### Original Configuration String Below ###\n; ; Standard configuration setup.cfg file for a downward profiling VMP.\n; ; Change the vehicle type in the [instrument_info] section to rvmp for an\n; ;  uprising profiler.\n; ; Created by RSI, 2015-12-17\n; ; Modified by Andrew Bourget, 2016-09-19 with coefficients\n; ; Edited pressure coefficient to zero by subtracting 0.85 from coeff 0  2016-09-19 \n; ; Made for Victor\n; ;\n; ; Any line that starts with a semicolon, &quot;;&quot;, is a comment and is ignored by \n; ;  software. Likewise, everything to the right of a semicolon is ignored.\n; ;  Use this feature to leave notes and to indicate that you have made changes \n; ;  to this file. Indicate the date (YYYY-MM-DD), your name and a brief \n; ;  description of your changes.\n; \n; ; The first section is the [root] section. It determines the data \n; ;  acquisition parameters. It does not need to be declared explicitly.\n; \n; rate        = 512    ; the sampling rate of &quot;fast&quot; channels\n; prefix      = VMP_   ; the base name of your data files. A 3-digit file number is \n; \t\t\t\t\t ; appended to this base name. The limit is 8 characters\n;                      ; total for internally recording instruments.\n; disk        = /data  ; the directory for the data files. It must exist. The directory \n; \t\t\t\t\t ; should be /data for internally recording instruments. For \n; \t\t\t\t\t ; real-time instruments it is best to leave this blank, so \n; \t\t\t\t\t ; that it defaults to the local directory.\n; recsize     = 1      ; the size of a record in seconds\n; man_com_rate= 3      ; the communication rate for real-time VMPs. This value must\n;                      ; match the jumper settings of the RSTRANS in your VMP. \n;                      ; It is not needed for internally recording instruments.\n; no-fast     = 7      ; number of fast &quot;columns&quot; in the address matrix (see below).\n; no-slow     = 2      ; number of slow &quot;columns&quot; in the address matrix.\n; \n; ; -----------------\n; ;This section presents the address [matrix] of your instrument and \n; ;  automatically ends the [root] section above. The first columns are &quot;slow&quot;\n; ;  channels as defined by the &quot;no-slow&quot; parameter in the [root] section.\n; ;  The remainder are &quot;fast&quot; columns (&quot;no-fast&quot;).\n; [matrix]\n; num_rows=8\n; row01   =\t255\t0\t1\t2\t5\t8\t9\t64\t65\t\n; row02   =\t32\t40\t1\t2\t5\t8\t9\t64\t65\t\n; row03   =\t41\t42\t1\t2\t5\t8\t9\t64\t65\t\n; row04   =\t4\t0\t1\t2\t5\t8\t9\t64\t65\t\n; row05   =\t10\t11\t1\t2\t5\t8\t9\t64\t65\t\n; row06   =\t12\t48\t1\t2\t5\t8\t9\t64\t65\t\n; row07   =\t0\t49\t1\t2\t5\t8\t9\t64\t65\t\n; row08   =\t0\t50\t1\t2\t5\t8\t9\t64\t65\t\n; \n; ; --------------------\n; ;This section identifies your instrument. Only the vehicle is important.\n; [instrument_info]\n; vehicle = vmp      ; downward profiling. Use either vmp or rvmp but not both.\n; ;vehicle= rvmp     ; upward profiling\n; model   = vmp-250IR  ; The actual model. Used for trouble shooting.\n; sn      = 215      ; The serial numnber of the instrument. For trouble shooting\n; \n; ; --------------------\n; ; The next section is optional and can be expanded. Do not use the parameter &quot;id = &quot;.\n; [cruise_info]\n; operator    = Victor 2016\n; project     = \n; ship        =\n; leg         =\n; \n; ; --------------------\n; ; Next come the [channel] sections. These are used to convert your data \n; ;  into physical units, and to save them into a mat-file. \n; ;  They also determine the name given to various signals \n; ;  in your data file. Please, stick to the convention of \n; ;  RSI because data visualization using the RSI Matlab Library of functions\n; ;  assumes particular names. However, data will be converted into physical\n; ;  units regardless of the name of the channels. If you change the names,\n; ;  then data visualization and further processing is your responsibility.\n; ;  A list of typical channel addresses (id) and their names and functions\n; ;  is at the end of this file.\n; \n; ; Each channel section consists of a part that is unique to your instrument.\n; ;  It does not need to be changed. The second part is dependent on your \n; ;  sensors (shear probes, FP07 thermistors, etc.) and must be updated \n; ;  whenever you change a probe.\n; ;\n; ; The record average value is display for some channels with a real-time\n; ;  instrument. Display can be forced or suppressed using \n; ;  display = true, or display = false. Internally recording instruments\n; ;  have no display. The units used for display can be specified with\n; ;  units = [unit_symbols]. Keep it short for best display. \n; \n; ; The ground reference channel.\n; [channel]\n; ; instrument dependent parameters\n; id      = 0   ; the channel address, 0 to 254.  Listed in the [matrix] section.\n; name    = Gnd ; the name it will have in the mat-file.\n; type    = gnd ; the algorithm used to convert raw data into physical units.\n; ;coef0   = 0   ; the coefficients required for conversion. None in this case.\n; \n; ; --------------\n; ; The piezo-vibration sensors\n; [channel]\n; ; instrument dependent parameters\n; id      = 1\n; name    = Ax\n; type    = piezo\n; \n; [channel]\n; ; instrument dependent parameters\n; id      = 2\n; name    = Ay\n; type    = piezo\n; \n; ; -----------------\n; ; The thermistor channels\n; ; without pre-emphasis\n; [channel]\n; ; instrument dependent parameters\n; id          = 4\n; name        = T1\n; type        = therm\n; adc_fs      = 4.096\n; adc_bits    = 16\n; a           = -9.4\n; b           = 0.9991\n; G           = 6\n; E_B         = 0.68222\n; ; sensor dependent parameters\n; SN          = T1000\n; beta_1      = 3143.55\n; beta_2      = 2.5e5\n; T_0         = 289.301\n; cal_date    = 2016-09-07\n; units       = [C]\n; \n; ; with pre-emphasis\n; [channel]\n; ; instrument dependent parameter\n; id          = 5\n; name        = T1_dT1\n; type        = therm\n; diff_gain   = 0.925\n; \n; ; -----------------\n; ; The shear probe channels\n; [channel]\n; ; instrument dependent parameters\n; id          = 8 \n; name        = sh1\n; type        = shear\n; adc_fs      = 4.096\n; adc_bits    = 16\n; diff_gain   = 0.933\n; ; sensor dependent parameters\n; sens        = 0.0716\n; SN          = M1000\n; cal_date    = 2016-09-07\n; \n; [channel]\n; ; instrument dependent parameters\n; id          = 9\n; name        = sh2\n; type        = shear\n; adc_fs      = 4.096\n; adc_bits    = 16\n; diff_gain   = 0.944\n; ; sensor dependent parameters\n; sens        = 0.0705\n; SN          = M1001\n; cal_date    = 2016-09-07\n; \n; ; -----------------\n; ; The pressure transducder\n; ; without pre-emphasis\n; [channel]\n; ; instrument dependent parameters\n; id          = 10\n; name        = P\n; type        = poly\n; ; sensor dependent parameters\n; coef0       = -1.83303\n; coef1       = 0.029257\n; coef2       = 0\n; cal_date    = 2016-09-07\n; units       = [dBar]\n; \n; ; with pre-emphasis\n; [channel]\n; ; instrument dependent parameters\n; id          = 11\n; name        = P_dP\n; type        = poly\n; diff_gain   = 20.29\n; \n; ; pressure transducer voltage\n; [channel]\n; ; instrument dependent parameters\n; id      = 12\n; name    = PV\n; type    = poly\n; coef0   = 4.096\n; coef1   = 1.25e-4\n; units   = [V]\n; \n; ; -----------------\n; ; Battery voltage or power supply voltage\n; [channel]\n; ; instrument dependent parameters\n; id          = 32\n; name        = V_Bat\n; type        = voltage\n; G           = 0.1\n; adc_fs      = 4.096\n; adc_bits    = 16\n; units       = [V]\n; \n; ; -----------------\n; ; The ADIS precision inclinometer with built in thermometer\n; [channel]\n; ; instrument dependent parameters\n; id      = 40\n; name    = Incl_Y\n; type    = inclxy\n; ; sensor dependent parameters\n; coef0   = 0\n; coef1   = 0.025\n; units   = [deg]\n; \n; [channel]\n; ; instrument dependent parameters\n; id      = 41\n; name    = Incl_X\n; type    = inclxy\n; ; sensor dependent parameters\n; coef0   = 0\n; coef1   = 0.025\n; units   = [deg]\n; \n; [channel]\n; ; instrument dependent parameters\n; id      = 42\n; name    = Incl_T\n; type    = inclt\n; ; sensor dependent parameters\n; coef0   = 624\n; coef1   =-0.47\n; units   = [C]\n; \n; ; -----------------\n; ; the JAC CT. Remove, if you are using a Sea-Bird CT,and \n; ;  remember to update the [matrix] section.\n; [channel]\n; ; instrument dependent parameters\n; id          = 48, 49\n; name        = JAC_C\n; type        = jac_c\n; ; sensor dependent parameters\n; a           = -2.421830e-2\n; b           = 3.820497e1\n; c           = -4.313915e-2\n; SN          = 27\n; cal_date    = 2016-08-10\n; units       = [mS/cm]\n; \n; ; the JAC CT. Remove, if you are using a Sea-Bird CT,and \n; ;  remember to update the [matrix] section.\n; [channel]\n; ; instrument dependent parameters\n; id          = 50\n; name        = JAC_T\n; type        = jac_t\n; ; sensor dependent parameters\n; a           =-5.705548e0\n; b           = 1.070777e-3\n; c           =-1.282631e-8\n; d           = 3.010162e-13\n; e           =-3.726064e-18\n; f           = 2.678006e-23\n; SN          = 27\n; cal_date    = 2016-08-10\n; units       = [C]\n; \n; ; -------------------------\n; ; the micro-conductivity sensor. Remove if not installed\n; ; first, without pre-emphasis\n; [channel]\n; ; instrument dependent parameters\n; id          = 64\n; name        = C1\n; type        = ucond\n; a           =-0.7618\n; b           = 112.7\n; adc_fs      = 4.096\n; adc_bits    = 16\n; ; sensor dependent parameters\n; SN          =\n; K           = 1.03e-3 ; the cell constant\n; cal_date    =\n; units       = [mS/cm]\n; \n; ; with pre-emphasis\n; [channel]\n; ; instrument dependent parameters\n; id          = 65\n; name        = C1_dC1\n; type        = ucond\n; diff_gain   = 0.3948\n; units       = [mS/cm]\n; \n; ; ------------------\n; ; This is a list of typical channels (addresses) and their signals\n; ; Only some of these channels will be in any particular instrument\n; ;  id    Name    - rate - Description\n; ; -------------------------------------------------------------------\n; ;  0     Gnd     - slow - Reference ground\n; ;  1     Ax      - fast - horizontal acceleration in the direction of the pressure port or ON/OFF magnet\n; ;  2     Ay      - fast - horizontal acceleration orthogonal to the direction of the pressure port\n; ;  3     Az      - fast - vertical acceleration, positive up\n; ;  4     T1      - slow - Temperature from Thermistor 1 without pre-emphasis\n; ;  5     T1_dT1  - fast - Temperature from Thermistor 1 with pre-emphasis\n; ;  8     sh1     - fast - velocity derivative from shear probe 1\n; ;  9     sh2     - fast - velocity derivative from shear probe 2\n; ; 10     P       - slow - pressure signal without pre-emphasis\n; ; 11     P_dP    - slow - pressure signal with pre-emphasis\n; ; 12     PV      - slow - voltage on pressure transducer\n; ; 32     V_Bat   - slow - Battery or power supply voltage\n; ; 40     Incl_Y  - slow - Inclinometer, rotation around the y-axis\n; ; 41     Incl_X  - slow - Inclinometer, rotation around the x-axis\n; ; 42     Incl_T  - slow - Inclinometer, its temperature \n; ; 48, 49 JAC_C   - slow - JAC conductivity sensor\n; ; 50     JAC_T   - slow - JAC thermometer\n; ; 64     C1      - fast - micro-conductivity without pre-emphasis\n; ; 65     C1_dC1  - fast - micro-conductivity with pre-emphasis\n; ; 255    sp_char - slow - special Character that always returns 32752D or 7FF0H and \n; ;                         is used to test the integrity of communication.\n; \n; ; End of setup configuration file.\n; \n; &#39;}
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">dat_hL1</span><span class="o">=</span><span class="n">xr</span><span class="o">.</span><span class="n">open_dataset</span><span class="p">(</span><span class="s1">&#39;assignment/haro_straight/VMP250_TidalChannel_024.nc&#39;</span><span class="p">,</span> <span class="n">engine</span><span class="o">=</span><span class="s2">&quot;h5netcdf&quot;</span><span class="p">,</span><span class="n">group</span><span class="o">=</span><span class="s2">&quot;L1_converted&quot;</span><span class="p">)</span>
<span class="n">dat_hL2</span><span class="o">=</span><span class="n">xr</span><span class="o">.</span><span class="n">open_dataset</span><span class="p">(</span><span class="s1">&#39;assignment/haro_straight/VMP250_TidalChannel_024.nc&#39;</span><span class="p">,</span> <span class="n">engine</span><span class="o">=</span><span class="s2">&quot;h5netcdf&quot;</span><span class="p">,</span><span class="n">group</span><span class="o">=</span><span class="s2">&quot;L2_cleaned&quot;</span><span class="p">)</span>
<span class="n">dat_hL3</span><span class="o">=</span><span class="n">xr</span><span class="o">.</span><span class="n">open_dataset</span><span class="p">(</span><span class="s1">&#39;assignment/haro_straight/VMP250_TidalChannel_024.nc&#39;</span><span class="p">,</span> <span class="n">engine</span><span class="o">=</span><span class="s2">&quot;h5netcdf&quot;</span><span class="p">,</span><span class="n">group</span><span class="o">=</span><span class="s2">&quot;L3_spectra&quot;</span><span class="p">)</span>
<span class="n">dat_hL4</span><span class="o">=</span><span class="n">xr</span><span class="o">.</span><span class="n">open_dataset</span><span class="p">(</span><span class="s1">&#39;assignment/haro_straight/VMP250_TidalChannel_024.nc&#39;</span><span class="p">,</span> <span class="n">engine</span><span class="o">=</span><span class="s2">&quot;h5netcdf&quot;</span><span class="p">,</span><span class="n">group</span><span class="o">=</span><span class="s2">&quot;L4_dissipation&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<section id="plot-vertical-profile-of-temperature-salinity-and-density">
<h4>Plot vertical profile of temperature, salinity and density<a class="headerlink" href="#plot-vertical-profile-of-temperature-salinity-and-density" title="Link to this heading">#</a></h4>
<p>1.6 Describe what you can about the hydrographic structure from this plot.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># calculate salinity and density using the TEOS GSW package. </span>

<span class="n">SP</span><span class="o">=</span><span class="n">gsw</span><span class="o">.</span><span class="n">SP_from_C</span><span class="p">(</span><span class="n">dat_hL1</span><span class="o">.</span><span class="n">COND</span><span class="p">[</span><span class="mi">0</span><span class="p">,:],</span><span class="n">dat_hL1</span><span class="o">.</span><span class="n">TEMP</span><span class="p">,</span><span class="n">dat_hL1</span><span class="o">.</span><span class="n">PRES</span><span class="p">)</span>
<span class="n">SA</span><span class="o">=</span><span class="n">gsw</span><span class="o">.</span><span class="n">SA_from_SP</span><span class="p">(</span><span class="n">SP</span><span class="p">,</span><span class="n">dat_hL1</span><span class="o">.</span><span class="n">PRES</span><span class="p">,</span><span class="o">-</span><span class="mi">123</span><span class="p">,</span><span class="mi">48</span><span class="p">)</span>
<span class="n">CT</span> <span class="o">=</span><span class="n">gsw</span><span class="o">.</span><span class="n">CT_from_t</span><span class="p">(</span><span class="n">SA</span><span class="p">,</span><span class="n">dat_hL1</span><span class="o">.</span><span class="n">TEMP</span><span class="p">,</span><span class="n">dat_hL1</span><span class="o">.</span><span class="n">PRES</span><span class="p">)</span>
<span class="n">rho</span><span class="o">=</span><span class="n">gsw</span><span class="o">.</span><span class="n">rho</span><span class="p">(</span><span class="n">SA</span><span class="p">,</span><span class="n">CT</span><span class="p">,</span><span class="n">dat_hL1</span><span class="o">.</span><span class="n">PRES</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">fig</span><span class="p">,</span><span class="n">ax</span><span class="o">=</span><span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">8</span><span class="p">,</span><span class="mi">5</span><span class="p">),</span><span class="n">sharey</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">CT</span><span class="p">,</span><span class="n">dat_hL1</span><span class="o">.</span><span class="n">PRES</span><span class="p">)</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">(</span><span class="mi">70</span><span class="p">,</span><span class="mi">0</span><span class="p">)</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">(</span><span class="mf">9.5</span><span class="p">,</span><span class="mi">11</span><span class="p">)</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;Pressure [db]&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;Temperature [°C]&#39;</span><span class="p">)</span>

<span class="n">ax</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">SA</span><span class="p">,</span><span class="n">dat_hL1</span><span class="o">.</span><span class="n">PRES</span><span class="p">)</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">(</span><span class="mf">34.3</span><span class="p">,</span><span class="mf">35.8</span><span class="p">)</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;Absolute Salinity [g/kg]&#39;</span><span class="p">)</span>

<span class="n">ax</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">rho</span><span class="o">-</span><span class="mi">1000</span><span class="p">,</span><span class="n">dat_hL1</span><span class="o">.</span><span class="n">PRES</span><span class="p">)</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">(</span><span class="mi">26</span><span class="p">,</span><span class="mi">28</span><span class="p">)</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;Density [kgm$^{-3}$]&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Text(0.5, 0, &#39;Density [kgm$^{-3}$]&#39;)
</pre></div>
</div>
<img alt="_images/0d94567fd9618c080ee73a853dab99800ab04e25b0a7c23b3f43862882fc639c.png" src="_images/0d94567fd9618c080ee73a853dab99800ab04e25b0a7c23b3f43862882fc639c.png" />
</div>
</div>
</section>
<section id="id4">
<h4>Plot time series<a class="headerlink" href="#id4" title="Link to this heading">#</a></h4>
<p>Like before, below are time series of a) Pressure and Velocity through water, b) vertical shear, c) platform vibrations and d) turbulence dissipation rate.</p>
<p>1.7) Interpret what might be causing the enhanced vertical shear in b) with reference to the platofrms velocity through water.<br />
1.8a) Describe the vertical profile of the dissipation rate of turbulence (where dissipation rate is high, where it is low) with reference to the distance from the surface and the temperature profile. Comment on differences to the previous profile in the Baltic Sea.
1.8b) Select two points, one with high dissipation rate and one with low dissipation rate and overlay vertical lines at these chosen points in subpanels d).</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">fig</span><span class="p">,</span><span class="n">ax</span><span class="o">=</span><span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">4</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span><span class="mi">8</span><span class="p">),</span><span class="n">sharex</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

<span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">dat_hL1</span><span class="o">.</span><span class="n">TIME</span><span class="p">,</span><span class="n">dat_hL1</span><span class="o">.</span><span class="n">PRES</span><span class="p">,</span><span class="n">lw</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;Pressure [db]&#39;</span><span class="p">)</span>

<span class="n">axa</span><span class="o">=</span><span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">twinx</span><span class="p">()</span>
<span class="n">axa</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">dat_hL2</span><span class="o">.</span><span class="n">TIME</span><span class="p">,</span><span class="n">dat_hL2</span><span class="o">.</span><span class="n">PSPD_REL</span><span class="p">,</span><span class="n">c</span><span class="o">=</span><span class="s1">&#39;tab:orange&#39;</span><span class="p">,</span><span class="n">lw</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
<span class="n">axa</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;W [ms$^{-1}$]&#39;</span><span class="p">,</span><span class="n">c</span><span class="o">=</span><span class="s1">&#39;tab:orange&#39;</span><span class="p">)</span>


<span class="n">ax</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">dat_hL2</span><span class="o">.</span><span class="n">TIME</span><span class="p">,</span><span class="n">dat_hL2</span><span class="o">.</span><span class="n">SHEAR</span><span class="p">[</span><span class="mi">0</span><span class="p">,:])</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">dat_hL2</span><span class="o">.</span><span class="n">TIME</span><span class="p">,</span><span class="n">dat_hL2</span><span class="o">.</span><span class="n">SHEAR</span><span class="p">[</span><span class="mi">1</span><span class="p">,:])</span>

<span class="n">ax</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;$\partial u / \partial z$ [s$^{-1}$]&#39;</span><span class="p">)</span>

<span class="n">ax</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">dat_hL2</span><span class="o">.</span><span class="n">TIME</span><span class="p">,</span><span class="n">dat_hL2</span><span class="o">.</span><span class="n">VIB</span><span class="p">[</span><span class="mi">0</span><span class="p">,:])</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;VIB [ms$^{-2}$]&#39;</span><span class="p">)</span>


<span class="n">ax</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">dat_hL4</span><span class="o">.</span><span class="n">TIME</span><span class="p">,</span><span class="n">dat_hL4</span><span class="o">.</span><span class="n">EPSI</span><span class="p">[</span><span class="mi">0</span><span class="p">,:],</span><span class="n">label</span><span class="o">=</span><span class="sa">r</span><span class="s1">&#39;$\epsilon_1$&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">dat_hL4</span><span class="o">.</span><span class="n">TIME</span><span class="p">,</span><span class="n">dat_hL4</span><span class="o">.</span><span class="n">EPSI</span><span class="p">[</span><span class="mi">1</span><span class="p">,:],</span><span class="n">label</span><span class="o">=</span><span class="sa">r</span><span class="s1">&#39;$\epsilon_2$&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">dat_hL4</span><span class="o">.</span><span class="n">TIME</span><span class="p">,</span><span class="n">dat_hL4</span><span class="o">.</span><span class="n">EPSI_FINAL</span><span class="p">,</span><span class="n">c</span><span class="o">=</span><span class="s1">&#39;k&#39;</span><span class="p">,</span><span class="n">marker</span><span class="o">=</span><span class="s1">&#39;x&#39;</span><span class="p">,</span><span class="n">label</span><span class="o">=</span><span class="sa">r</span><span class="s1">&#39;$\epsilon$&#39;</span><span class="p">)</span>


<span class="c1">### EDIT HERE, only dummies used</span>
<span class="c1">#identify two regions of dissipation (strong versus quiescent) </span>
<span class="n">i</span><span class="o">=</span> <span class="mi">1</span>   <span class="c1"># strong dissipation</span>
<span class="n">j</span><span class="o">=</span> <span class="mi">2</span>   <span class="c1"># weak dissipation</span>

<span class="n">ax</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span><span class="o">.</span><span class="n">axvline</span><span class="p">(</span><span class="n">pd</span><span class="o">.</span><span class="n">to_datetime</span><span class="p">(</span><span class="n">dat_hL4</span><span class="o">.</span><span class="n">TIME</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">),</span><span class="n">c</span><span class="o">=</span><span class="s1">&#39;grey&#39;</span><span class="p">,</span><span class="n">lw</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span><span class="o">.</span><span class="n">axvline</span><span class="p">(</span><span class="n">pd</span><span class="o">.</span><span class="n">to_datetime</span><span class="p">(</span><span class="n">dat_hL4</span><span class="o">.</span><span class="n">TIME</span><span class="p">[</span><span class="n">j</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">),</span><span class="n">c</span><span class="o">=</span><span class="s1">&#39;grey&#39;</span><span class="p">,</span><span class="n">lw</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>

<span class="n">ax</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span><span class="o">.</span><span class="n">set_yscale</span><span class="p">(</span><span class="s1">&#39;log&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;$\epsilon \mathrm{[W kg^{-1}]}$&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;time&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Text(0.5, 0, &#39;time&#39;)
</pre></div>
</div>
<img alt="_images/ff4f11a97759b9a032dc8f9d21bf511526707bf5debab5af5df143bd62368e1d.png" src="_images/ff4f11a97759b9a032dc8f9d21bf511526707bf5debab5af5df143bd62368e1d.png" />
</div>
</div>
</section>
<section id="id5">
<h4>Create model Nasmyth Spectra for chosen dissipation rates in the data<a class="headerlink" href="#id5" title="Link to this heading">#</a></h4>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># print dissipation values for chosen spectra and create model nasmyth shear spectra</span>

<span class="n">knas_strong</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">100</span><span class="p">,</span><span class="nb">len</span><span class="p">(</span><span class="n">dat_hL3</span><span class="o">.</span><span class="n">KCYC</span><span class="p">[:,</span><span class="n">i</span><span class="p">]))</span>
<span class="nb">print</span><span class="p">(</span><span class="n">dat_hL4</span><span class="o">.</span><span class="n">EPSI_FINAL</span><span class="p">[</span><span class="n">i</span><span class="p">])</span>
<span class="n">nasmyth_strong</span> <span class="o">=</span> <span class="n">Nasfunc</span><span class="p">(</span><span class="n">knas_strong</span><span class="p">,</span><span class="n">dat_hL4</span><span class="o">.</span><span class="n">EPSI_FINAL</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="n">dat_hL4</span><span class="o">.</span><span class="n">EPSI_FINAL</span><span class="p">[</span><span class="n">j</span><span class="p">])</span>
<span class="n">knas_weak</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">100</span><span class="p">,</span><span class="nb">len</span><span class="p">(</span><span class="n">dat_hL3</span><span class="o">.</span><span class="n">KCYC</span><span class="p">[:,</span><span class="n">j</span><span class="p">]))</span>
<span class="n">nasmyth_weak</span> <span class="o">=</span> <span class="n">Nasfunc</span><span class="p">(</span><span class="n">knas_weak</span><span class="p">,</span><span class="n">dat_hL4</span><span class="o">.</span><span class="n">EPSI_FINAL</span><span class="p">[</span><span class="n">j</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&lt;xarray.DataArray &#39;EPSI_FINAL&#39; ()&gt; Size: 8B
array(2.579372e-07)
Attributes:
    standard_name:  specific_turbulent_kinetic_energy_dissipation_in_sea_water
    units:          W kg-1
    long_name:      dissipation rate of turbulent kinetic energy per unit mas...
&lt;xarray.DataArray &#39;EPSI_FINAL&#39; ()&gt; Size: 8B
array(3.521117e-06)
Attributes:
    standard_name:  specific_turbulent_kinetic_energy_dissipation_in_sea_water
    units:          W kg-1
    long_name:      dissipation rate of turbulent kinetic energy per unit mas...
</pre></div>
</div>
</div>
</div>
</section>
<section id="id6">
<h4>Dissipation estimates from shear spectra<a class="headerlink" href="#id6" title="Link to this heading">#</a></h4>
<p>Look at the agreement between dissipation estimates from the two spectra. Generally, turbulence can be observed to within a factor of two.</p>
<p>1.9) Plot shear spectra at the two dissipation rates that you chose earlier. How does shear spectra relate to dissipation rates?</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">fig</span><span class="p">,</span><span class="n">ax</span><span class="o">=</span><span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span><span class="mi">4</span><span class="p">))</span>
<span class="n">fig</span><span class="o">.</span><span class="n">subplots_adjust</span><span class="p">(</span><span class="n">wspace</span><span class="o">=</span><span class="mf">0.3</span><span class="p">)</span>

<span class="c1">## Dissipation plot</span>

<span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">dat_hL4</span><span class="o">.</span><span class="n">EPSI</span><span class="p">[</span><span class="mi">0</span><span class="p">,:],</span><span class="n">dat_hL4</span><span class="o">.</span><span class="n">EPSI</span><span class="p">[</span><span class="mi">1</span><span class="p">,:],</span><span class="n">marker</span><span class="o">=</span><span class="s1">&#39;^&#39;</span><span class="p">,</span><span class="n">s</span><span class="o">=</span><span class="mi">5</span><span class="p">)</span>

<span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_yscale</span><span class="p">(</span><span class="s1">&#39;log&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_xscale</span><span class="p">(</span><span class="s1">&#39;log&#39;</span><span class="p">)</span>

<span class="c1"># Define the range for the 1-to-1 and confidence interval lines</span>
<span class="n">x_vals</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">logspace</span><span class="p">(</span><span class="o">-</span><span class="mi">7</span><span class="p">,</span> 
                     <span class="o">-</span><span class="mi">4</span><span class="p">,</span> <span class="mi">100</span><span class="p">)</span>

<span class="c1"># Plot 1:1 line</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x_vals</span><span class="p">,</span> <span class="n">x_vals</span><span class="p">,</span> <span class="s1">&#39;k&#39;</span><span class="p">)</span>

<span class="c1"># Plot factor of 2 confidence intervals</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x_vals</span><span class="p">,</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">x_vals</span><span class="p">,</span> <span class="s1">&#39;k:&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x_vals</span><span class="p">,</span> <span class="mf">0.5</span><span class="o">*</span> <span class="n">x_vals</span><span class="p">,</span> <span class="s1">&#39;k:&#39;</span><span class="p">)</span>

<span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">(</span><span class="mf">1e-7</span><span class="p">,</span><span class="mf">1e-4</span><span class="p">)</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">(</span><span class="mf">1e-7</span><span class="p">,</span><span class="mf">1e-4</span><span class="p">)</span>

<span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;$\epsilon_1 \mathrm{[W kg^{-1}]}$&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;$\epsilon_2 \mathrm{[W kg^{-1}]}$&#39;</span><span class="p">)</span>


<span class="c1">## Spectra</span>

<span class="n">ax</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">dat_hL3</span><span class="o">.</span><span class="n">KCYC</span><span class="p">[:,</span><span class="n">i</span><span class="p">],</span><span class="n">dat_hL3</span><span class="o">.</span><span class="n">SH_SPEC_CLEAN</span><span class="p">[</span><span class="mi">0</span><span class="p">,:,</span><span class="n">i</span><span class="p">],</span><span class="n">c</span><span class="o">=</span><span class="s1">&#39;tab:blue&#39;</span><span class="p">,</span><span class="n">lw</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="n">label</span><span class="o">=</span><span class="sa">r</span><span class="s1">&#39;$\Psi_</span><span class="si">{1}</span><span class="s1">$&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">dat_hL3</span><span class="o">.</span><span class="n">KCYC</span><span class="p">[:,</span><span class="n">i</span><span class="p">],</span><span class="n">dat_hL3</span><span class="o">.</span><span class="n">SH_SPEC_CLEAN</span><span class="p">[</span><span class="mi">1</span><span class="p">,:,</span><span class="n">i</span><span class="p">],</span><span class="n">c</span><span class="o">=</span><span class="s1">&#39;tab:orange&#39;</span><span class="p">,</span><span class="n">lw</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="n">label</span><span class="o">=</span><span class="sa">r</span><span class="s1">&#39;$\Psi_</span><span class="si">{2}</span><span class="s1">$&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">knas_strong</span><span class="p">,</span><span class="n">nasmyth_strong</span><span class="p">,</span><span class="n">c</span><span class="o">=</span><span class="s1">&#39;grey&#39;</span><span class="p">,</span><span class="n">lw</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="n">label</span><span class="o">=</span><span class="s1">&#39;Nasmyth Spectra&#39;</span><span class="p">)</span>

<span class="n">ax</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">dat_hL3</span><span class="o">.</span><span class="n">KCYC</span><span class="p">[:,</span><span class="n">j</span><span class="p">],</span><span class="n">dat_hL3</span><span class="o">.</span><span class="n">SH_SPEC_CLEAN</span><span class="p">[</span><span class="mi">0</span><span class="p">,:,</span><span class="n">j</span><span class="p">],</span><span class="n">c</span><span class="o">=</span><span class="s1">&#39;tab:blue&#39;</span><span class="p">,</span><span class="n">lw</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">dat_hL3</span><span class="o">.</span><span class="n">KCYC</span><span class="p">[:,</span><span class="n">j</span><span class="p">],</span><span class="n">dat_hL3</span><span class="o">.</span><span class="n">SH_SPEC_CLEAN</span><span class="p">[</span><span class="mi">1</span><span class="p">,:,</span><span class="n">j</span><span class="p">],</span><span class="n">c</span><span class="o">=</span><span class="s1">&#39;tab:orange&#39;</span><span class="p">,</span><span class="n">lw</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">knas_weak</span><span class="p">,</span><span class="n">nasmyth_weak</span><span class="p">,</span><span class="n">c</span><span class="o">=</span><span class="s1">&#39;grey&#39;</span><span class="p">,</span><span class="n">lw</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>

<span class="n">ax</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_yscale</span><span class="p">(</span><span class="s1">&#39;log&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_xscale</span><span class="p">(</span><span class="s1">&#39;log&#39;</span><span class="p">)</span>

<span class="n">ax</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">(</span><span class="mf">0.5</span><span class="p">,</span><span class="mf">1e2</span><span class="p">)</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">(</span><span class="mf">1e-6</span><span class="p">,</span><span class="mf">1e-1</span><span class="p">)</span>

<span class="n">ax</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>

<span class="n">ax</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;$k$ [cpm]&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;$\Psi$ $[s^{-2}\mathrm</span><span class="si">{cpm}</span><span class="s1">^{-1}]$&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Text(0, 0.5, &#39;$\\Psi$ $[s^{-2}\\mathrm{cpm}^{-1}]$&#39;)
</pre></div>
</div>
<img alt="_images/0ef4f86e890e1a47e7d476053243b065171c7de832745aa777ca515c54a62fe9.png" src="_images/0ef4f86e890e1a47e7d476053243b065171c7de832745aa777ca515c54a62fe9.png" />
</div>
</div>
</section>
</section>
</section>
<section id="part-ii">
<h2>Part II<a class="headerlink" href="#part-ii" title="Link to this heading">#</a></h2>
<p>Use observations of microstructure shear to understand turbulent processes in the ocean</p>
<section id="weddell-sea">
<h3>Weddell Sea<a class="headerlink" href="#weddell-sea" title="Link to this heading">#</a></h3>
<figure class="align-center" id="fig-mr-slocum">
<a class="reference internal image-reference" href="_images/microrider_slocum.png"><img alt="_images/microrider_slocum.png" src="_images/microrider_slocum.png" style="width: 40%;" />
</a>
<figcaption>
<p><span class="caption-number">Fig. 25 </span><span class="caption-text">A Rockland Scientific Microrider mounted on top of a Slocum glider.</span><a class="headerlink" href="#fig-mr-slocum" title="Link to this image">#</a></p>
</figcaption>
</figure>
<p>In this part, we will focus on a dataset collected by a Rocklands Scientific Microrider that was mounted on a Slocum glider and deployed in the seasonal sea-ice region of the Weddell Sea. Refer to <span id="id7">[<a class="reference internal" href="references.html#id3" title="I. S. Giddy, I. Fer, S. Swart, and S.-A. Nicholson. Vertical convergence of turbulent and double-diffusive heat flux drives warming and erosion of antarctic winter water in summer. Journal of Physical Oceanography, 53(8):1941–1958, 2023. URL: https://journals.ametsoc.org/view/journals/phoc/53/8/JPO-D-22-0259.1.xml (visited on 2024-11-15), doi:10.1175/JPO-D-22-0259.1.">GFSN23</a>]</span> for context.</p>
<p>As in Part I, start by looking at the spectra and dissipation rates.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># First look at the global attributes</span>
<span class="n">dat_a</span><span class="o">=</span><span class="n">xr</span><span class="o">.</span><span class="n">open_dataset</span><span class="p">(</span><span class="s1">&#39;assignment/weddell_sea/DAT_190.nc&#39;</span><span class="p">,</span> <span class="n">engine</span><span class="o">=</span><span class="s2">&quot;h5netcdf&quot;</span><span class="p">,</span><span class="n">group</span><span class="o">=</span><span class="s2">&quot;&quot;</span><span class="p">)</span>
<span class="n">dat_a</span><span class="o">.</span><span class="n">attrs</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>{&#39;platform_type&#39;: &#39;sub-surface glider&#39;,
 &#39;comment&#39;: &quot;Ocean turbulence data were collected using a Slocum electric glider as platform. Glider was deployed and recovered during the 2019-2020 SANAE South African Antarctic base resupply cruise on the RV SA Agulhas II. The MR operated continously on both dives and climbs from the surface to a depth of 500 m. The data from the MR include measurements from 2 shear probes, 2-axis piezo-accelerometers (vibration), an inclinometer (pitch and roll) and a pressure transducer. The processing of the data and the format of this data set follows the recommendations and guidelines of the SCOR Working Group 160, ATOMIX (https://wiki.uib.no/atomix), and the processing was done using the standard Matlab tools provided by Rockland Scientific. One NetCDF file per instrument&#39;s native file (typically one file per cast) is provided. Each netCDF file includes 4 groups: 4 levels of microstructure data in ATOMIX format. L1_converted : full-resolution data converted to physical units L2_cleaned : selected signals that are filtered and/or despiked before spectral analysis. Time stamp and length of the signals are same as L1. L3_spectra : wavenumber spectra from shear probes and vibration sensors L4_dissipation: dissipation estimates together with quality control parameters Spectral calculation and dissipation rate estimate details are given in the attributes and processing parameters. Spectra are obtained using 2-s fft length. Dissipation estimates are obtained over 12s segments, overlapping by 6s (50% overlap). Detailed data processing parameters and choices can be found in the attributes. Shear and vibration spectra, their complex cross-spectra, and the cleaned shear spectra using the Goodman method are provided. L4 includes estimates from both shear probes, using the cleaned spectra, as well as their average, together with quality control parameters. The figure of merit (FOM) and mean absolute deviation (MAD) relative to the Nasmyth model spectrum are used. Data quality flags for dissipation estimates are summarized in the attributes of the variable EPSI_FLAGS in the L4 group. A final dissipation estimate, EPSI_FINAL, failing the data quality control is reported as NaN; however, the individual dissipation estimates from each probe are accessible in the EPSI parameter.&quot;,
 &#39;conventions&#39;: &#39;CF-1.6, ACDD-1.3, ATOMIX&#39;,
 &#39;history&#39;: &#39;Version 1&#39;,
 &#39;data_mode&#39;: &#39;D&#39;,
 &#39;area&#39;: &#39;Seasonal Ice Zone, Weddell Sea, Southern Ocean&#39;,
 &#39;geospatial_lat_min&#39;: np.float64(-60.09980633683413),
 &#39;geospatial_lat_max&#39;: np.float64(-60.09980633683413),
 &#39;geospatial_lon_min&#39;: np.float64(0.16348079499333565),
 &#39;geospatial_lon_max&#39;: np.float64(0.16348079499333565),
 &#39;geospatial_vertical_min&#39;: np.float64(0.0),
 &#39;geospatial_vertical_max&#39;: np.float64(500.0),
 &#39;geospatial_vertical_positive&#39;: &#39;down&#39;,
 &#39;time_coverage_start&#39;: &#39;2019-12-29T04:40:03Z&#39;,
 &#39;time_coverage_end&#39;: &#39;2019-12-29T05:29:38Z&#39;,
 &#39;creator_name&#39;: &#39;Giddy, Isabelle&#39;,
 &#39;creator_email&#39;: &#39;isabelle.giddy@gu.se&#39;,
 &#39;creator_url&#39;: &#39;https://socco.org.za/&#39;,
 &#39;institution&#39;: &#39;Southern Ocean Carbon-Climate Observatory, CSIR&#39;,
 &#39;authors&#39;: &#39;Giddy, Isabelle, Fer, Ilker, and Nicholson, Sarah-Anne.;&#39;,
 &#39;project_name&#39;: &#39;Contemporary and Future Drivers of CO2 and Heat in the Southern Ocean&#39;,
 &#39;cruise&#39;: &#39;SANAE59&#39;,
 &#39;vessel&#39;: &#39;RV SA Agulhas II, IMO vessel number 9577135&#39;,
 &#39;principal_investigator&#39;: &#39;Nicholson, S-A.&#39;,
 &#39;contact&#39;: &#39;snicholson@csir.co.za&#39;,
 &#39;references&#39;: &#39;https://wiki.uib.no/atomix/; Lueck, R., I. Fer, C. E. Bluteau, M. Dengler, H. P., R. Inoue, A. LeBoyer, S.-A. Nicholson, K. Schulz, and C. Stevens (2024), Best practices recommendations for estimating dissipation rates from shear probes, Frontiers in Marine Science, 11, https://doi.org/10.3389/fmars.2024.1334327. Krahmann, Gerd (2023) GEOMAR FB1-PO Matlab Slocum glider processing toolbox. https://doi.org/10.3289/SW_4_2023. Goodman, L., Levine, E. R., and Lueck, R. G. (2006). On Measuring the Terms of the Turbulent Kinetic Energy Budget from an AUV, Journal of Atmospheric and Oceanic Technology, 23, 977\udce2\udc80\udc93990, https://doi.org/10.1175/JTECH1889.1, 2006. TN-028, https://rocklandscientific.com/support/knowledge-base/technical-notes/&#39;,
 &#39;acknowledgements&#39;: &#39;This data set is made possible by the funding the the South African National Research Foundation (SANAP200324510487) and the Department of Science and Innovation.&#39;,
 &#39;keywords&#39;: &#39;Southern Ocean Seasonal Ice Zone, glider, mixing, turbulence, dissipation rate, microstructure, shear probes&#39;,
 &#39;source&#39;: &#39;sub-surface glider&#39;,
 &#39;license&#39;: &#39;http://creativecommons.org/licenses/by/4.0/&#39;,
 &#39;citation&#39;: &#39;later&#39;,
 &#39;instrument&#39;: &#39;MicroRider-1000LP&#39;,
 &#39;instrument_serial_number&#39;: np.float64(334.0),
 &#39;instrument_sample_rate&#39;: np.float64(512.0),
 &#39;instrument_sampling_mode&#39;: &#39;continuous&#39;,
 &#39;profiling_direction&#39;: &#39;glide&#39;,
 &#39;aoa&#39;: np.float64(3.0),
 &#39;fname&#39;: &#39;/Volumes/IssMacExtension/South_BLS/MR216/ROAMMIZ_2019/L0/P/DAT_190.P&#39;,
 &#39;gradC_method&#39;: &#39;high_pass&#39;,
 &#39;gradT_method&#39;: &#39;high_pass&#39;,
 &#39;hotel_file&#39;: &#39;/Volumes/IssMacExtension/South_BLS/MR216/ROAMMIZ_2019/L1/reprocess/HOTEL/Slocum_hotelfile_forODAS_wet2.mat&#39;,
 &#39;speed_cutout&#39;: np.float64(0.02),
 &#39;speed_tau&#39;: np.float64(3.0),
 &#39;time_offset&#39;: np.float64(-4.0),
 &#39;vehicle&#39;: &#39;slocum_glider&#39;,
 &#39;temperature_source&#39;: &#39;Found within hotel file.&#39;,
 &#39;speed_source&#39;: &#39;Hotel file&#39;,
 &#39;fields_from_hotel&#39;: &#39;speed,W,depth,P,P_CTD,T_CTD,S_CTD,aoa,pitch,roll,fin,bb700,bb470,chla,lon,lat&#39;,
 &#39;setupfilestr&#39;: &#39;; 2021-10-08 16:17:49 patched configuration string\n; Standard configuration setup.cfg file for a MicroRider on a TWE Slocum glider.\n; Created by RSI, 2015-10-13\n; Any line that starts with a semicolon, &quot;;&quot;, is a comment and is ignored by \n;  software. Likewise, everything to the right of a semicolon is ignored.\n;  Use this feature to leave notes and to indicate that you have made changes \n;  to this file. Indicate the date (YYYY-MM-DD), your name and a brief \n;  description of your changes.\n; MicroRiders are internally recording instruments.\n; Edited for Nicholson MR1000 SN334, 2019-09-27 by RSI AB\n; Edited pressure coefficients to zero at RSI by subtracting 0.84 from coeff. 0   2019-09-27\n; Sensors shear and temperature have nominal values input in the setup file.\n\n; The first section is the [root] section. It determines the data \n;  acquisition parameters. It does not need to be declared explicitly.\n\nrate        = 512    ; The sampling rate of fast channels\nprefix      = dat_   ; The base name of your data files. A 3-digit \n\t\t\t\t\t ;  file number is appended to this base name.\n\t\t\t\t\t ; The limit is 8 characters total for internally\n                     ;  recording instruments.\ndisk        = /data  ; The directory for the data files. Use /data only.\nrecsize     = 1      ; The size of a record in seconds\nno-fast     = 6      ; number of fast &quot;columns&quot; in the address matrix (see below).\nno-slow     = 2      ; number of slow &quot;columns&quot; in the address matrix.\n\n; -----------------\n;This section presents the address [matrix] of your instrument and \n;  automatically ends the [root] section above. The first columns are &quot;slow&quot;\n;  channels as defined by the &quot;no-slow&quot; parameter in the [root] section.\n;  The remainder are &quot;fast&quot; columns (&quot;no-fast&quot;).\n[matrix]\nnum_rows=8\nrow01   =\t255\t0\t1\t2\t5\t7\t8\t9\t\t\nrow02   =\t32\t40\t1\t2\t5\t7\t8\t9\t\nrow03   =\t41\t42\t1\t2\t5\t7\t8\t9\t\nrow04   =\t4\t6\t1\t2\t5\t7\t8\t9\t\nrow05   =\t10\t11\t1\t2\t5\t7\t8\t9\t\nrow06   =\t12\t0\t1\t2\t5\t7\t8\t9\t\nrow07   =\t0\t0\t1\t2\t5\t7\t8\t9\t\nrow08   =\t0\t0\t1\t2\t5\t7\t8\t9\t\n\n; --------------------\n;This section identifies your instrument. Only the vehicle is important.\n[instrument_info]\nvehicle = slocum_glider ; up- and down-profiling\nmodel   = mr_1000       ; the actual model\nsn      = 334           ; the serial number of the instrument\n\n; --------------------\n; The next section is optional and can be expanded. Do not use the parameter &quot;id = &quot;.\n[cruise_info]\noperator    = Nicholson\nproject     = roammiz\nship        =\nleg         =\nglider      = \n\n; --------------------\n; Next come the [channel] sections. These are used to convert your data \n;  into physical units, and to save them into a mat-file. \n;  They also determine the name given to various signals \n;  in your data file. Please, stick to the convention of \n;  RSI because data visualization using the RSI Matlab Library of functions\n;  assumes particular names. However, data will be converted into physical\n;  units regardless of the name of the channels. If you change the names,\n;  then data visualization and further processing is your responsibility.\n;  A list of typical channel addresses (id) and their names and functions\n;  is at the end of this file.\n\n; Each channel section consists of a part that is unique to your instrument.\n;  It does not need to be changed. The second part is dependent on your \n;  sensors (shear probes, FP07 thermistors, etc.) and must be updated \n;  whenever you change a probe.\n\n; The ground reference channel.\n[channel]\nid      = 0   ; the channel address, 0 to 255.  Listed in the [matrix] section.\nname    = Gnd ; the name it will have in the mat-file.\ntype    = gnd ; the algorithm used to convert raw data into physical units.\ncoef0   = 0   ; the coefficients required for conversion. None in this case.\n\n; --------------\n; The piezo-vibration sensors\n[channel]\nid      = 1\nname    = Ax\ntype    = piezo\n\n[channel]\nid      = 2\nname    = Ay\ntype    = piezo\n\n; -----------------\n; The thermistor channels\n; without pre-emphasis\n[channel]\nid=4\nname=T1\ntype=therm\n; instrument dependent parameters\nadc_fs  = 4.096\nadc_bits= 16\na       =-7.5\nb       = 0.99822\nG       = 6.0\nE_B     = 0.68218\n; sensor dependent parameters. To be changed by user.\nSN      = T\nbeta_1  = 3143.55\nbeta_2  = 2.5e5\nT_0     = 289.301\ncal_date=\n; units = [C]\n\n; with pre-emphasis\n[channel]\nid          = 5\nname        = T1_dT1\ntype        = therm\n; instrument dependent parameter\ndiff_gain   = 0.930\n\n; without pre-emphasis\n[channel]\nid      = 6\nname    = T2\ntype    = therm\n; instrument dependent parameters\nadc_fs  = 4.096\nadc_bits= 16\na       =-9.3\nb       = 0.99821\nG       = 6.0\nE_B     = 0.68228\n; sensor dependent parameters. To be changed by user.\nSN      = T\nbeta_1  = 3143.55\nbeta_2  = 2.5e5\nT_0     = 289.301\ncal_date=\n; units = [C]\n\n; with pre-emphasis\n[channel]\nid          = 7\nname        = T2_dT2\ntype        = therm\ndiff_gain   = 0.926\n\n; -----------------\n; The shear probe channels\n[channel]\nid          = 8\nname        = sh1\ntype        = shear\n; instrument dependent parameters\nadc_fs      = 4.096\nadc_bits    = 16\ndiff_gain   = 0.936\n; sensor dependent parameters. To be changed by user.\nsens        = 0.0517\nSN          = M2076\ncal_date    =\n\n[channel]\nid          = 9\nname        = sh2\ntype        = shear\n; instrument dependent parameters\nadc_fs      = 4.096\nadc_bits    = 16\ndiff_gain   = 0.939\n; sensor dependent parameters. To be changed by user.\nsens        = 0.0753\nSN          = M2091\ncal_date    =\n\n; -----------------\n; The pressure transducer\n; without pre-emphasis\n[channel]\nid          = 10\nname        = P\ntype        = poly\n; instrument dependent parameters\ncoef0       = -4.87      ;offset reading to zero. -4.03(coef0) - 0.84(p.ch. reading)= -4.87\ncoef1       = 0.061704\ncoef2       = 3.3024e-8\ncal_date    = 2019-09-26\n;units       = [dBar]\n\n; with pre-emphasis\n[channel]\nid          = 11\nname        = P_dP\ntype        = poly\n; instrument dependent parameters\ndiff_gain   = 20.58\n\n; pressure transducer voltage\n[channel]\nid      = 12\nname    = PV\ntype    = poly\n; instrument dependent parameters\ncoef0   = 4.096\ncoef1   = 1.25e-4\n; units   = [V]\n\n; -----------------\n; Battery voltage or power supply voltage\n[channel]\nid          = 32\nname        = V_Bat\ntype        = voltage\n; instrument dependent parameters\nG           = 0.1\nadc_fs      = 4.096\nadc_bits    = 16\n; units       = [V]\n\n; -----------------\n; The ADIS precision inclinometer with built in thermometer\n[channel]\nid      = 40\nname    = Incl_Y\ntype    = inclxy\n; instrument dependent parameters\ncoef0   = 0\ncoef1   = 0.025\n; units   = [degree]\n\n[channel]\nid      = 41\nname    = Incl_X\ntype    = inclxy\n; instrument dependent parameters\ncoef0   = 0\ncoef1   = -0.025\n; units   = [degree]\n\n[channel]\nid      = 42\nname    = Incl_T\ntype    = inclt\n; instrument dependent parameters\ncoef0   = 624\ncoef1   =-0.47\n; units   = [C]\n\n; ------------------\n; This is a list of typical channels (addresses) and their signals\n; that are currently available for a MicroRider on a TWE Slocum glider.\n\n;  id     Name   - rate - Signal\n; -------------------------------------------------------------------\n;  0     Gnd     - slow - Reference ground\n;  1     Ax      - fast - horizontal acceleration in the direction of the pressure port or ON/OFF magnet\n;  2     Ay      - fast - horizontal acceleration orthogonal to the direction of the pressure port\n;  4     T1      - slow - Temperature from Thermistor 1 without pre-emphasis\n;  5     T1_dT1  - fast - Temperature from Thermistor 1 with pre-emphasis\n;  6     T2      - slow - Temperature from Thermistor 2 without pre-emphasis\n;  7     T2_dT2  - fast - Temperature from Thermistor 2 with pre-emphasis\n;  8     sh1     - fast - velocity derivative from shear probe 1\n;  9 \t sh2     - fast - velocity derivative from shear probe 2\n; 10     P       - slow - pressure signal without pre-emphasis\n; 11     P_dP    - slow - pressure signal with pre-emphasis\n; 12     PV      - slow - voltage on pressure transducer\n; 32     V_Bat   - slow - Battery or power supply voltage\n; 40     Incl_Y  - slow - Inclinometer, rotation around the y-axis\n; 41     Incl_X  - slow - Inclinometer, rotation around the x-axis\n; 42     Incl_T  - slow - Inclinometer, its temperature \n; 255    sp_char - slow - special Character that always returns 32752D or 7FF0H and \n;                         is used to test the integrity of communication.\n\n; End of setup configuration file.\n\n\n\n; ### Original Configuration String Below ###\n; ; Standard configuration setup.cfg file for a MicroRider on a TWE Slocum glider.\n; ; Created by RSI, 2015-10-13\n; ; Any line that starts with a semicolon, &quot;;&quot;, is a comment and is ignored by \n; ;  software. Likewise, everything to the right of a semicolon is ignored.\n; ;  Use this feature to leave notes and to indicate that you have made changes \n; ;  to this file. Indicate the date (YYYY-MM-DD), your name and a brief \n; ;  description of your changes.\n; ; MicroRiders are internally recording instruments.\n; ; Edited for Nicholson MR1000 SN334, 2019-09-27 by RSI AB\n; ; Edited pressure coefficients to zero at RSI by subtracting 0.84 from coeff. 0   2019-09-27\n; ; Sensors shear and temperature have nominal values input in the setup file.\n; \n; ; The first section is the [root] section. It determines the data \n; ;  acquisition parameters. It does not need to be declared explicitly.\n; \n; rate        = 512    ; The sampling rate of fast channels\n; prefix      = dat_   ; The base name of your data files. A 3-digit \n; \t\t\t\t\t ;  file number is appended to this base name.\n; \t\t\t\t\t ; The limit is 8 characters total for internally\n;                      ;  recording instruments.\n; disk        = /data  ; The directory for the data files. Use /data only.\n; recsize     = 1      ; The size of a record in seconds\n; no-fast     = 6      ; number of fast &quot;columns&quot; in the address matrix (see below).\n; no-slow     = 2      ; number of slow &quot;columns&quot; in the address matrix.\n; \n; ; -----------------\n; ;This section presents the address [matrix] of your instrument and \n; ;  automatically ends the [root] section above. The first columns are &quot;slow&quot;\n; ;  channels as defined by the &quot;no-slow&quot; parameter in the [root] section.\n; ;  The remainder are &quot;fast&quot; columns (&quot;no-fast&quot;).\n; [matrix]\n; num_rows=8\n; row01   =\t255\t0\t1\t2\t5\t7\t8\t9\t\t\n; row02   =\t32\t40\t1\t2\t5\t7\t8\t9\t\n; row03   =\t41\t42\t1\t2\t5\t7\t8\t9\t\n; row04   =\t4\t6\t1\t2\t5\t7\t8\t9\t\n; row05   =\t10\t11\t1\t2\t5\t7\t8\t9\t\n; row06   =\t12\t0\t1\t2\t5\t7\t8\t9\t\n; row07   =\t0\t0\t1\t2\t5\t7\t8\t9\t\n; row08   =\t0\t0\t1\t2\t5\t7\t8\t9\t\n; \n; ; --------------------\n; ;This section identifies your instrument. Only the vehicle is important.\n; [instrument_info]\n; vehicle = slocum_glider ; up- and down-profiling\n; model   = mr_1000       ; the actual model\n; sn      = 334           ; the serial number of the instrument\n; \n; ; --------------------\n; ; The next section is optional and can be expanded. Do not use the parameter &quot;id = &quot;.\n; [cruise_info]\n; operator    = Nicholson\n; project     = \n; ship        =\n; leg         =\n; glider      =\n; \n; ; --------------------\n; ; Next come the [channel] sections. These are used to convert your data \n; ;  into physical units, and to save them into a mat-file. \n; ;  They also determine the name given to various signals \n; ;  in your data file. Please, stick to the convention of \n; ;  RSI because data visualization using the RSI Matlab Library of functions\n; ;  assumes particular names. However, data will be converted into physical\n; ;  units regardless of the name of the channels. If you change the names,\n; ;  then data visualization and further processing is your responsibility.\n; ;  A list of typical channel addresses (id) and their names and functions\n; ;  is at the end of this file.\n; \n; ; Each channel section consists of a part that is unique to your instrument.\n; ;  It does not need to be changed. The second part is dependent on your \n; ;  sensors (shear probes, FP07 thermistors, etc.) and must be updated \n; ;  whenever you change a probe.\n; \n; ; The ground reference channel.\n; [channel]\n; id      = 0   ; the channel address, 0 to 255.  Listed in the [matrix] section.\n; name    = Gnd ; the name it will have in the mat-file.\n; type    = gnd ; the algorithm used to convert raw data into physical units.\n; coef0   = 0   ; the coefficients required for conversion. None in this case.\n; \n; ; --------------\n; ; The piezo-vibration sensors\n; [channel]\n; id      = 1\n; name    = Ax\n; type    = piezo\n; \n; [channel]\n; id      = 2\n; name    = Ay\n; type    = piezo\n; \n; ; -----------------\n; ; The thermistor channels\n; ; without pre-emphasis\n; [channel]\n; id=4\n; name=T1\n; type=therm\n; ; instrument dependent parameters\n; adc_fs  = 4.096\n; adc_bits= 16\n; a       =-7.5\n; b       = 0.99822\n; G       = 6.0\n; E_B     = 0.68218\n; ; sensor dependent parameters. To be changed by user.\n; SN      = T\n; beta_1  = 3143.55\n; beta_2  = 2.5e5\n; T_0     = 289.301\n; cal_date=\n; ; units = [C]\n; \n; ; with pre-emphasis\n; [channel]\n; id          = 5\n; name        = T1_dT1\n; type        = therm\n; ; instrument dependent parameter\n; diff_gain   = 0.930\n; \n; ; without pre-emphasis\n; [channel]\n; id      = 6\n; name    = T2\n; type    = therm\n; ; instrument dependent parameters\n; adc_fs  = 4.096\n; adc_bits= 16\n; a       =-9.3\n; b       = 0.99821\n; G       = 6.0\n; E_B     = 0.68228\n; ; sensor dependent parameters. To be changed by user.\n; SN      = T\n; beta_1  = 3143.55\n; beta_2  = 2.5e5\n; T_0     = 289.301\n; cal_date=\n; ; units = [C]\n; \n; ; with pre-emphasis\n; [channel]\n; id          = 7\n; name        = T2_dT2\n; type        = therm\n; diff_gain   = 0.926\n; \n; ; -----------------\n; ; The shear probe channels\n; [channel]\n; id          = 8\n; name        = sh1\n; type        = shear\n; ; instrument dependent parameters\n; adc_fs      = 4.096\n; adc_bits    = 16\n; diff_gain   = 0.936\n; ; sensor dependent parameters. To be changed by user.\n; sens        = 0.0700\n; SN          = M\n; cal_date    =\n; \n; [channel]\n; id          = 9\n; name        = sh2\n; type        = shear\n; ; instrument dependent parameters\n; adc_fs      = 4.096\n; adc_bits    = 16\n; diff_gain   = 0.939\n; ; sensor dependent parameters. To be changed by user.\n; sens        = 0.0700\n; SN          = M\n; cal_date    =\n; \n; ; -----------------\n; ; The pressure transducer\n; ; without pre-emphasis\n; [channel]\n; id          = 10\n; name        = P\n; type        = poly\n; ; instrument dependent parameters\n; coef0       = -4.87      ;offset reading to zero. -4.03(coef0) - 0.84(p.ch. reading)= -4.87\n; coef1       = 0.061704\n; coef2       = 3.3024e-8\n; cal_date    = 2019-09-26\n; ;units       = [dBar]\n; \n; ; with pre-emphasis\n; [channel]\n; id          = 11\n; name        = P_dP\n; type        = poly\n; ; instrument dependent parameters\n; diff_gain   = 20.58\n; \n; ; pressure transducer voltage\n; [channel]\n; id      = 12\n; name    = PV\n; type    = poly\n; ; instrument dependent parameters\n; coef0   = 4.096\n; coef1   = 1.25e-4\n; ; units   = [V]\n; \n; ; -----------------\n; ; Battery voltage or power supply voltage\n; [channel]\n; id          = 32\n; name        = V_Bat\n; type        = voltage\n; ; instrument dependent parameters\n; G           = 0.1\n; adc_fs      = 4.096\n; adc_bits    = 16\n; ; units       = [V]\n; \n; ; -----------------\n; ; The ADIS precision inclinometer with built in thermometer\n; [channel]\n; id      = 40\n; name    = Incl_Y\n; type    = inclxy\n; ; instrument dependent parameters\n; coef0   = 0\n; coef1   = 0.025\n; ; units   = [degree]\n; \n; [channel]\n; id      = 41\n; name    = Incl_X\n; type    = inclxy\n; ; instrument dependent parameters\n; coef0   = 0\n; coef1   = -0.025\n; ; units   = [degree]\n; \n; [channel]\n; id      = 42\n; name    = Incl_T\n; type    = inclt\n; ; instrument dependent parameters\n; coef0   = 624\n; coef1   =-0.47\n; ; units   = [C]\n; \n; ; ------------------\n; ; This is a list of typical channels (addresses) and their signals\n; ; that are currently available for a MicroRider on a TWE Slocum glider.\n; \n; ;  id     Name   - rate - Signal\n; ; -------------------------------------------------------------------\n; ;  0     Gnd     - slow - Reference ground\n; ;  1     Ax      - fast - horizontal acceleration in the direction of the pressure port or ON/OFF magnet\n; ;  2     Ay      - fast - horizontal acceleration orthogonal to the direction of the pressure port\n; ;  4     T1      - slow - Temperature from Thermistor 1 without pre-emphasis\n; ;  5     T1_dT1  - fast - Temperature from Thermistor 1 with pre-emphasis\n; ;  6     T2      - slow - Temperature from Thermistor 2 without pre-emphasis\n; ;  7     T2_dT2  - fast - Temperature from Thermistor 2 with pre-emphasis\n; ;  8     sh1     - fast - velocity derivative from shear probe 1\n; ;  9 \t sh2     - fast - velocity derivative from shear probe 2\n; ; 10     P       - slow - pressure signal without pre-emphasis\n; ; 11     P_dP    - slow - pressure signal with pre-emphasis\n; ; 12     PV      - slow - voltage on pressure transducer\n; ; 32     V_Bat   - slow - Battery or power supply voltage\n; ; 40     Incl_Y  - slow - Inclinometer, rotation around the y-axis\n; ; 41     Incl_X  - slow - Inclinometer, rotation around the x-axis\n; ; 42     Incl_T  - slow - Inclinometer, its temperature \n; ; 255    sp_char - slow - special Character that always returns 32752D or 7FF0H and \n; ;                         is used to test the integrity of communication.\n; \n; ; End of setup configuration file.\n; \n; &#39;,
 &#39;date&#39;: &#39;29-Dec-2019 04:40:03&#39;,
 &#39;time_reference_year&#39;: np.float64(2020.0),
 &#39;profile_dir&#39;: &#39;glide&#39;,
 &#39;fs_slow&#39;: np.float64(64.00409375),
 &#39;fs_fast&#39;: np.float64(512.03275),
 &#39;fft_length_sec&#39;: np.float64(2.0),
 &#39;diss_length_sec&#39;: np.float64(12.0),
 &#39;overlap_sec&#39;: np.float64(6.0),
 &#39;fft_length&#39;: np.float64(1024.0),
 &#39;diss_length&#39;: np.float64(6144.0),
 &#39;overlap&#39;: np.float64(3072.0),
 &#39;goodman&#39;: np.float32(1.0),
 &#39;fit_order&#39;: np.float64(3.0),
 &#39;f_AA&#39;: np.float64(98.0),
 &#39;profile_min_W&#39;: np.float64(0.15),
 &#39;profile_min_duration&#39;: np.float64(30.0),
 &#39;profile_min_P&#39;: np.float64(1.0),
 &#39;HP_cut&#39;: np.float64(0.25),
 &#39;despike_sh&#39;: array([8.  , 0.3 , 0.04]),
 &#39;despike_A&#39;: array([8.  , 0.3 , 0.04]),
 &#39;despike_shear_fraction_limit&#39;: np.float64(0.2),
 &#39;FOM_limit&#39;: np.float64(1.15),
 &#39;diss_ratio_limit&#39;: np.float64(2.772),
 &#39;despike_shear_iterations_limit&#39;: np.float64(11.0),
 &#39;min_pitch_threshold&#39;: np.float64(5.0),
 &#39;vibrations_removed_indices&#39;: array([ 103975.,  103976.,  103977., ..., 1484968., 1484969., 1484970.],
       shape=(55796,)),
 &#39;vibrations_removed_percent&#39;: np.float64(3.661846858198925),
 &#39;spectral_model&#39;: &#39;Lueck&#39;,
 &#39;refine_section&#39;: np.float64(1.0),
 &#39;variance_resolved_limit&#39;: np.float64(0.5),
 &#39;fit_2_isr&#39;: np.float64(1.5e-05),
 &#39;f_limit&#39;: np.float64(inf),
 &#39;num_vibration_goodman&#39;: np.float64(2.0),
 &#39;num_fft_segments&#39;: np.float64(11.0),
 &#39;spectrum_std&#39;: np.float64(0.4757301730292029),
 &#39;PMAX&#39;: np.float64(510.10317381282397),
 &#39;LON&#39;: np.float64(0.16348079499333565),
 &#39;LAT&#39;: np.float64(-60.09980633683413),
 &#39;creation_time&#39;: &#39;2025-02-05T14:02:40Z&#39;,
 &#39;date_update&#39;: &#39;2025-02-05T14:02:40Z&#39;,
 &#39;date_created&#39;: &#39;2025-02-05&#39;,
 &#39;title&#39;: &#39;Dissipation measurements from a Slocum Glider in the Southern Ocean during austral summer 2017, 2018 and 2019&#39;,
 &#39;summary&#39;: &#39;This dataset includes data from 3 missions in the Southern Ocean between 2017 and 2020. This data file is for the mission in the Seasonal Ice Zone between 2019 and 2020. Ocean microstructure data were collected using a turbulence package mounted on a Slocum and deployed from RV SA Agulhas II in the North Eastern Weddell Sea, [60S; 0E], from December 2019 to February 2020. Observations conducted by the Southern Ocean Carbon-Climate Observatory, Smart Places, CSIR, for the project &quot;Contemporary and Future Drivers of CO2 and Heat in the Southern Ocean&quot; funded by NRF-SANAP (SANAP200324510487) and in collaboration with Polar Gliders, University of Gothenburg (Project &quot;Robotic Observations and Modelling of the Marginal Ice Zone&quot; funded by the Wallenberg Academy Fellowship (WAF 2015.0186). Turbulence data were collected using a Rockland Scientific MicroRider mounted on the SLOCUM. Microshear was measured using two airfoil shear probes oriented orthogonally to each other. The measurements are from 47 days of dive and climb profiles. The glider profiled to 1000 m, but the MicroRider only recorded to 500 m. Dissipation rate was measured using two airfoil shear probes. The dissipation dataset is processed and prepared following the SCOR Working Group ATOMIX guidelines and convention (Lueck et al., 2024). The glider data are processed using the GEOMAR Matlab Slocum glider processing toolbox (Krahmann, 2023). One NetCDF(NC) file per instrument\&#39;s native file (typically one file per cast) is provided. Each provided NC file includes four hierarchical groups. Each consists of a continuous time series of full-resolution data converted into physical units; the cleaned time series used for spectral analysis, wavenumber spectra, and the dissipation rate estimates. Because each file includes full-resolution data at two levels and full-resolution spectra in the third group, the grouped NC files are large in size and may be unpractical to download and merge. For users only interested in the dissipation and the glider flight metrics and CTD profiles (in the hotel file), we also provide two separate NC files with all sections from the L4_dissipation and the hotel file collated into one file each. Further details are provided in the comments.&#39;}
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">dat_wL1</span><span class="o">=</span><span class="n">xr</span><span class="o">.</span><span class="n">open_dataset</span><span class="p">(</span><span class="s1">&#39;assignment/weddell_sea/DAT_190.nc&#39;</span><span class="p">,</span> <span class="n">engine</span><span class="o">=</span><span class="s2">&quot;h5netcdf&quot;</span><span class="p">,</span><span class="n">group</span><span class="o">=</span><span class="s2">&quot;L1_converted&quot;</span><span class="p">)</span>
<span class="n">dat_wL2</span><span class="o">=</span><span class="n">xr</span><span class="o">.</span><span class="n">open_dataset</span><span class="p">(</span><span class="s1">&#39;assignment/weddell_sea/DAT_190.nc&#39;</span><span class="p">,</span> <span class="n">engine</span><span class="o">=</span><span class="s2">&quot;h5netcdf&quot;</span><span class="p">,</span><span class="n">group</span><span class="o">=</span><span class="s2">&quot;L2_cleaned&quot;</span><span class="p">)</span>
<span class="n">dat_wL3</span><span class="o">=</span><span class="n">xr</span><span class="o">.</span><span class="n">open_dataset</span><span class="p">(</span><span class="s1">&#39;assignment/weddell_sea/DAT_190.nc&#39;</span><span class="p">,</span> <span class="n">engine</span><span class="o">=</span><span class="s2">&quot;h5netcdf&quot;</span><span class="p">,</span><span class="n">group</span><span class="o">=</span><span class="s2">&quot;L3_spectra&quot;</span><span class="p">)</span>
<span class="n">dat_wL4</span><span class="o">=</span><span class="n">xr</span><span class="o">.</span><span class="n">open_dataset</span><span class="p">(</span><span class="s1">&#39;assignment/weddell_sea/DAT_190.nc&#39;</span><span class="p">,</span> <span class="n">engine</span><span class="o">=</span><span class="s2">&quot;h5netcdf&quot;</span><span class="p">,</span><span class="n">group</span><span class="o">=</span><span class="s2">&quot;L4_dissipation&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<section id="plot-vertical-profile-of-temperature-salinity-density-and-vertical-stratification">
<h4>Plot vertical profile of temperature, salinity, density and vertical stratification<a class="headerlink" href="#plot-vertical-profile-of-temperature-salinity-density-and-vertical-stratification" title="Link to this heading">#</a></h4>
<p>2.1 Describe what you can about the hydrographic structure from this plot.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># calculate density and stratification</span>
<span class="n">rho</span><span class="o">=</span><span class="n">gsw</span><span class="o">.</span><span class="n">rho</span><span class="p">(</span><span class="n">dat_wL1</span><span class="o">.</span><span class="n">SALT</span><span class="p">,</span><span class="n">dat_wL1</span><span class="o">.</span><span class="n">TEMP_CTD</span><span class="p">,</span><span class="n">dat_wL1</span><span class="o">.</span><span class="n">PRES_SLOW</span><span class="p">)</span>

<span class="n">rho_sorted</span> <span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">sort</span><span class="p">(</span><span class="n">rho</span><span class="p">)</span> 

<span class="c1"># Compute brunt-vaisala frequency </span>
<span class="n">g</span><span class="o">=</span><span class="mf">9.8</span>
<span class="n">p0</span><span class="o">=</span><span class="mi">1025</span>
<span class="c1"># n2 = g/p0*(np.diff(rho_sorted)/np.diff(low_res_ctd.z))</span>
<span class="n">drho_dz</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">gradient</span><span class="p">(</span><span class="n">rho_sorted</span><span class="p">,</span> <span class="n">dat_wL1</span><span class="o">.</span><span class="n">PRES_SLOW</span><span class="p">)</span>
<span class="n">n2</span> <span class="o">=</span> <span class="n">g</span><span class="o">/</span><span class="n">p0</span><span class="o">*</span><span class="n">drho_dz</span>

<span class="k">def</span><span class="w"> </span><span class="nf">smooth</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">window_len</span><span class="o">=</span><span class="mi">5</span><span class="p">):</span>
    <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">convolve</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">ones</span><span class="p">(</span><span class="n">window_len</span><span class="p">)</span><span class="o">/</span><span class="n">window_len</span><span class="p">,</span> <span class="n">mode</span><span class="o">=</span><span class="s1">&#39;same&#39;</span><span class="p">)</span>

<span class="n">n2_smooth</span> <span class="o">=</span> <span class="n">smooth</span><span class="p">(</span><span class="n">n2</span><span class="p">,</span> <span class="n">window_len</span><span class="o">=</span><span class="mi">1000</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>/Users/xnunei/miniconda3/envs/jb/lib/python3.13/site-packages/numpy/lib/_function_base_impl.py:1290: RuntimeWarning: divide by zero encountered in divide
  a = -(dx2)/(dx1 * (dx1 + dx2))
/Users/xnunei/miniconda3/envs/jb/lib/python3.13/site-packages/numpy/lib/_function_base_impl.py:1290: RuntimeWarning: invalid value encountered in divide
  a = -(dx2)/(dx1 * (dx1 + dx2))
/Users/xnunei/miniconda3/envs/jb/lib/python3.13/site-packages/numpy/lib/_function_base_impl.py:1291: RuntimeWarning: divide by zero encountered in divide
  b = (dx2 - dx1) / (dx1 * dx2)
/Users/xnunei/miniconda3/envs/jb/lib/python3.13/site-packages/numpy/lib/_function_base_impl.py:1291: RuntimeWarning: invalid value encountered in divide
  b = (dx2 - dx1) / (dx1 * dx2)
/Users/xnunei/miniconda3/envs/jb/lib/python3.13/site-packages/numpy/lib/_function_base_impl.py:1292: RuntimeWarning: divide by zero encountered in divide
  c = dx1 / (dx2 * (dx1 + dx2))
/Users/xnunei/miniconda3/envs/jb/lib/python3.13/site-packages/numpy/lib/_function_base_impl.py:1292: RuntimeWarning: invalid value encountered in divide
  c = dx1 / (dx2 * (dx1 + dx2))
/Users/xnunei/miniconda3/envs/jb/lib/python3.13/site-packages/numpy/lib/_function_base_impl.py:1298: RuntimeWarning: invalid value encountered in add
  out[tuple(slice1)] = a * f[tuple(slice2)] + b * f[tuple(slice3)] + c * f[tuple(slice4)]
/Users/xnunei/miniconda3/envs/jb/lib/python3.13/site-packages/numpy/lib/_function_base_impl.py:1307: RuntimeWarning: divide by zero encountered in scalar divide
  out[tuple(slice1)] = (f[tuple(slice2)] - f[tuple(slice3)]) / dx_0
/Users/xnunei/miniconda3/envs/jb/lib/python3.13/site-packages/numpy/lib/_function_base_impl.py:1314: RuntimeWarning: invalid value encountered in scalar divide
  out[tuple(slice1)] = (f[tuple(slice2)] - f[tuple(slice3)]) / dx_n
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">fig</span><span class="p">,</span><span class="n">ax</span><span class="o">=</span><span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">4</span><span class="p">,</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span><span class="mi">5</span><span class="p">),</span><span class="n">sharey</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">dat_wL1</span><span class="o">.</span><span class="n">TEMP_CTD</span><span class="p">,</span><span class="n">dat_wL1</span><span class="o">.</span><span class="n">PRES_SLOW</span><span class="p">)</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">(</span><span class="mi">150</span><span class="p">,</span><span class="mi">0</span><span class="p">)</span>
<span class="c1"># ax[0].set_xlim(9.5,11)</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;Pressure [db]&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;Temperature [°C]&#39;</span><span class="p">)</span>

<span class="n">ax</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">dat_wL1</span><span class="o">.</span><span class="n">SALT</span><span class="p">,</span><span class="n">dat_wL1</span><span class="o">.</span><span class="n">PRES_SLOW</span><span class="p">)</span>
<span class="c1"># ax[1].set_xlim(34.3,35.8)</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;Absolute Salinity [g/kg]&#39;</span><span class="p">)</span>

<span class="n">ax</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">rho</span><span class="o">-</span><span class="mi">1000</span><span class="p">,</span><span class="n">dat_wL1</span><span class="o">.</span><span class="n">PRES_SLOW</span><span class="p">)</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">(</span><span class="mi">27</span><span class="p">,</span><span class="mf">28.5</span><span class="p">)</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;Density [kgm$^{-3}$]&#39;</span><span class="p">)</span>


<span class="n">ax</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">n2</span><span class="p">),</span><span class="n">dat_wL1</span><span class="o">.</span><span class="n">PRES_SLOW</span><span class="p">[:])</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">n2_smooth</span><span class="p">),</span><span class="n">dat_wL1</span><span class="o">.</span><span class="n">PRES_SLOW</span><span class="p">[:],</span><span class="n">c</span><span class="o">=</span><span class="s1">&#39;k&#39;</span><span class="p">)</span>

<span class="n">ax</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">(</span><span class="mf">1e-5</span><span class="p">,</span><span class="mf">1e-3</span><span class="p">)</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;N$^2$ [s$^{-2}$]&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span><span class="o">.</span><span class="n">set_xscale</span><span class="p">(</span><span class="s1">&#39;log&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/c778b5eb2fdff618e39755c2365174644c5f10f371b7f5579480bc666f1fc9ca.png" src="_images/c778b5eb2fdff618e39755c2365174644c5f10f371b7f5579480bc666f1fc9ca.png" />
</div>
</div>
</section>
<section id="id8">
<h4>Plot time series<a class="headerlink" href="#id8" title="Link to this heading">#</a></h4>
<p>Below are time series of a) Pressure and Velocity through water, b) vertical shear, c) platform vibrations and d) turbulence dissipation rate.</p>
<p>2.2a) Describe the vertical profile of the dissipation rate of turbulence (where dissipation rate is high, where it is low) with reference to the distance from the surface and the temperature profile.<br />
2.2b) Select two points, one with high dissipation rate and one with low dissipation rate and overlay vertical lines at these chosen points in subpanels d).</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">fig</span><span class="p">,</span><span class="n">ax</span><span class="o">=</span><span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">4</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span><span class="mi">8</span><span class="p">),</span><span class="n">sharex</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

<span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">dat_wL1</span><span class="o">.</span><span class="n">TIME</span><span class="p">,</span><span class="n">dat_wL1</span><span class="o">.</span><span class="n">PRES</span><span class="p">,</span><span class="n">lw</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;Pressure [db]&#39;</span><span class="p">)</span>

<span class="n">axa</span><span class="o">=</span><span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">twinx</span><span class="p">()</span>
<span class="n">axa</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">dat_wL2</span><span class="o">.</span><span class="n">TIME</span><span class="p">,</span><span class="n">dat_wL2</span><span class="o">.</span><span class="n">PSPD_REL</span><span class="p">,</span><span class="n">c</span><span class="o">=</span><span class="s1">&#39;tab:orange&#39;</span><span class="p">,</span><span class="n">lw</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
<span class="n">axa</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;W [ms$^{-1}$]&#39;</span><span class="p">,</span><span class="n">c</span><span class="o">=</span><span class="s1">&#39;tab:orange&#39;</span><span class="p">)</span>


<span class="n">ax</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">dat_wL2</span><span class="o">.</span><span class="n">TIME</span><span class="p">,</span><span class="n">dat_wL2</span><span class="o">.</span><span class="n">SHEAR</span><span class="p">[</span><span class="mi">0</span><span class="p">,:])</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">dat_wL2</span><span class="o">.</span><span class="n">TIME</span><span class="p">,</span><span class="n">dat_wL2</span><span class="o">.</span><span class="n">SHEAR</span><span class="p">[</span><span class="mi">1</span><span class="p">,:])</span>

<span class="n">ax</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;$\partial u / \partial z$ [s$^{-1}$]&#39;</span><span class="p">)</span>

<span class="n">ax</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">dat_wL2</span><span class="o">.</span><span class="n">TIME</span><span class="p">,</span><span class="n">dat_wL2</span><span class="o">.</span><span class="n">VIB</span><span class="p">[</span><span class="mi">0</span><span class="p">,:])</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;VIB [ms$^{-2}$]&#39;</span><span class="p">)</span>


<span class="n">ax</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">dat_wL4</span><span class="o">.</span><span class="n">TIME</span><span class="p">,</span><span class="n">dat_wL4</span><span class="o">.</span><span class="n">EPSI</span><span class="p">[</span><span class="mi">0</span><span class="p">,:],</span><span class="n">label</span><span class="o">=</span><span class="sa">r</span><span class="s1">&#39;$\epsilon_1$&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">dat_wL4</span><span class="o">.</span><span class="n">TIME</span><span class="p">,</span><span class="n">dat_wL4</span><span class="o">.</span><span class="n">EPSI</span><span class="p">[</span><span class="mi">1</span><span class="p">,:],</span><span class="n">label</span><span class="o">=</span><span class="sa">r</span><span class="s1">&#39;$\epsilon_2$&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">dat_wL4</span><span class="o">.</span><span class="n">TIME</span><span class="p">,</span><span class="n">dat_wL4</span><span class="o">.</span><span class="n">EPSI_FINAL</span><span class="p">,</span><span class="n">c</span><span class="o">=</span><span class="s1">&#39;k&#39;</span><span class="p">,</span><span class="n">marker</span><span class="o">=</span><span class="s1">&#39;x&#39;</span><span class="p">,</span><span class="n">label</span><span class="o">=</span><span class="sa">r</span><span class="s1">&#39;$\epsilon$&#39;</span><span class="p">)</span>

<span class="c1">### EDIT HERE, only dummies used</span>
<span class="c1"># identify two regions of dissipation (strong versus quiescent) </span>
<span class="n">i</span><span class="o">=</span> <span class="mi">1</span>   <span class="c1"># strong dissipation</span>
<span class="n">j</span><span class="o">=</span> <span class="mi">2</span>   <span class="c1"># weak dissipation</span>

<span class="n">ax</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span><span class="o">.</span><span class="n">axvline</span><span class="p">(</span><span class="n">pd</span><span class="o">.</span><span class="n">to_datetime</span><span class="p">(</span><span class="n">dat_wL4</span><span class="o">.</span><span class="n">TIME</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">),</span><span class="n">c</span><span class="o">=</span><span class="s1">&#39;grey&#39;</span><span class="p">,</span><span class="n">lw</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span><span class="o">.</span><span class="n">axvline</span><span class="p">(</span><span class="n">pd</span><span class="o">.</span><span class="n">to_datetime</span><span class="p">(</span><span class="n">dat_wL4</span><span class="o">.</span><span class="n">TIME</span><span class="p">[</span><span class="n">j</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">),</span><span class="n">c</span><span class="o">=</span><span class="s1">&#39;grey&#39;</span><span class="p">,</span><span class="n">lw</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>

<span class="n">ax</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span><span class="o">.</span><span class="n">set_yscale</span><span class="p">(</span><span class="s1">&#39;log&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;$\epsilon \mathrm{[W kg^{-1}]}$&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;time&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Text(0.5, 0, &#39;time&#39;)
</pre></div>
</div>
<img alt="_images/f15a7d73b257ba2494b567726436c5924ab418fc31b45429144e5439c02405bc.png" src="_images/f15a7d73b257ba2494b567726436c5924ab418fc31b45429144e5439c02405bc.png" />
</div>
</div>
</section>
<section id="id9">
<h4>Create model Nasmyth Spectra for chosen dissipation rates in the data<a class="headerlink" href="#id9" title="Link to this heading">#</a></h4>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># print dissipation values for chosen spectra and create model nasmyth shear spectra</span>

<span class="n">knas_strong</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">100</span><span class="p">,</span><span class="nb">len</span><span class="p">(</span><span class="n">dat_wL3</span><span class="o">.</span><span class="n">KCYC</span><span class="p">[:,</span><span class="n">i</span><span class="p">]))</span>
<span class="nb">print</span><span class="p">(</span><span class="n">dat_wL4</span><span class="o">.</span><span class="n">EPSI_FINAL</span><span class="p">[</span><span class="n">i</span><span class="p">])</span>
<span class="n">nasmyth_strong</span> <span class="o">=</span> <span class="n">Nasfunc</span><span class="p">(</span><span class="n">knas_strong</span><span class="p">,</span><span class="n">dat_wL4</span><span class="o">.</span><span class="n">EPSI_FINAL</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="n">dat_wL4</span><span class="o">.</span><span class="n">EPSI_FINAL</span><span class="p">[</span><span class="n">j</span><span class="p">])</span>
<span class="n">knas_weak</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">100</span><span class="p">,</span><span class="nb">len</span><span class="p">(</span><span class="n">dat_wL3</span><span class="o">.</span><span class="n">KCYC</span><span class="p">[:,</span><span class="n">j</span><span class="p">]))</span>
<span class="n">nasmyth_weak</span> <span class="o">=</span> <span class="n">Nasfunc</span><span class="p">(</span><span class="n">knas_weak</span><span class="p">,</span><span class="n">dat_wL4</span><span class="o">.</span><span class="n">EPSI_FINAL</span><span class="p">[</span><span class="n">j</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&lt;xarray.DataArray &#39;EPSI_FINAL&#39; ()&gt; Size: 8B
array(1.532142e-07)
Attributes:
    standard_name:  specific_turbulent_kinetic_energy_dissipation_in_sea_water
    units:          W kg-1
    long_name:      dissipation rate of turbulent kinetic energy per unit mas...
&lt;xarray.DataArray &#39;EPSI_FINAL&#39; ()&gt; Size: 8B
array(2.353111e-07)
Attributes:
    standard_name:  specific_turbulent_kinetic_energy_dissipation_in_sea_water
    units:          W kg-1
    long_name:      dissipation rate of turbulent kinetic energy per unit mas...
</pre></div>
</div>
</div>
</div>
</section>
<section id="id10">
<h4>Dissipation estimates from shear spectra<a class="headerlink" href="#id10" title="Link to this heading">#</a></h4>
<p>Look at the agreement between dissipation estimates from the two spectra. Generally, turbulence can be observed to within a factor of two.</p>
<p>2.3) Look at the dissipation estimates from tho probes. At which dissipation rate might you expect to be less condident about the results?</p>
<p>2.4) Plot shear spectra at the two dissipation rates that you chose earlier. How does shear spectra relate to dissipation rates?</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">fig</span><span class="p">,</span><span class="n">ax</span><span class="o">=</span><span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span><span class="mi">4</span><span class="p">))</span>
<span class="n">fig</span><span class="o">.</span><span class="n">subplots_adjust</span><span class="p">(</span><span class="n">wspace</span><span class="o">=</span><span class="mf">0.3</span><span class="p">)</span>

<span class="c1">## Dissipation plot</span>

<span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">dat_wL4</span><span class="o">.</span><span class="n">EPSI</span><span class="p">[</span><span class="mi">0</span><span class="p">,:],</span><span class="n">dat_wL4</span><span class="o">.</span><span class="n">EPSI</span><span class="p">[</span><span class="mi">1</span><span class="p">,:],</span><span class="n">marker</span><span class="o">=</span><span class="s1">&#39;^&#39;</span><span class="p">,</span><span class="n">s</span><span class="o">=</span><span class="mi">5</span><span class="p">)</span>

<span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_yscale</span><span class="p">(</span><span class="s1">&#39;log&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_xscale</span><span class="p">(</span><span class="s1">&#39;log&#39;</span><span class="p">)</span>

<span class="c1"># Define the range for the 1-to-1 and confidence interval lines</span>
<span class="n">x_vals</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">logspace</span><span class="p">(</span><span class="o">-</span><span class="mi">11</span><span class="p">,</span> 
                     <span class="o">-</span><span class="mi">5</span><span class="p">,</span> <span class="mi">100</span><span class="p">)</span>

<span class="c1"># Plot 1:1 line</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x_vals</span><span class="p">,</span> <span class="n">x_vals</span><span class="p">,</span> <span class="s1">&#39;k&#39;</span><span class="p">)</span>

<span class="c1"># Plot factor of 2 confidence intervals</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x_vals</span><span class="p">,</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">x_vals</span><span class="p">,</span> <span class="s1">&#39;k:&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x_vals</span><span class="p">,</span> <span class="mf">0.5</span><span class="o">*</span> <span class="n">x_vals</span><span class="p">,</span> <span class="s1">&#39;k:&#39;</span><span class="p">)</span>

<span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">(</span><span class="mf">1e-11</span><span class="p">,</span><span class="mf">1e-5</span><span class="p">)</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">(</span><span class="mf">1e-11</span><span class="p">,</span><span class="mf">1e-5</span><span class="p">)</span>

<span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;$\epsilon_1 \mathrm{[W kg^{-1}]}$&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;$\epsilon_2 \mathrm{[W kg^{-1}]}$&#39;</span><span class="p">)</span>


<span class="c1">## Spectra</span>

<span class="n">ax</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">dat_wL3</span><span class="o">.</span><span class="n">KCYC</span><span class="p">[:,</span><span class="n">i</span><span class="p">],</span><span class="n">dat_wL3</span><span class="o">.</span><span class="n">SH_SPEC_CLEAN</span><span class="p">[</span><span class="mi">0</span><span class="p">,:,</span><span class="n">i</span><span class="p">],</span><span class="n">c</span><span class="o">=</span><span class="s1">&#39;tab:blue&#39;</span><span class="p">,</span><span class="n">lw</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="n">label</span><span class="o">=</span><span class="sa">r</span><span class="s1">&#39;$\Psi_</span><span class="si">{1}</span><span class="s1">$&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">dat_wL3</span><span class="o">.</span><span class="n">KCYC</span><span class="p">[:,</span><span class="n">i</span><span class="p">],</span><span class="n">dat_wL3</span><span class="o">.</span><span class="n">SH_SPEC_CLEAN</span><span class="p">[</span><span class="mi">1</span><span class="p">,:,</span><span class="n">i</span><span class="p">],</span><span class="n">c</span><span class="o">=</span><span class="s1">&#39;tab:orange&#39;</span><span class="p">,</span><span class="n">lw</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="n">label</span><span class="o">=</span><span class="sa">r</span><span class="s1">&#39;$\Psi_</span><span class="si">{2}</span><span class="s1">$&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">knas_strong</span><span class="p">,</span><span class="n">nasmyth_strong</span><span class="p">,</span><span class="n">c</span><span class="o">=</span><span class="s1">&#39;grey&#39;</span><span class="p">,</span><span class="n">lw</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="n">label</span><span class="o">=</span><span class="s1">&#39;Nasmyth Spectra&#39;</span><span class="p">)</span>

<span class="n">ax</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">dat_wL3</span><span class="o">.</span><span class="n">KCYC</span><span class="p">[:,</span><span class="n">j</span><span class="p">],</span><span class="n">dat_wL3</span><span class="o">.</span><span class="n">SH_SPEC_CLEAN</span><span class="p">[</span><span class="mi">0</span><span class="p">,:,</span><span class="n">j</span><span class="p">],</span><span class="n">c</span><span class="o">=</span><span class="s1">&#39;tab:blue&#39;</span><span class="p">,</span><span class="n">lw</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">dat_wL3</span><span class="o">.</span><span class="n">KCYC</span><span class="p">[:,</span><span class="n">j</span><span class="p">],</span><span class="n">dat_wL3</span><span class="o">.</span><span class="n">SH_SPEC_CLEAN</span><span class="p">[</span><span class="mi">1</span><span class="p">,:,</span><span class="n">j</span><span class="p">],</span><span class="n">c</span><span class="o">=</span><span class="s1">&#39;tab:orange&#39;</span><span class="p">,</span><span class="n">lw</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">knas_weak</span><span class="p">,</span><span class="n">nasmyth_weak</span><span class="p">,</span><span class="n">c</span><span class="o">=</span><span class="s1">&#39;grey&#39;</span><span class="p">,</span><span class="n">lw</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>

<span class="n">ax</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_yscale</span><span class="p">(</span><span class="s1">&#39;log&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_xscale</span><span class="p">(</span><span class="s1">&#39;log&#39;</span><span class="p">)</span>

<span class="n">ax</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">(</span><span class="mf">0.5</span><span class="p">,</span><span class="mf">1e2</span><span class="p">)</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">(</span><span class="mf">1e-10</span><span class="p">,</span><span class="mf">1e-1</span><span class="p">)</span>

<span class="n">ax</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>

<span class="n">ax</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;$k$ [cpm]&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;$\Psi$ $[s^{-2}\mathrm</span><span class="si">{cpm}</span><span class="s1">^{-1}]$&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Text(0, 0.5, &#39;$\\Psi$ $[s^{-2}\\mathrm{cpm}^{-1}]$&#39;)
</pre></div>
</div>
<img alt="_images/0e274b101579c629bde750194fb3d19b362f53ab7d1031dc1b1d3e4d66bcb414.png" src="_images/0e274b101579c629bde750194fb3d19b362f53ab7d1031dc1b1d3e4d66bcb414.png" />
</div>
</div>
</section>
<section id="compute-the-vertical-turbulent-heat-flux">
<h4>Compute the vertical turbulent heat flux<a class="headerlink" href="#compute-the-vertical-turbulent-heat-flux" title="Link to this heading">#</a></h4>
<p>Using the Eddy Diffusivity, <span class="math notranslate nohighlight">\(Kz\)</span> and following Osborn (1960), calculate the vertical turbulent heat flux.</p>
<p>Assuming the Osborn model for <span class="math notranslate nohighlight">\(Kz\)</span>:</p>
<div class="math notranslate nohighlight">
\[
\mathrm{Kz}=0.2\frac{\epsilon}{N^2}
\]</div>
<p>Note that because the Osborn model for eddy diffusivity is calculated as a function of <span class="math notranslate nohighlight">\(N^2\)</span>, it will not be valid in conditions of very small <span class="math notranslate nohighlight">\(N^2\)</span>. Where might this occur?</p>
<p>Heat flux can be approximated as:</p>
<div class="math notranslate nohighlight">
\[
H_f=\rho_0 c_p \mathrm{Kz} \frac{dT}{dz}
\]</div>
<p>2.5) What is the range of Eddy diffusivity? Is this comparable to expected values in the ocean?</p>
<p>2.6) Where is heat flux the strongest? What are possible explanations for the distribution of heat flux in this profile?</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">#interporate salinity to dissipation spectra</span>
<span class="n">ds_interp</span> <span class="o">=</span> <span class="n">dat_wL1</span><span class="o">.</span><span class="n">SALT</span><span class="o">.</span><span class="n">interp</span><span class="p">(</span>
    <span class="n">TIME_SLOW</span><span class="o">=</span><span class="n">dat_wL4</span><span class="o">.</span><span class="n">TIME</span>
<span class="p">)</span>

<span class="n">SA</span><span class="o">=</span><span class="n">ds_interp</span>

<span class="c1"># calculate density and stratification</span>
<span class="n">rho</span><span class="o">=</span><span class="n">gsw</span><span class="o">.</span><span class="n">rho</span><span class="p">(</span><span class="n">SA</span><span class="p">,</span><span class="n">dat_wL4</span><span class="o">.</span><span class="n">TEMP</span><span class="p">,</span><span class="n">dat_wL4</span><span class="o">.</span><span class="n">PRES</span><span class="p">)</span>

<span class="n">rho_sorted</span> <span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">sort</span><span class="p">(</span><span class="n">rho</span><span class="p">)</span> 

<span class="c1"># Compute brunt-vaisala frequency </span>
<span class="n">g</span><span class="o">=</span><span class="mf">9.8</span>
<span class="n">p0</span><span class="o">=</span><span class="mi">1025</span>
<span class="c1"># n2 = g/p0*(np.diff(rho_sorted)/np.diff(low_res_ctd.z))</span>
<span class="n">drho_dz</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">gradient</span><span class="p">(</span><span class="n">rho_sorted</span><span class="p">,</span> <span class="n">dat_wL4</span><span class="o">.</span><span class="n">PRES</span><span class="p">)</span>
<span class="n">n2</span> <span class="o">=</span> <span class="n">g</span><span class="o">/</span><span class="n">p0</span><span class="o">*</span><span class="n">drho_dz</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Eddy diffusivity, k=0.2 epsilon/N2 </span>
<span class="c1"># Osborn Model </span>

<span class="n">Kz</span><span class="o">=</span> <span class="mf">0.2</span><span class="o">*</span><span class="n">dat_wL4</span><span class="o">.</span><span class="n">EPSI_FINAL</span><span class="o">/</span><span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">n2</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">fig</span><span class="p">,</span><span class="n">ax</span><span class="o">=</span><span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">5</span><span class="p">,</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">15</span><span class="p">,</span><span class="mi">5</span><span class="p">),</span><span class="n">sharey</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

<span class="n">rho0</span><span class="o">=</span><span class="mi">1000</span>
<span class="n">cp</span><span class="o">=</span><span class="mi">4000</span>

<span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">dat_wL4</span><span class="o">.</span><span class="n">EPSI_FINAL</span><span class="p">,</span><span class="n">dat_wL4</span><span class="o">.</span><span class="n">PRES</span><span class="p">)</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_xscale</span><span class="p">(</span><span class="s1">&#39;log&#39;</span><span class="p">)</span>

<span class="n">ax</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">Kz</span><span class="p">,</span><span class="n">dat_wL4</span><span class="o">.</span><span class="n">PRES</span><span class="p">)</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_xscale</span><span class="p">(</span><span class="s1">&#39;log&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">dat_wL4</span><span class="o">.</span><span class="n">TEMP</span><span class="p">,</span><span class="n">dat_wL4</span><span class="o">.</span><span class="n">PRES</span><span class="p">)</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">((</span><span class="n">np</span><span class="o">.</span><span class="n">gradient</span><span class="p">(</span><span class="n">dat_wL4</span><span class="o">.</span><span class="n">TEMP</span><span class="p">)</span><span class="o">/</span><span class="n">np</span><span class="o">.</span><span class="n">gradient</span><span class="p">(</span><span class="n">dat_wL4</span><span class="o">.</span><span class="n">PRES</span><span class="p">)),</span><span class="n">dat_wL4</span><span class="o">.</span><span class="n">PRES</span><span class="p">)</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">4</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">rho0</span><span class="o">*</span><span class="n">cp</span><span class="o">*</span><span class="n">Kz</span><span class="o">*</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">gradient</span><span class="p">(</span><span class="n">dat_wL4</span><span class="o">.</span><span class="n">TEMP</span><span class="p">)</span><span class="o">/</span><span class="n">np</span><span class="o">.</span><span class="n">gradient</span><span class="p">(</span><span class="n">dat_wL4</span><span class="o">.</span><span class="n">PRES</span><span class="p">)),</span><span class="n">dat_wL4</span><span class="o">.</span><span class="n">PRES</span><span class="p">)</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">4</span><span class="p">]</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">(</span><span class="o">-</span><span class="mi">5</span><span class="p">,</span><span class="mi">5</span><span class="p">)</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">(</span><span class="mi">180</span><span class="p">,</span><span class="mi">0</span><span class="p">)</span>

<span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;Depth  (m)&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;$\epsilon \ (m^3s^{-2})$&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;$K_z \ (m^2s^{-1})$&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;Temperature  (°C)&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;$\frac</span><span class="si">{dT}{dz}</span><span class="s1">$  (°C m$^{-1}$)&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">4</span><span class="p">]</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;F$_h$  (W$m^{-2})$&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&lt;&gt;:18: SyntaxWarning: invalid escape sequence &#39;\e&#39;
&lt;&gt;:19: SyntaxWarning: invalid escape sequence &#39;\ &#39;
&lt;&gt;:18: SyntaxWarning: invalid escape sequence &#39;\e&#39;
&lt;&gt;:19: SyntaxWarning: invalid escape sequence &#39;\ &#39;
/var/folders/1q/qmm9yg_90xl7f60v6q7wn2fr0000gn/T/ipykernel_30563/2509822319.py:18: SyntaxWarning: invalid escape sequence &#39;\e&#39;
  ax[0].set_xlabel(&#39;$\epsilon \ (m^3s^{-2})$&#39;)
/var/folders/1q/qmm9yg_90xl7f60v6q7wn2fr0000gn/T/ipykernel_30563/2509822319.py:19: SyntaxWarning: invalid escape sequence &#39;\ &#39;
  ax[1].set_xlabel(&#39;$K_z \ (m^2s^{-1})$&#39;)
</pre></div>
</div>
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Text(0.5, 0, &#39;F$_h$  (W$m^{-2})$&#39;)
</pre></div>
</div>
<img alt="_images/c3dba59b641a5413b528315668cdc25c1b70078229147d08826a705da0deef44.png" src="_images/c3dba59b641a5413b528315668cdc25c1b70078229147d08826a705da0deef44.png" />
</div>
</div>
</section>
<section id="compare-the-law-of-the-wall-model-for-turbulent-dissipation-in-a-boundary-layer-with-the-observations">
<h4>Compare the law-of-the-wall model for turbulent dissipation in a boundary layer with the observations<a class="headerlink" href="#compare-the-law-of-the-wall-model-for-turbulent-dissipation-in-a-boundary-layer-with-the-observations" title="Link to this heading">#</a></h4>
<p>Law of the wall:</p>
<div class="math notranslate nohighlight">
\[
\epsilon = \frac{u_*^3}{\kappa z}
\]</div>
<p>2.7) What are the main assumptions of law-of-the-wall?</p>
<p>2.8) Up to what depth does law-of-the-wall agree with observations?</p>
<p>2.9) Given <span class="math notranslate nohighlight">\(B_0 = 1 \times 10^{-8} \ m^3 s^{-2}\)</span>, compute the Monin-Obukhov length scale and make a statement about the forcing conditions experienced while this profile was taken.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># model profile</span>
<span class="n">z</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">80</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span>
<span class="n">k</span><span class="o">=</span><span class="mf">0.4</span>
<span class="n">ustar</span><span class="o">=</span><span class="mf">0.01</span>
<span class="n">eps_low</span><span class="o">=</span><span class="n">ustar</span><span class="o">**</span><span class="mi">3</span><span class="o">/</span><span class="p">(</span><span class="n">k</span><span class="o">*</span><span class="n">z</span><span class="p">)</span>
<span class="n">eps_low_2x</span><span class="o">=</span><span class="n">eps_low</span><span class="o">*</span><span class="mi">2</span>
<span class="n">eps_low_2s</span><span class="o">=</span><span class="n">eps_low</span><span class="o">*</span><span class="mf">0.5</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>/var/folders/1q/qmm9yg_90xl7f60v6q7wn2fr0000gn/T/ipykernel_30563/2175224984.py:5: RuntimeWarning: divide by zero encountered in divide
  eps_low=ustar**3/(k*z)
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">()</span>

<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">eps_low</span><span class="p">,</span><span class="n">z</span><span class="p">,</span><span class="n">c</span><span class="o">=</span><span class="s1">&#39;k&#39;</span><span class="p">,</span><span class="n">label</span><span class="o">=</span><span class="s1">&#39;law-of-the-wall&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">eps_low_2x</span><span class="p">,</span><span class="n">z</span><span class="p">,</span><span class="n">c</span><span class="o">=</span><span class="s1">&#39;grey&#39;</span><span class="p">,</span><span class="n">ls</span><span class="o">=</span><span class="s1">&#39;--&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">eps_low_2s</span><span class="p">,</span><span class="n">z</span><span class="p">,</span><span class="n">c</span><span class="o">=</span><span class="s1">&#39;grey&#39;</span><span class="p">,</span><span class="n">ls</span><span class="o">=</span><span class="s1">&#39;--&#39;</span><span class="p">)</span>


<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">dat_wL4</span><span class="o">.</span><span class="n">EPSI_FINAL</span><span class="p">,</span><span class="n">dat_wL4</span><span class="o">.</span><span class="n">PRES</span><span class="p">,</span><span class="n">label</span><span class="o">=</span><span class="s1">&#39;obs&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xscale</span><span class="p">(</span><span class="s1">&#39;log&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylim</span><span class="p">(</span><span class="mi">80</span><span class="p">,</span><span class="mi">0</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;z [m]&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;$\epsilon$ [W kg$^{-1}$]&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&lt;&gt;:12: SyntaxWarning: invalid escape sequence &#39;\e&#39;
&lt;&gt;:12: SyntaxWarning: invalid escape sequence &#39;\e&#39;
/var/folders/1q/qmm9yg_90xl7f60v6q7wn2fr0000gn/T/ipykernel_30563/2234889368.py:12: SyntaxWarning: invalid escape sequence &#39;\e&#39;
  plt.xlabel(&#39;$\epsilon$ [W kg$^{-1}$]&#39;)
</pre></div>
</div>
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&lt;matplotlib.legend.Legend at 0x30c8182d0&gt;
</pre></div>
</div>
<img alt="_images/9cf500bb78de9d1e40e3363e0914cd277a79e7fa2facb5945a753205406bc1f7.png" src="_images/9cf500bb78de9d1e40e3363e0914cd277a79e7fa2facb5945a753205406bc1f7.png" />
</div>
</div>
</section>
</section>
</section>
</section>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            name: "python3",
            path: "./."
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

                </article>
              

              
              
              
              
                <footer class="prev-next-footer d-print-none">
                  
<div class="prev-next-area">
    <a class="left-prev"
       href="role_of_turbulence.html"
       title="previous page">
      <i class="fa-solid fa-angle-left"></i>
      <div class="prev-next-info">
        <p class="prev-next-subtitle">previous</p>
        <p class="prev-next-title">The importance of turbulence in the ocean</p>
      </div>
    </a>
    <a class="right-next"
       href="references.html"
       title="next page">
      <div class="prev-next-info">
        <p class="prev-next-subtitle">next</p>
        <p class="prev-next-title">References</p>
      </div>
      <i class="fa-solid fa-angle-right"></i>
    </a>
</div>
                </footer>
              
            </div>
            
            
              
                <div class="bd-sidebar-secondary bd-toc"><div class="sidebar-secondary-items sidebar-secondary__inner">


  <div class="sidebar-secondary-item">
  <div class="page-toc tocsection onthispage">
    <i class="fa-solid fa-list"></i> Contents
  </div>
  <nav class="bd-toc-nav page-toc">
    <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#part-i">Part I</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#baltic-sea-a-quiescent-region">Baltic Sea - A quiescent region</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#plot-vertical-profile-of-temperature">Plot vertical profile of temperature</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#plot-time-series">Plot time series</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#create-model-nasmyth-spectra-for-chosen-dissipation-rates-in-the-data">Create model Nasmyth Spectra for chosen dissipation rates in the data</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#dissipation-estimates-from-shear-spectra">Dissipation estimates from shear spectra</a></li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#haro-straight-a-tidal-channel">Haro Straight - A tidal channel.</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#plot-vertical-profile-of-temperature-salinity-and-density">Plot vertical profile of temperature, salinity and density</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#id4">Plot time series</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#id5">Create model Nasmyth Spectra for chosen dissipation rates in the data</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#id6">Dissipation estimates from shear spectra</a></li>
</ul>
</li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#part-ii">Part II</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#weddell-sea">Weddell Sea</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#plot-vertical-profile-of-temperature-salinity-density-and-vertical-stratification">Plot vertical profile of temperature, salinity, density and vertical stratification</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#id8">Plot time series</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#id9">Create model Nasmyth Spectra for chosen dissipation rates in the data</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#id10">Dissipation estimates from shear spectra</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#compute-the-vertical-turbulent-heat-flux">Compute the vertical turbulent heat flux</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#compare-the-law-of-the-wall-model-for-turbulent-dissipation-in-a-boundary-layer-with-the-observations">Compare the law-of-the-wall model for turbulent dissipation in a boundary layer with the observations</a></li>
</ul>
</li>
</ul>
</li>
</ul>
  </nav></div>

</div></div>
              
            
          </div>
          <footer class="bd-footer-content">
            
<div class="bd-footer-content__inner container">
  
  <div class="footer-item">
    
<p class="component-author">
By Isabelle Giddy
</p>

  </div>
  
  <div class="footer-item">
    

  <p class="copyright">
    
      © Copyright 2025.
      <br/>
    
  </p>

  </div>
  
  <div class="footer-item">
    
  </div>
  
  <div class="footer-item">
    
  </div>
  
</div>
          </footer>
        

      </main>
    </div>
  </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="_static/scripts/bootstrap.js?digest=dfe6caa3a7d634c4db9b"></script>
<script src="_static/scripts/pydata-sphinx-theme.js?digest=dfe6caa3a7d634c4db9b"></script>

  <footer class="bd-footer">
  </footer>
  </body>
</html>