{"version":1,"kind":"Notebook","sha256":"593126b65b798bd551137df0405fd34bc2879ec0f8e602aef38ecfd27e667f74","slug":"obs-of-shear","location":"/obs_of_shear.ipynb","dependencies":[],"frontmatter":{"title":"Assignment: The observation and interpretation of turbulence dissipation","content_includes_title":false,"kernelspec":{"name":"python3","display_name":"teach","language":"python"},"authors":[{"nameParsed":{"literal":"Isabelle Giddy","given":"Isabelle","family":"Giddy"},"name":"Isabelle Giddy","id":"contributors-myst-generated-uid-0"}],"github":"https://github.com/executablebooks/jupyter-book","copyright":"2025","edit_url":"https://github.com/executablebooks/jupyter-book/blob/main/obs_of_shear.ipynb","thumbnail":"/microstructure_probe-5c1e4415ec42c300813b6305b231e22b.png","thumbnailOptimized":"/microstructure_probe-5c1e4415ec42c300813b6305b231e22b.webp","exports":[{"format":"ipynb","filename":"obs_of_shear.ipynb","url":"/obs_of_shear-ef30f1301812e3320952f6fe43a393ec.ipynb"}]},"widgets":{},"mdast":{"type":"root","children":[{"type":"block","kind":"notebook-content","data":{},"children":[{"type":"paragraph","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"text","value":"Turbulent flow is ubiquitous, but not homogeneously distributed.","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"Yod6YFvkhK"}],"key":"WvMNcwNMrq"},{"type":"paragraph","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"children":[{"type":"text","value":"One method for observing turbulence is the observation of microstructure shear, from which the rate of turbulence dissipation can be directly computed. Such observations are crucial for understanding the contributions of various sources of turbulence production in the ocean, the turbulence flux of properties and the processes by which TKE is dissipated.","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"O4NPNqlr7j"}],"key":"TxjRzxetpM"},{"type":"paragraph","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"children":[{"type":"text","value":"In this assignment, you will become familiar with the analysis of profiles of the dissipation rate of TKE under a range of forcing conditions.","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"key":"bHyqqJPC49"}],"key":"lP4EThBv2f"},{"type":"paragraph","position":{"start":{"line":9,"column":1},"end":{"line":9,"column":1}},"children":[{"type":"text","value":"Best practices for the processing of microstructure shear data are described in ","position":{"start":{"line":9,"column":1},"end":{"line":9,"column":1}},"key":"GmlEiuAtiz"},{"type":"cite","kind":"narrative","label":"lueck_best_2024","identifier":"lueck_best_2024","children":[{"type":"text","value":"Lueck ","key":"q7uENIE5Xt"},{"type":"emphasis","children":[{"type":"text","value":"et al.","key":"VTB78p8uJU"}],"key":"lEh90vNwku"},{"type":"text","value":" (2024)","key":"irFUKi3FOv"}],"enumerator":"1","key":"YmH6VABAlj"}],"key":"RIUTiAdPb1"}],"key":"LDtLGjr4RF"},{"type":"block","kind":"notebook-code","data":{},"children":[{"type":"code","lang":"python","executable":true,"value":"import numpy as np \nimport matplotlib.pyplot as plt \nimport xarray as xr\nimport pandas as pd\nimport gsw","key":"ijJPZvBshS"},{"type":"output","id":"94hJwUQbjP8ryfs3klQpe","data":[],"key":"BNDbLfGnsD"}],"key":"duXCBe0fW6"},{"type":"block","kind":"notebook-code","data":{},"children":[{"type":"code","lang":"python","executable":true,"value":"# A function we will use later\n\ndef Nasfunc(x,eps,vis=1.6e-6):\n    \"\"\" out=Nasfunc(x,eps,vis)\n     x is the wavenumber, eps is the dissipation\n     returns the Nasmyth's dissipation spectrum.\n     The function form is given in Lueck et\n     J. Oceanogr. 2002.\n     default vis=1.6e-6 #m2/s kinematic viscocity\n     See also Nasfunc_log\"\"\"\n\n    ks = (eps*(vis**-3))**(1/4)\n    x1= x/ks\n\n    #fit provided by Fabian Wolk -see Lueck et al paper in J. Oceanogr. 2002\n    G=(8.05*(x1**(1/3))) / (1+ ((20*x1)**3.7))\n    return ((ks**2)*((eps*(vis**5))**(1/4)))*G   #in s-2/cpm","key":"xNPy5VwJDy"},{"type":"output","id":"PPRqxxnJp4chvOT8-4T_q","data":[],"key":"PdfpWvwOj0"}],"key":"FnQ3uqAh6a"},{"type":"block","kind":"notebook-content","data":{},"children":[{"type":"heading","depth":2,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Part I","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"pt3EiM0z2Y"}],"identifier":"part-i","label":"Part I","html_id":"part-i","implicit":true,"key":"qDuLcmbUt2"},{"type":"paragraph","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"text","value":"Become familiar with the observation of microstructure shear","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"WalGYyx0bX"}],"key":"VOY9tZlvkh"}],"key":"dguo3FvpZV"},{"type":"block","kind":"notebook-content","data":{},"children":[{"type":"heading","depth":3,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Baltic Sea - A quiescent region","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"U8hL7CLmY4"}],"identifier":"baltic-sea-a-quiescent-region","label":"Baltic Sea - A quiescent region","html_id":"baltic-sea-a-quiescent-region","implicit":true,"key":"kPviIaq1zg"},{"type":"container","kind":"figure","children":[{"type":"image","url":"/microstructure_probe-5c1e4415ec42c300813b6305b231e22b.png","alt":"A Sea and Sun Technology Microstructure Probe.","width":"15%","align":"center","data":{"altTextIsAutoGenerated":true},"key":"Tzynm0mbhN","urlSource":"images/microstructure_probe_mss.png","urlOptimized":"/microstructure_probe-5c1e4415ec42c300813b6305b231e22b.webp"},{"type":"caption","children":[{"type":"paragraph","position":{"start":{"line":8,"column":1},"end":{"line":8,"column":1}},"children":[{"type":"captionNumber","kind":"figure","label":"fig-mss","identifier":"fig-mss","html_id":"fig-mss","enumerator":"1","children":[{"type":"text","value":"Figure ","key":"nrOA9bJyyv"},{"type":"text","value":"1","key":"modZHgjpCO"},{"type":"text","value":":","key":"uiGq4TcBnP"}],"template":"Figure %s:","key":"b6wi0kJXVG"},{"type":"text","value":"A Sea and Sun Technology Microstructure Probe.","position":{"start":{"line":8,"column":1},"end":{"line":8,"column":1}},"key":"gSibS57inz"}],"key":"HzDPRyEtkg"}],"key":"bSph9SDSu6"}],"label":"fig-mss","identifier":"fig-mss","enumerator":"1","html_id":"fig-mss","key":"NcYckAPxYq"},{"type":"paragraph","position":{"start":{"line":11,"column":1},"end":{"line":11,"column":1}},"children":[{"type":"text","value":"This dataset can be downloaded here:","position":{"start":{"line":11,"column":1},"end":{"line":11,"column":1}},"key":"ZUGHU056ki"}],"key":"Dlu9gi1i3t"},{"type":"paragraph","position":{"start":{"line":13,"column":1},"end":{"line":13,"column":1}},"children":[{"type":"text","value":"Holtermann, P. ATOMIX shear probes benchmark data: Example microstructure data from a Sea & Sun Technology MSS microstructure profiler, Bornholm Basin, Baltic Sea. NERC EDS British Oceanographic Data Centre NOC., ","position":{"start":{"line":13,"column":1},"end":{"line":13,"column":1}},"key":"Td55MsmUb4"},{"type":"cite","url":"https://doi.org/10.5285/0e35f96f-57e3-540b-e063-6c86abc06660","position":{"start":{"line":13,"column":1},"end":{"line":13,"column":1}},"children":[{"type":"text","value":"Holtermann, Peter (2024)","key":"ItJX7yPvUb"}],"kind":"narrative","label":"https://doi.org/10.5285/0e35f96f-57e3-540b-e063-6c86abc06660","identifier":"https://doi.org/10.5285/0e35f96f-57e3-540b-e063-6c86abc06660","enumerator":"2","key":"JhyZelCKd4"},{"type":"text","value":" (2024).","position":{"start":{"line":13,"column":1},"end":{"line":13,"column":1}},"key":"xYUAYLosTC"}],"key":"VwxFWZIGik"},{"type":"paragraph","position":{"start":{"line":15,"column":1},"end":{"line":15,"column":1}},"children":[{"type":"text","value":"The Baltic Sea profile was taken in September 2008 in the Bornholm Basin from the Research Vessel Poseidon. The oceanographic context and a detailed analysis of the data collected during this cruise are given in van der Lee and Umlauf (2011). The total depth was about 85 m. The instrument used was a MSS-Microstructure profiler with the serial number 38, produced by Sea & Sun Technology, Germany. It was equipped with two randomly oriented shear probes, one FP07 thermistor, and one PT100 temperature sensor and a conductivity cell for precision temperature and salinity measurements. The probe was also fitted with a vibration sensor, which is similar in design to a shear probe sensor, except that the airfoil is replaced by a small mass and is mounted inside the probe. The probe was connected with a cable to a ship-board data acquisition system and was operated with an electrical winch from the stern of the ship. During the profiling, the ship slowly moved along a transect with a speed of approximately 0.5 m s−1. The transect was oriented such that wind and surface currents came from the bow, such that the loosely tethered cable was always at a safe distance to the ship’s propeller. Using a sensor protection cage, it was possible to obtain nearly full-depth vertical profiles to within 0.1 m above the seafloor, with a descent speed of approximately 0.5 m s−1 .","position":{"start":{"line":15,"column":1},"end":{"line":15,"column":1}},"key":"lQMnVoJSFl"}],"key":"n9lKWxrh8y"},{"type":"paragraph","position":{"start":{"line":17,"column":1},"end":{"line":17,"column":1}},"children":[{"type":"strong","position":{"start":{"line":17,"column":1},"end":{"line":17,"column":1}},"children":[{"type":"text","value":"First we will take a look at a few metrics to get familiar with dissipation data","position":{"start":{"line":17,"column":1},"end":{"line":17,"column":1}},"key":"Z0hXY3hFlh"}],"key":"KXfxdlJlOd"}],"key":"DkdqTskxCO"}],"key":"JCGZDkYKGK"},{"type":"block","kind":"notebook-code","data":{},"children":[{"type":"code","lang":"python","executable":true,"value":"# The data is stored as a grouped NetCDF file.\n# First look at the global attributes.\ndat_b=xr.open_dataset('assignment/baltic/MSS_Baltic.nc', engine=\"h5netcdf\",group=\"\")\ndat_b.attrs","key":"hfowgLgMG7"},{"type":"output","id":"9d4sl-f3qywMm6CpSKPbM","data":[{"output_type":"execute_result","execution_count":30,"metadata":{},"data":{"text/plain":{"content":"{'title': 'Example microstructure data from a Sea & Sun Technology MSS microstructure profiler',\n 'summary': 'Vertical microstructure profile',\n 'comment': 'The profile was collected on 20-Sep-2008 during the cruise POS373 onboard R.V. Poseidon, using the tethered free-fall MSS90-L profiler (Sea & Sun Technology, Germany, SN038). The dissipation rate was measured using two airfoil shear probes. In addition a fast-response FP07 thermistor, pressure, temperature, conductivity, vibration and oxygen sensors were mounted. All sensor were sampled with 1024 Hz. The processing of the data and the format of this data set follows the recommendations and guidelines of the SCOR Working Group #160, ATOMIX (https://wiki.uib.no/atomix). The netCDF file includes four hierarchical groups, corresponding to the four levels of microstructure data in the ATOMIX format. L1_converted : time series from all sensors converted into physical units L2_cleaned : selected signals that are filtered and/or despiked before spectral analysis. Time stamp and length of the signals are the same as in L1. L3_spectra : wavenumber spectra from shear probes and vibration sensors L4_dissipation: dissipation estimates together with quality control parameters L2_cleaned time series used for spectral analysis are marked with section numbers.',\n 'platform_type': 'research vessel',\n 'creation_time': '2024-01-17T15:18:42Z',\n 'date_update': '2024-01-17T15:18:42Z',\n 'date_created': '2024-01-17',\n 'time_reference_year': np.float64(2008.0),\n 'fs_fast': np.float64(1024.0),\n 'fs_ctd': np.float64(1024.0),\n 'profiling_direction': 'vertical',\n 'HP_cut': np.float64(0.15),\n 'despike_shear_fraction_limit': np.float64(0.05),\n 'FOM_limit': np.float64(1.15),\n 'despike_iterations_limit': np.float64(8.0),\n 'diss_ratio_limit': np.float64(2.77),\n 'variance_resolved_limit': np.float64(0.5),\n 'fft_length': np.float64(2048.0),\n 'diss_length': np.float64(5120.0),\n 'overlap': np.float64(2560.0),\n 'goodman': np.float64(1.0),\n 'geospatial_lat_min': np.float64(55.235416666666666),\n 'geospatial_lat_max': np.float64(55.235416666666666),\n 'geospatial_lon_min': np.float64(15.978098333333334),\n 'geospatial_lon_max': np.float64(15.978098333333334),\n 'geospatial_vertical_min': np.float64(0.0),\n 'geospatial_vertical_max': np.float64(88.0),\n 'geospatial_vertical_positive': 'down',\n 'time_coverage_start': '2008-09-20T10:50:04Z',\n 'time_coverage_end': '2008-09-20T10:52:49Z',\n 'conventions': 'CF-1.6, ACDD-1.3, ATOMIX',\n 'history': 'v2.2',\n 'data_mode': 'D',\n 'area': 'western Baltic Sea',\n 'principal_investigator': 'Lars Umlauf',\n 'institution': 'Leibniz Institute for Baltic Sea Research, Warnemuende',\n 'references': 'E. M. van der Lee and L. Umlauf, Internal wave mixing in the Baltic Sea: Near-inertial waves in the absence of tides, Journal of Geophysical Research: Oceans, vol. 116, no. C10, Oct. 2011, doi: 10.1029/2011JC007072.',\n 'authors': 'E. M. van der Lee and L. Umlauf',\n 'contact': 'lars.umlauf@io-warnemuende.de',\n 'project_name': 'SHIC',\n 'cruise': 'POS373',\n 'vessel': 'RV Poseidon',\n 'creator_name': 'Peter Holtermann',\n 'creator_email': 'peter.holtermann@io-warnemuende.de',\n 'license': 'http://creativecommons.org/licenses/by/4.0/',\n 'citation': 'Holtermann, Peter (2024). ATOMIX shear probes benchmark data: Example microstructure data from a Sea & Sun Technology MSS microstructure profiler, Bornholm Basin, Baltic Sea. British Oceanographic Data Centre. DOI: 10.5285/0e35f96f-57e3-540b-e063-6c86abc06660',\n 'DOI': '10.5285/0e35f96f-57e3-540b-e063-6c86abc06660'}","content_type":"text/plain"}}}],"key":"prFPRSiX3f"}],"key":"QgaG1Re5U8"},{"type":"block","kind":"notebook-code","data":{},"children":[{"type":"code","lang":"python","executable":true,"value":"# open each group separately\n\ndat_bL1=xr.open_dataset('assignment/baltic/MSS_Baltic.nc', engine=\"h5netcdf\",group=\"L1_converted\")\ndat_bL2=xr.open_dataset('assignment/baltic/MSS_Baltic.nc', engine=\"h5netcdf\",group=\"L2_cleaned\")\ndat_bL3=xr.open_dataset('assignment/baltic/MSS_Baltic.nc', engine=\"h5netcdf\",group=\"L3_spectra\")\ndat_bL4=xr.open_dataset('assignment/baltic/MSS_Baltic.nc', engine=\"h5netcdf\",group=\"L4_dissipation\")","key":"rE4vacfA0Y"},{"type":"output","id":"7ldibLWGdv-CackZdUjpY","data":[],"key":"ahTPgasSXG"}],"key":"gYqLHsor5Y"},{"type":"block","kind":"notebook-content","data":{},"children":[{"type":"heading","depth":4,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Plot vertical profile of temperature","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"SWt4alUWfV"}],"identifier":"plot-vertical-profile-of-temperature","label":"Plot vertical profile of temperature","html_id":"plot-vertical-profile-of-temperature","implicit":true,"key":"Ctw257nUTI"},{"type":"paragraph","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"text","value":"1.1 Describe what you can about the hydrographic structure from this plot. Can refer to ","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"Wn8JV149fq"},{"type":"cite","kind":"narrative","label":"lee_umlauf_2011","identifier":"lee_umlauf_2011","children":[{"type":"text","value":"Lee & Umlauf (2011)","key":"PGWkiL9DnJ"}],"enumerator":"3","key":"ZCpelkRH1T"},{"type":"text","value":" for context.","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"Oiq5I4GyeT"}],"key":"z5iqoaDOry"}],"key":"bXyytDAVmp"},{"type":"block","kind":"notebook-code","data":{},"children":[{"type":"code","lang":"python","executable":true,"value":"plt.figure(figsize=(4,5))\nplt.plot(dat_bL1.TEMP_CTD,dat_bL1.PRES)\nplt.ylim(90,0)\nplt.ylabel('Pressure [db]')\nplt.xlabel('Temperature [°C]')","key":"e9FglL3i5p"},{"type":"output","id":"gDenvsOvE-gLWvu3E42oZ","data":[{"output_type":"display_data","metadata":{},"data":{"image/png":{"content_type":"image/png","hash":"43a27ee87ac90710a22a71b3e299e11f","path":"/43a27ee87ac90710a22a71b3e299e11f.png"},"text/plain":{"content":"<Figure size 400x500 with 1 Axes>","content_type":"text/plain"}}}],"key":"Sm6UBSRYj9"}],"key":"x71wIhk7FK"},{"type":"block","kind":"notebook-content","data":{},"children":[{"type":"heading","depth":4,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Plot time series","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"ffeiqPo1Kl"}],"identifier":"plot-time-series","label":"Plot time series","html_id":"plot-time-series","implicit":true,"key":"pd36MgELBc"},{"type":"paragraph","position":{"start":{"line":2,"column":1},"end":{"line":2,"column":1}},"children":[{"type":"text","value":"Below are time series of a) Pressure and Velocity through water, b) vertical shear, c) platform vibrations and d) turbulence dissipation rate.","position":{"start":{"line":2,"column":1},"end":{"line":2,"column":1}},"key":"lrAewxxLGu"}],"key":"UjmjL9n9rH"},{"type":"paragraph","position":{"start":{"line":4,"column":1},"end":{"line":6,"column":1}},"children":[{"type":"text","value":"1.2) Interpret what might be causing enhanced vibrations in c.","position":{"start":{"line":4,"column":1},"end":{"line":4,"column":1}},"key":"QmRN6KJgx0"},{"type":"break","position":{"start":{"line":4,"column":1},"end":{"line":4,"column":1}},"key":"Cqu0PdUcz1"},{"type":"text","value":"1.3a) Describe the vertical profile of the dissipation rate of turbulence (where dissipation rate is high, where it is low) with reference to the distance from the surface and the temperature profile.","position":{"start":{"line":4,"column":1},"end":{"line":4,"column":1}},"key":"Ai45i0nSwH"},{"type":"break","position":{"start":{"line":4,"column":1},"end":{"line":4,"column":1}},"key":"b1B3bge24Q"},{"type":"text","value":"1.3b) Select two points, one with high dissipation rate and one with low dissipation rate and overlay vertical lines at these chosen points in subpanels d).","position":{"start":{"line":4,"column":1},"end":{"line":4,"column":1}},"key":"XlUAt94Ae3"}],"key":"w5tvZ4EDfU"}],"key":"J2ScDoOX5D"},{"type":"block","kind":"notebook-code","data":{},"children":[{"type":"code","lang":"python","executable":true,"value":"fig,ax=plt.subplots(4,1,figsize=(10,8),sharex=True)\n\nax[0].plot(dat_bL1.TIME,dat_bL1.PRES,lw=2)\nax[0].set_ylabel('Pressure [db]')\n\naxa=ax[0].twinx()\naxa.plot(dat_bL1.TIME,dat_bL1.PSPD_REL,c='tab:orange',lw=2)\naxa.set_ylabel('W [ms$^{-1}$]',c='tab:orange')\n\n\nax[1].plot(dat_bL2.TIME,dat_bL2.SHEAR[0,:])\nax[1].plot(dat_bL2.TIME,dat_bL2.SHEAR[1,:])\n\nax[1].set_ylabel(r'$\\partial u / \\partial z$ [s$^{-1}$]')\n\nax[2].plot(dat_bL2.TIME,dat_bL2.VIB[0,:])\nax[2].set_ylabel(r'VIB [ms$^{-2}$]')\n\n\nax[3].scatter(dat_bL4.TIME,dat_bL4.EPSI[0,:],label=r'$\\epsilon_1$')\nax[3].scatter(dat_bL4.TIME,dat_bL4.EPSI[1,:],label=r'$\\epsilon_2$')\nax[3].scatter(dat_bL4.TIME,dat_bL4.EPSI_FINAL,c='k',marker='x',label=r'$\\epsilon$')\n\n\n### EDIT HERE, only dummies used\n# 1.3b: identify two regions of dissipation (strong versus quiescent) \ni= 1   # strong dissipation\nj= 2   # weak dissipation\n\nax[3].axvline(pd.to_datetime(dat_bL4.TIME[i].values),c='grey',lw=1)\nax[3].axvline(pd.to_datetime(dat_bL4.TIME[j].values),c='grey',lw=1)\n\nax[3].set_yscale('log')\nax[3].set_ylabel(r'$\\epsilon \\mathrm{[W kg^{-1}]}$')\nax[3].set_xlabel('time')\n\n","key":"GRnBPxWFql"},{"type":"output","id":"1ycLdeYTHXT7tHgOIAsFp","data":[{"output_type":"display_data","metadata":{},"data":{"image/png":{"content_type":"image/png","hash":"0fb620e28c935858e816d5bbd013e1e9","path":"/0fb620e28c935858e816d5bbd013e1e9.png"},"text/plain":{"content":"<Figure size 1000x800 with 5 Axes>","content_type":"text/plain"}}}],"key":"ikcoslcKzv"}],"key":"cSYRKDiBI9"},{"type":"block","kind":"notebook-content","data":{},"children":[{"type":"heading","depth":4,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Create model Nasmyth Spectra for chosen dissipation rates in the data","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"cki00Pgjsy"}],"identifier":"create-model-nasmyth-spectra-for-chosen-dissipation-rates-in-the-data","label":"Create model Nasmyth Spectra for chosen dissipation rates in the data","html_id":"create-model-nasmyth-spectra-for-chosen-dissipation-rates-in-the-data","implicit":true,"key":"H1eNFaWuhR"},{"type":"paragraph","position":{"start":{"line":2,"column":1},"end":{"line":2,"column":1}},"children":[{"type":"text","value":"1.4) Using the Nasmyth model, create spectra for your selected dissipation rates.","position":{"start":{"line":2,"column":1},"end":{"line":2,"column":1}},"key":"zxK1MmlSV8"}],"key":"kILFtW3de7"}],"key":"auXd7C4g3n"},{"type":"block","kind":"notebook-code","data":{},"children":[{"type":"code","lang":"python","executable":true,"value":"# print dissipation values for chosen spectra and create model nasmyth shear spectra\n\nknas_strong = np.linspace(0,100,len(dat_bL3.KCYC[:,i]))\nprint(dat_bL4.EPSI_FINAL[i])\nnasmyth_strong = Nasfunc(knas_strong,dat_bL4.EPSI_FINAL[i].values)\n\nprint(dat_bL4.EPSI_FINAL[j])\nknas_weak = np.linspace(0,100,len(dat_bL3.KCYC[:,j]))\nnasmyth_weak = Nasfunc(knas_weak,dat_bL4.EPSI_FINAL[j].values)\n","key":"gGrabT7Db3"},{"type":"output","id":"Hu7gcx5-et96C0paVJw4H","data":[{"name":"stdout","output_type":"stream","text":"<xarray.DataArray 'EPSI_FINAL' ()> Size: 8B\narray(7.880893e-08)\nAttributes:\n    standard_name:  specific_turbulent_kinetic_energy_dissipation_in_sea_water\n    units:          W kg-1\n    long_name:      dissipation rate of turbulent kinetic energy per unit mas...\n<xarray.DataArray 'EPSI_FINAL' ()> Size: 8B\narray(5.477681e-08)\nAttributes:\n    standard_name:  specific_turbulent_kinetic_energy_dissipation_in_sea_water\n    units:          W kg-1\n    long_name:      dissipation rate of turbulent kinetic energy per unit mas...\n"}],"key":"lOy2ScmzMP"}],"key":"iR0gBbOwIo"},{"type":"block","kind":"notebook-content","data":{},"children":[{"type":"heading","depth":4,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Dissipation estimates from shear spectra","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"FBAObsNMPO"}],"identifier":"dissipation-estimates-from-shear-spectra","label":"Dissipation estimates from shear spectra","html_id":"dissipation-estimates-from-shear-spectra","implicit":true,"key":"skjvCATrc1"},{"type":"paragraph","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"text","value":"Look at the agreement between dissipation estimates from the two spectra. Generally, turbulence can be observed to within a factor of two ","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"Rs3Wub40PD"},{"type":"cite","kind":"narrative","label":"moum_comparison_1995","identifier":"moum_comparison_1995","children":[{"type":"text","value":"Moum ","key":"EPsz4we2G5"},{"type":"emphasis","children":[{"type":"text","value":"et al.","key":"RjqeWHowLu"}],"key":"H5SpFNfVTO"},{"type":"text","value":" (1995)","key":"EGiupuWoDS"}],"enumerator":"4","key":"m8F2BSybUx"},{"type":"text","value":".","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"odx6Iap28Y"}],"key":"rb46Ss6VqY"},{"type":"paragraph","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"children":[{"type":"text","value":"1.5) Plot shear spectra at the two dissipation rates that you chose earlier. How does shear spectra relate to dissipation rates?","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"cMg4qKBGja"}],"key":"KZ9gfnrSoB"}],"key":"aRTy4ac1T5"},{"type":"block","kind":"notebook-code","data":{},"children":[{"type":"code","lang":"python","executable":true,"value":"fig,ax=plt.subplots(1,2,figsize=(10,4))\nfig.subplots_adjust(wspace=0.3)\n\n## Dissipation plot\n\nax[0].scatter(dat_bL4.EPSI[0,:],dat_bL4.EPSI[1,:],marker='^',s=5)\n\nax[0].set_yscale('log')\nax[0].set_xscale('log')\n\n# Define the range for the 1-to-1 and confidence interval lines\nx_vals = np.logspace(-10, \n                     -5, 100)\n\n# Plot 1:1 line\nax[0].plot(x_vals, x_vals, 'k')\n\n# Plot factor of 2 confidence intervals\nax[0].plot(x_vals, 2 * x_vals, 'k:')\nax[0].plot(x_vals, 0.5* x_vals, 'k:')\n\nax[0].set_ylim(1e-10,1e-5)\nax[0].set_xlim(1e-10,1e-5)\n\nax[0].set_xlabel(r'$\\epsilon_1 \\mathrm{[W kg^{-1}]}$')\nax[0].set_ylabel(r'$\\epsilon_2 \\mathrm{[W kg^{-1}]}$')\n\n\n## Spectra\n\nax[1].plot(dat_bL3.KCYC[:,i],dat_bL3.SH_SPEC_CLEAN[0,:,i],c='tab:blue',lw=1,label=r'$\\Psi_{1}$')\nax[1].plot(dat_bL3.KCYC[:,i],dat_bL3.SH_SPEC_CLEAN[1,:,i],c='tab:orange',lw=1,label=r'$\\Psi_{2}$')\nax[1].plot(knas_strong,nasmyth_strong,c='grey',lw=1,label='Nasmyth Spectra')\n\nax[1].plot(dat_bL3.KCYC[:,j],dat_bL3.SH_SPEC_CLEAN[0,:,j],c='tab:blue',lw=1)\nax[1].plot(dat_bL3.KCYC[:,j],dat_bL3.SH_SPEC_CLEAN[1,:,j],c='tab:orange',lw=1)\nax[1].plot(knas_weak,nasmyth_weak,c='grey',lw=1)\n\nax[1].set_yscale('log')\nax[1].set_xscale('log')\n\nax[1].set_xlim(0.5,1e2)\nax[1].set_ylim(1e-7,1e-2)\n\nax[1].legend()\n\nax[1].set_xlabel(r'$k$ [cpm]')\nax[1].set_ylabel(r'$\\Psi$ $[s^{-2}\\mathrm{cpm}^{-1}]$')\n\n","key":"JjlPCQeai9"},{"type":"output","id":"a5S4HSZ7vijQcEYFGM1kL","data":[{"output_type":"display_data","metadata":{},"data":{"image/png":{"content_type":"image/png","hash":"aa5a5710f272a828c4d52c08d218bed6","path":"/aa5a5710f272a828c4d52c08d218bed6.png"},"text/plain":{"content":"<Figure size 1000x400 with 2 Axes>","content_type":"text/plain"}}}],"key":"uHBFjKZyxH"}],"key":"fdYyjNMONx"},{"type":"block","kind":"notebook-content","data":{},"children":[{"type":"heading","depth":3,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Haro Straight - A tidal channel.","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"GV8NVttvmh"}],"identifier":"haro-straight-a-tidal-channel","label":"Haro Straight - A tidal channel.","html_id":"haro-straight-a-tidal-channel","implicit":true,"key":"fi7zZPiiJX"},{"type":"container","kind":"figure","children":[{"type":"image","url":"/vmp250-6755156f1987d5118a02189786c84c6a.png","alt":"A Rockland Scientific VMP250.","width":"40%","align":"center","data":{"altTextIsAutoGenerated":true},"key":"fwayAtvEts","urlSource":"images/vmp250.png","urlOptimized":"/vmp250-6755156f1987d5118a02189786c84c6a.webp"},{"type":"caption","children":[{"type":"paragraph","position":{"start":{"line":8,"column":1},"end":{"line":8,"column":1}},"children":[{"type":"captionNumber","kind":"figure","label":"fig-vmp","identifier":"fig-vmp","html_id":"fig-vmp","enumerator":"2","children":[{"type":"text","value":"Figure ","key":"du2rUVXf8V"},{"type":"text","value":"2","key":"ylETaLfuFS"},{"type":"text","value":":","key":"dMctG1YK2e"}],"template":"Figure %s:","key":"RkJ9hmLswg"},{"type":"text","value":"A Rockland Scientific VMP250.","position":{"start":{"line":8,"column":1},"end":{"line":8,"column":1}},"key":"r2ILU2TDVO"}],"key":"KmZ8Oxdnu3"}],"key":"JRGO072m5o"}],"label":"fig-vmp","identifier":"fig-vmp","enumerator":"2","html_id":"fig-vmp","key":"PUAhpNhwtx"},{"type":"paragraph","position":{"start":{"line":10,"column":1},"end":{"line":10,"column":1}},"children":[{"type":"text","value":"This dataset can be downloaded here:","position":{"start":{"line":10,"column":1},"end":{"line":10,"column":1}},"key":"Rwv9O4tV7f"}],"key":"ujSfhx1kYV"},{"type":"paragraph","position":{"start":{"line":12,"column":1},"end":{"line":12,"column":1}},"children":[{"type":"text","value":"Lueck, R. ATOMIX shear probes benchmark data: a dissipation profile from Haro Strait, British Columbia, Canada obtained with a vertical microstructure profiler in October 2016. NERC EDS British Oceanographic Data Centre NOC., ","position":{"start":{"line":12,"column":1},"end":{"line":12,"column":1}},"key":"hIEn3uAQWH"},{"type":"cite","url":"https://doi.org/10.5285/0ec16a65-abdf-2822-e063-6c86abc06533","position":{"start":{"line":12,"column":1},"end":{"line":12,"column":1}},"children":[{"type":"text","value":"Lueck, Rolf G (2024)","key":"eW68Js9O3T"}],"kind":"narrative","label":"https://doi.org/10.5285/0ec16a65-abdf-2822-e063-6c86abc06533","identifier":"https://doi.org/10.5285/0ec16a65-abdf-2822-e063-6c86abc06533","enumerator":"5","key":"PHqNRtVTSw"},{"type":"text","value":" (2024).","position":{"start":{"line":12,"column":1},"end":{"line":12,"column":1}},"key":"qaEkDN0q9K"}],"key":"D9sNYKAzy1"},{"type":"paragraph","position":{"start":{"line":14,"column":1},"end":{"line":14,"column":1}},"children":[{"type":"text","value":"This turbulence profile was taken in a side channel adjacent to Haro Strait on the east coast of Vancouver Island, British Columbia, Canada, on 19 October 2016. The instrument was a VMP-250-IR (internally recording and serial number 215) vertical profiler from Rockland Scientific, Canada. It was configured to collect data while descending, with two shear probes oriented to measure two orthogonal components of the vertical shear of horizontal current, one FP07 thermistor, and two vibration sensors, all of which were anti-alias low-pass filtered at 98 Hz and sampled at a rate of 512 s−1.","position":{"start":{"line":14,"column":1},"end":{"line":14,"column":1}},"key":"iVkiu3cQ1D"}],"key":"BdxykkWNjb"}],"key":"KvL6rit937"},{"type":"block","kind":"notebook-code","data":{},"children":[{"type":"code","lang":"python","executable":true,"value":"# First look at the global attributes\ndat_h=xr.open_dataset('assignment/haro_straight/VMP250_TidalChannel_024.nc', engine=\"h5netcdf\",group=\"\")\ndat_h.attrs","key":"uGnVFuWL0p"},{"type":"output","id":"OnOM1gCQXldTNfqaMrJd-","data":[{"output_type":"execute_result","execution_count":36,"metadata":{},"data":{"text/plain":{"content_type":"text/plain","hash":"2955d85279d5b139b276543e6c789660","path":"/2955d85279d5b139b276543e6c789660.txt"}}}],"key":"xErnI54ClJ"}],"key":"TguuZEhMT9"},{"type":"block","kind":"notebook-code","data":{},"children":[{"type":"code","lang":"python","executable":true,"value":"dat_hL1=xr.open_dataset('assignment/haro_straight/VMP250_TidalChannel_024.nc', engine=\"h5netcdf\",group=\"L1_converted\")\ndat_hL2=xr.open_dataset('assignment/haro_straight/VMP250_TidalChannel_024.nc', engine=\"h5netcdf\",group=\"L2_cleaned\")\ndat_hL3=xr.open_dataset('assignment/haro_straight/VMP250_TidalChannel_024.nc', engine=\"h5netcdf\",group=\"L3_spectra\")\ndat_hL4=xr.open_dataset('assignment/haro_straight/VMP250_TidalChannel_024.nc', engine=\"h5netcdf\",group=\"L4_dissipation\")\n","key":"JVZifXX0I3"},{"type":"output","id":"wyoDMTDwB16ZhfbQ6qxHv","data":[],"key":"oweoXXGRCd"}],"key":"hCok9daWBp"},{"type":"block","kind":"notebook-content","data":{},"children":[{"type":"heading","depth":4,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Plot vertical profile of temperature, salinity and density","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"hSf4nMe15T"}],"identifier":"plot-vertical-profile-of-temperature-salinity-and-density","label":"Plot vertical profile of temperature, salinity and density","html_id":"plot-vertical-profile-of-temperature-salinity-and-density","implicit":true,"key":"WbVtyd1riz"},{"type":"paragraph","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"text","value":"1.6 Describe what you can about the hydrographic structure from this plot.","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"omDuL3ORXb"}],"key":"ipGFSaNNZ5"}],"key":"rQ8Snb3iSe"},{"type":"block","kind":"notebook-code","data":{},"children":[{"type":"code","lang":"python","executable":true,"value":"# calculate salinity and density using the TEOS GSW package. \n\nSP=gsw.SP_from_C(dat_hL1.COND[0,:],dat_hL1.TEMP,dat_hL1.PRES)\nSA=gsw.SA_from_SP(SP,dat_hL1.PRES,-123,48)\nCT =gsw.CT_from_t(SA,dat_hL1.TEMP,dat_hL1.PRES)\nrho=gsw.rho(SA,CT,dat_hL1.PRES)\n","key":"C5syOAKCaq"},{"type":"output","id":"d_TpUXK43Y5JH1yo2hMy1","data":[],"key":"L0P6jS0aE9"}],"key":"a3FnjOQ2u3"},{"type":"block","kind":"notebook-code","data":{},"children":[{"type":"code","lang":"python","executable":true,"value":"fig,ax=plt.subplots(1,3,figsize=(8,5),sharey=True)\nax[0].plot(CT,dat_hL1.PRES)\nax[0].set_ylim(70,0)\nax[0].set_xlim(9.5,11)\nax[0].set_ylabel('Pressure [db]')\nax[0].set_xlabel('Temperature [°C]')\n\nax[1].plot(SA,dat_hL1.PRES)\nax[1].set_xlim(34.3,35.8)\nax[1].set_xlabel('Absolute Salinity [g/kg]')\n\nax[2].plot(rho-1000,dat_hL1.PRES)\nax[2].set_xlim(26,28)\nax[2].set_xlabel('Density [kgm$^{-3}$]')\n","key":"DSglN1odnP"},{"type":"output","id":"VZV1UK00hRPMeBu6Rf0lB","data":[{"output_type":"display_data","metadata":{},"data":{"image/png":{"content_type":"image/png","hash":"90e21106899a20f052245bf2cac93ae3","path":"/90e21106899a20f052245bf2cac93ae3.png"},"text/plain":{"content":"<Figure size 800x500 with 3 Axes>","content_type":"text/plain"}}}],"key":"yNUAqZYyq5"}],"key":"APTnKjZvrl"},{"type":"block","kind":"notebook-content","data":{},"children":[{"type":"heading","depth":4,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Plot time series","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"CmiovkFRzh"}],"identifier":"plot-time-series","label":"Plot time series","html_id":"plot-time-series-1","implicit":true,"key":"n5PmmWgDdc"},{"type":"paragraph","position":{"start":{"line":2,"column":1},"end":{"line":2,"column":1}},"children":[{"type":"text","value":"Like before, below are time series of a) Pressure and Velocity through water, b) vertical shear, c) platform vibrations and d) turbulence dissipation rate.","position":{"start":{"line":2,"column":1},"end":{"line":2,"column":1}},"key":"MiD1eYVNJA"}],"key":"q1LFgIJhSb"},{"type":"paragraph","position":{"start":{"line":4,"column":1},"end":{"line":6,"column":1}},"children":[{"type":"text","value":"1.7) Interpret what might be causing the enhanced vertical shear in b) with reference to the platofrms velocity through water.","position":{"start":{"line":4,"column":1},"end":{"line":4,"column":1}},"key":"vSSpuGDOXQ"},{"type":"break","position":{"start":{"line":4,"column":1},"end":{"line":4,"column":1}},"key":"wbFDwQGDfE"},{"type":"text","value":"1.8a) Describe the vertical profile of the dissipation rate of turbulence (where dissipation rate is high, where it is low) with reference to the distance from the surface and the temperature profile. Comment on differences to the previous profile in the Baltic Sea.\n1.8b) Select two points, one with high dissipation rate and one with low dissipation rate and overlay vertical lines at these chosen points in subpanels d).","position":{"start":{"line":4,"column":1},"end":{"line":4,"column":1}},"key":"Ts4HCvC3bn"}],"key":"g0YQ9KOaxf"}],"key":"yLrdtb06ZV"},{"type":"block","kind":"notebook-code","data":{},"children":[{"type":"code","lang":"python","executable":true,"value":"fig,ax=plt.subplots(4,1,figsize=(10,8),sharex=True)\n\nax[0].plot(dat_hL1.TIME,dat_hL1.PRES,lw=2)\nax[0].set_ylabel('Pressure [db]')\n\naxa=ax[0].twinx()\naxa.plot(dat_hL2.TIME,dat_hL2.PSPD_REL,c='tab:orange',lw=2)\naxa.set_ylabel('W [ms$^{-1}$]',c='tab:orange')\n\n\nax[1].plot(dat_hL2.TIME,dat_hL2.SHEAR[0,:])\nax[1].plot(dat_hL2.TIME,dat_hL2.SHEAR[1,:])\n\nax[1].set_ylabel(r'$\\partial u / \\partial z$ [s$^{-1}$]')\n\nax[2].plot(dat_hL2.TIME,dat_hL2.VIB[0,:])\nax[2].set_ylabel(r'VIB [ms$^{-2}$]')\n\n\nax[3].scatter(dat_hL4.TIME,dat_hL4.EPSI[0,:],label=r'$\\epsilon_1$')\nax[3].scatter(dat_hL4.TIME,dat_hL4.EPSI[1,:],label=r'$\\epsilon_2$')\nax[3].scatter(dat_hL4.TIME,dat_hL4.EPSI_FINAL,c='k',marker='x',label=r'$\\epsilon$')\n\n\n### EDIT HERE, only dummies used\n#identify two regions of dissipation (strong versus quiescent) \ni= 1   # strong dissipation\nj= 2   # weak dissipation\n\nax[3].axvline(pd.to_datetime(dat_hL4.TIME[i].values),c='grey',lw=1)\nax[3].axvline(pd.to_datetime(dat_hL4.TIME[j].values),c='grey',lw=1)\n\nax[3].set_yscale('log')\nax[3].set_ylabel(r'$\\epsilon \\mathrm{[W kg^{-1}]}$')\nax[3].set_xlabel('time')\n\n","key":"bVZtZ4YqhF"},{"type":"output","id":"xJv_DAFLf1bbW02yhL1_Y","data":[{"output_type":"display_data","metadata":{},"data":{"image/png":{"content_type":"image/png","hash":"7a9c001a01a1e5954c990c2dd1ad5d80","path":"/7a9c001a01a1e5954c990c2dd1ad5d80.png"},"text/plain":{"content":"<Figure size 1000x800 with 5 Axes>","content_type":"text/plain"}}}],"key":"KCOPD0xVxA"}],"key":"kO0rvUsL5d"},{"type":"block","kind":"notebook-content","data":{},"children":[{"type":"heading","depth":4,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Create model Nasmyth Spectra for chosen dissipation rates in the data","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"T2HePqYdvF"}],"identifier":"create-model-nasmyth-spectra-for-chosen-dissipation-rates-in-the-data","label":"Create model Nasmyth Spectra for chosen dissipation rates in the data","html_id":"create-model-nasmyth-spectra-for-chosen-dissipation-rates-in-the-data-1","implicit":true,"key":"GGjylpMyry"}],"key":"RlYjryd9x7"},{"type":"block","kind":"notebook-code","data":{},"children":[{"type":"code","lang":"python","executable":true,"value":"# print dissipation values for chosen spectra and create model nasmyth shear spectra\n\nknas_strong = np.linspace(0,100,len(dat_hL3.KCYC[:,i]))\nprint(dat_hL4.EPSI_FINAL[i])\nnasmyth_strong = Nasfunc(knas_strong,dat_hL4.EPSI_FINAL[i].values)\n\nprint(dat_hL4.EPSI_FINAL[j])\nknas_weak = np.linspace(0,100,len(dat_hL3.KCYC[:,j]))\nnasmyth_weak = Nasfunc(knas_weak,dat_hL4.EPSI_FINAL[j].values)\n","key":"ZEsjk7S5UI"},{"type":"output","id":"SYoqSHe9UczbdUuttq-xb","data":[{"name":"stdout","output_type":"stream","text":"<xarray.DataArray 'EPSI_FINAL' ()> Size: 8B\narray(2.579372e-07)\nAttributes:\n    standard_name:  specific_turbulent_kinetic_energy_dissipation_in_sea_water\n    units:          W kg-1\n    long_name:      dissipation rate of turbulent kinetic energy per unit mas...\n<xarray.DataArray 'EPSI_FINAL' ()> Size: 8B\narray(3.521117e-06)\nAttributes:\n    standard_name:  specific_turbulent_kinetic_energy_dissipation_in_sea_water\n    units:          W kg-1\n    long_name:      dissipation rate of turbulent kinetic energy per unit mas...\n"}],"key":"KMhndePujM"}],"key":"FsYQr3YZ48"},{"type":"block","kind":"notebook-content","data":{},"children":[{"type":"heading","depth":4,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Dissipation estimates from shear spectra","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"RD1eNy6KFF"}],"identifier":"dissipation-estimates-from-shear-spectra","label":"Dissipation estimates from shear spectra","html_id":"dissipation-estimates-from-shear-spectra-1","implicit":true,"key":"PdZ70XtNcw"},{"type":"paragraph","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"text","value":"Look at the agreement between dissipation estimates from the two spectra. Generally, turbulence can be observed to within a factor of two.","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"wPjS5P6GJM"}],"key":"rGzNRyrTy8"},{"type":"paragraph","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"children":[{"type":"text","value":"1.9) Plot shear spectra at the two dissipation rates that you chose earlier. How does shear spectra relate to dissipation rates?","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"vuLTFgfGOV"}],"key":"HSg9gBiqXA"}],"key":"Gp2TIuW586"},{"type":"block","kind":"notebook-code","data":{},"children":[{"type":"code","lang":"python","executable":true,"value":"fig,ax=plt.subplots(1,2,figsize=(10,4))\nfig.subplots_adjust(wspace=0.3)\n\n## Dissipation plot\n\nax[0].scatter(dat_hL4.EPSI[0,:],dat_hL4.EPSI[1,:],marker='^',s=5)\n\nax[0].set_yscale('log')\nax[0].set_xscale('log')\n\n# Define the range for the 1-to-1 and confidence interval lines\nx_vals = np.logspace(-7, \n                     -4, 100)\n\n# Plot 1:1 line\nax[0].plot(x_vals, x_vals, 'k')\n\n# Plot factor of 2 confidence intervals\nax[0].plot(x_vals, 2 * x_vals, 'k:')\nax[0].plot(x_vals, 0.5* x_vals, 'k:')\n\nax[0].set_ylim(1e-7,1e-4)\nax[0].set_xlim(1e-7,1e-4)\n\nax[0].set_xlabel(r'$\\epsilon_1 \\mathrm{[W kg^{-1}]}$')\nax[0].set_ylabel(r'$\\epsilon_2 \\mathrm{[W kg^{-1}]}$')\n\n\n## Spectra\n\nax[1].plot(dat_hL3.KCYC[:,i],dat_hL3.SH_SPEC_CLEAN[0,:,i],c='tab:blue',lw=1,label=r'$\\Psi_{1}$')\nax[1].plot(dat_hL3.KCYC[:,i],dat_hL3.SH_SPEC_CLEAN[1,:,i],c='tab:orange',lw=1,label=r'$\\Psi_{2}$')\nax[1].plot(knas_strong,nasmyth_strong,c='grey',lw=1,label='Nasmyth Spectra')\n\nax[1].plot(dat_hL3.KCYC[:,j],dat_hL3.SH_SPEC_CLEAN[0,:,j],c='tab:blue',lw=1)\nax[1].plot(dat_hL3.KCYC[:,j],dat_hL3.SH_SPEC_CLEAN[1,:,j],c='tab:orange',lw=1)\nax[1].plot(knas_weak,nasmyth_weak,c='grey',lw=1)\n\nax[1].set_yscale('log')\nax[1].set_xscale('log')\n\nax[1].set_xlim(0.5,1e2)\nax[1].set_ylim(1e-6,1e-1)\n\nax[1].legend()\n\nax[1].set_xlabel(r'$k$ [cpm]')\nax[1].set_ylabel(r'$\\Psi$ $[s^{-2}\\mathrm{cpm}^{-1}]$')","key":"UWVhwCf6JQ"},{"type":"output","id":"qNRqHjZPwczlvhiyT7kwY","data":[{"output_type":"display_data","metadata":{},"data":{"image/png":{"content_type":"image/png","hash":"d3b1d60a13d1106e5a44eb2660093303","path":"/d3b1d60a13d1106e5a44eb2660093303.png"},"text/plain":{"content":"<Figure size 1000x400 with 2 Axes>","content_type":"text/plain"}}}],"key":"lTUUjOgbUa"}],"key":"oRU76xMA20"},{"type":"block","kind":"notebook-content","data":{},"children":[{"type":"heading","depth":2,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Part II","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"kixjv64qts"}],"identifier":"part-ii","label":"Part II","html_id":"part-ii","implicit":true,"key":"b6WURQLGi0"},{"type":"paragraph","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"text","value":"Use observations of microstructure shear to understand turbulent processes in the ocean","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"vxdNxXdOwm"}],"key":"iMLBNIUvom"}],"key":"MaKoMhdSZ6"},{"type":"block","kind":"notebook-content","data":{},"children":[{"type":"heading","depth":3,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Weddell Sea","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"YW3FkJKyL7"}],"identifier":"weddell-sea","label":"Weddell Sea","html_id":"weddell-sea","implicit":true,"key":"tiZv6MV4hD"},{"type":"container","kind":"figure","children":[{"type":"image","url":"/microrider_slocum-a3623f5a7bd8b0c693b5103eea069006.png","alt":"A Rockland Scientific Microrider mounted on top of a Slocum glider.","width":"40%","align":"center","data":{"altTextIsAutoGenerated":true},"key":"RWKKeZz2o9","urlSource":"images/microrider_slocum.png","urlOptimized":"/microrider_slocum-a3623f5a7bd8b0c693b5103eea069006.webp"},{"type":"caption","children":[{"type":"paragraph","position":{"start":{"line":8,"column":1},"end":{"line":8,"column":1}},"children":[{"type":"captionNumber","kind":"figure","label":"fig-mr_slocum","identifier":"fig-mr_slocum","html_id":"fig-mr-slocum","enumerator":"3","children":[{"type":"text","value":"Figure ","key":"rbapOWdVKU"},{"type":"text","value":"3","key":"wP8J3c3xRg"},{"type":"text","value":":","key":"ExMkcnpFni"}],"template":"Figure %s:","key":"aTRSUfPMId"},{"type":"text","value":"A Rockland Scientific Microrider mounted on top of a Slocum glider.","position":{"start":{"line":8,"column":1},"end":{"line":8,"column":1}},"key":"vqS6SlXOkN"}],"key":"pwozQJY1xZ"}],"key":"ekC0GYGZ9f"}],"label":"fig-mr_slocum","identifier":"fig-mr_slocum","enumerator":"3","html_id":"fig-mr-slocum","key":"eTs0a4uW02"},{"type":"paragraph","position":{"start":{"line":11,"column":1},"end":{"line":11,"column":1}},"children":[{"type":"text","value":"In this part, we will focus on a dataset collected by a Rocklands Scientific Microrider that was mounted on a Slocum glider and deployed in the seasonal sea-ice region of the Weddell Sea. Refer to ","position":{"start":{"line":11,"column":1},"end":{"line":11,"column":1}},"key":"HNMkWT19px"},{"type":"cite","kind":"narrative","label":"giddy_vertical_2023","identifier":"giddy_vertical_2023","children":[{"type":"text","value":"Giddy ","key":"MHJ661WlsH"},{"type":"emphasis","children":[{"type":"text","value":"et al.","key":"Lf0LJbkaFB"}],"key":"XTjXSVfKS4"},{"type":"text","value":" (2023)","key":"SCFywL2kAt"}],"enumerator":"6","key":"vC5CVHASLw"},{"type":"text","value":" for context.","position":{"start":{"line":11,"column":1},"end":{"line":11,"column":1}},"key":"FhzLZh7tY8"}],"key":"fJRLtVINVq"},{"type":"paragraph","position":{"start":{"line":13,"column":1},"end":{"line":13,"column":1}},"children":[{"type":"text","value":"As in Part I, start by looking at the spectra and dissipation rates.","position":{"start":{"line":13,"column":1},"end":{"line":13,"column":1}},"key":"qpQP258d0D"}],"key":"FuTxHEdQrP"}],"key":"PHPLmAyUnt"},{"type":"block","kind":"notebook-code","data":{},"children":[{"type":"code","lang":"python","executable":true,"value":"# First look at the global attributes\ndat_a=xr.open_dataset('assignment/weddell_sea/DAT_190.nc', engine=\"h5netcdf\",group=\"\")\ndat_a.attrs","key":"dRkP9WjFLK"},{"type":"output","id":"G_ncHTF0WIKyrr8pEfwRH","data":[{"output_type":"execute_result","execution_count":43,"metadata":{},"data":{"text/plain":{"content_type":"text/plain","hash":"666d90deaff3a76d6b974b5106953fd7","path":"/666d90deaff3a76d6b974b5106953fd7.txt"}}}],"key":"kSl4K74gtR"}],"key":"XN1KEK0T2w"},{"type":"block","kind":"notebook-code","data":{},"children":[{"type":"code","lang":"python","executable":true,"value":"dat_wL1=xr.open_dataset('assignment/weddell_sea/DAT_190.nc', engine=\"h5netcdf\",group=\"L1_converted\")\ndat_wL2=xr.open_dataset('assignment/weddell_sea/DAT_190.nc', engine=\"h5netcdf\",group=\"L2_cleaned\")\ndat_wL3=xr.open_dataset('assignment/weddell_sea/DAT_190.nc', engine=\"h5netcdf\",group=\"L3_spectra\")\ndat_wL4=xr.open_dataset('assignment/weddell_sea/DAT_190.nc', engine=\"h5netcdf\",group=\"L4_dissipation\")\n","key":"orcGtgydqX"},{"type":"output","id":"q5UkQGQWULpOwIW4PnE24","data":[],"key":"hT8eR1nPf3"}],"key":"b2qkAPige4"},{"type":"block","kind":"notebook-content","data":{},"children":[{"type":"heading","depth":4,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Plot vertical profile of temperature, salinity, density and vertical stratification","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"iZHdcQZ6Lt"}],"identifier":"plot-vertical-profile-of-temperature-salinity-density-and-vertical-stratification","label":"Plot vertical profile of temperature, salinity, density and vertical stratification","html_id":"plot-vertical-profile-of-temperature-salinity-density-and-vertical-stratification","implicit":true,"key":"rWuvwsIrpj"},{"type":"paragraph","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"text","value":"2.1 Describe what you can about the hydrographic structure from this plot.","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"ViVjQ1X7qA"}],"key":"lJ81hXLjdK"}],"key":"EOuea35eIn"},{"type":"block","kind":"notebook-code","data":{},"children":[{"type":"code","lang":"python","executable":true,"value":"# calculate density and stratification\nrho=gsw.rho(dat_wL1.SALT,dat_wL1.TEMP_CTD,dat_wL1.PRES_SLOW)\n\nrho_sorted =np.sort(rho) \n\n# Compute brunt-vaisala frequency \ng=9.8\np0=1025\n# n2 = g/p0*(np.diff(rho_sorted)/np.diff(low_res_ctd.z))\ndrho_dz = np.gradient(rho_sorted, dat_wL1.PRES_SLOW)\nn2 = g/p0*drho_dz\n\ndef smooth(x, window_len=5):\n    return np.convolve(x, np.ones(window_len)/window_len, mode='same')\n\nn2_smooth = smooth(n2, window_len=1000)\n\n","key":"HQLauVuWho"},{"type":"output","id":"j9lNKbH4ffXPbDxhidqQ5","data":[{"name":"stderr","output_type":"stream","text":"/Users/xnunei/miniconda3/envs/teach/lib/python3.13/site-packages/numpy/lib/_function_base_impl.py:1290: RuntimeWarning: divide by zero encountered in divide\n  a = -(dx2)/(dx1 * (dx1 + dx2))\n/Users/xnunei/miniconda3/envs/teach/lib/python3.13/site-packages/numpy/lib/_function_base_impl.py:1290: RuntimeWarning: invalid value encountered in divide\n  a = -(dx2)/(dx1 * (dx1 + dx2))\n/Users/xnunei/miniconda3/envs/teach/lib/python3.13/site-packages/numpy/lib/_function_base_impl.py:1291: RuntimeWarning: divide by zero encountered in divide\n  b = (dx2 - dx1) / (dx1 * dx2)\n/Users/xnunei/miniconda3/envs/teach/lib/python3.13/site-packages/numpy/lib/_function_base_impl.py:1291: RuntimeWarning: invalid value encountered in divide\n  b = (dx2 - dx1) / (dx1 * dx2)\n/Users/xnunei/miniconda3/envs/teach/lib/python3.13/site-packages/numpy/lib/_function_base_impl.py:1292: RuntimeWarning: divide by zero encountered in divide\n  c = dx1 / (dx2 * (dx1 + dx2))\n/Users/xnunei/miniconda3/envs/teach/lib/python3.13/site-packages/numpy/lib/_function_base_impl.py:1292: RuntimeWarning: invalid value encountered in divide\n  c = dx1 / (dx2 * (dx1 + dx2))\n/Users/xnunei/miniconda3/envs/teach/lib/python3.13/site-packages/numpy/lib/_function_base_impl.py:1298: RuntimeWarning: invalid value encountered in add\n  out[tuple(slice1)] = a * f[tuple(slice2)] + b * f[tuple(slice3)] + c * f[tuple(slice4)]\n/Users/xnunei/miniconda3/envs/teach/lib/python3.13/site-packages/numpy/lib/_function_base_impl.py:1307: RuntimeWarning: divide by zero encountered in scalar divide\n  out[tuple(slice1)] = (f[tuple(slice2)] - f[tuple(slice3)]) / dx_0\n/Users/xnunei/miniconda3/envs/teach/lib/python3.13/site-packages/numpy/lib/_function_base_impl.py:1314: RuntimeWarning: invalid value encountered in scalar divide\n  out[tuple(slice1)] = (f[tuple(slice2)] - f[tuple(slice3)]) / dx_n\n"}],"key":"SsbsCupXgv"}],"key":"yXzJQ90w6e"},{"type":"block","kind":"notebook-code","data":{},"children":[{"type":"code","lang":"python","executable":true,"value":"fig,ax=plt.subplots(1,4,figsize=(10,5),sharey=True)\nax[0].plot(dat_wL1.TEMP_CTD,dat_wL1.PRES_SLOW)\nax[0].set_ylim(150,0)\n# ax[0].set_xlim(9.5,11)\nax[0].set_ylabel('Pressure [db]')\nax[0].set_xlabel('Temperature [°C]')\n\nax[1].plot(dat_wL1.SALT,dat_wL1.PRES_SLOW)\n# ax[1].set_xlim(34.3,35.8)\nax[1].set_xlabel('Absolute Salinity [g/kg]')\n\nax[2].plot(rho-1000,dat_wL1.PRES_SLOW)\nax[2].set_xlim(27,28.5)\nax[2].set_xlabel('Density [kgm$^{-3}$]')\n\n\nax[3].plot(np.abs(n2),dat_wL1.PRES_SLOW[:])\nax[3].plot(np.abs(n2_smooth),dat_wL1.PRES_SLOW[:],c='k')\n\nax[3].set_xlim(1e-5,1e-3)\nax[3].set_xlabel('N$^2$ [s$^{-2}$]')\nax[3].set_xscale('log')\n\n","key":"wgI051QoaB"},{"type":"output","id":"p5ruh94HBCYeJ2WYrTHdQ","data":[{"output_type":"display_data","metadata":{},"data":{"image/png":{"content_type":"image/png","hash":"e156929b9c41b9c1a92afd3fc4844ae6","path":"/e156929b9c41b9c1a92afd3fc4844ae6.png"},"text/plain":{"content":"<Figure size 1000x500 with 4 Axes>","content_type":"text/plain"}}}],"key":"Lm52oIK3bj"}],"key":"RH4ycTm94t"},{"type":"block","kind":"notebook-content","data":{},"children":[{"type":"heading","depth":4,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Plot time series","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"iaMb51VSV9"}],"identifier":"plot-time-series","label":"Plot time series","html_id":"plot-time-series-2","implicit":true,"key":"pj5uhS5JK5"},{"type":"paragraph","position":{"start":{"line":2,"column":1},"end":{"line":2,"column":1}},"children":[{"type":"text","value":"Below are time series of a) Pressure and Velocity through water, b) vertical shear, c) platform vibrations and d) turbulence dissipation rate.","position":{"start":{"line":2,"column":1},"end":{"line":2,"column":1}},"key":"q6GZJZjFPO"}],"key":"xxqmAapV95"},{"type":"paragraph","position":{"start":{"line":4,"column":1},"end":{"line":5,"column":1}},"children":[{"type":"text","value":"2.2a) Describe the vertical profile of the dissipation rate of turbulence (where dissipation rate is high, where it is low) with reference to the distance from the surface and the temperature profile.","position":{"start":{"line":4,"column":1},"end":{"line":4,"column":1}},"key":"FTOiHBhwPE"},{"type":"break","position":{"start":{"line":4,"column":1},"end":{"line":4,"column":1}},"key":"jR3eE1wP3G"},{"type":"text","value":"2.2b) Select two points, one with high dissipation rate and one with low dissipation rate and overlay vertical lines at these chosen points in subpanels d).","position":{"start":{"line":4,"column":1},"end":{"line":4,"column":1}},"key":"kKjBFyZa5a"}],"key":"OaGRb5gGAp"}],"key":"TohZTI9aXZ"},{"type":"block","kind":"notebook-code","data":{},"children":[{"type":"code","lang":"python","executable":true,"value":"fig,ax=plt.subplots(4,1,figsize=(10,8),sharex=True)\n\nax[0].plot(dat_wL1.TIME,dat_wL1.PRES,lw=2)\nax[0].set_ylabel('Pressure [db]')\n\naxa=ax[0].twinx()\naxa.plot(dat_wL2.TIME,dat_wL2.PSPD_REL,c='tab:orange',lw=2)\naxa.set_ylabel('W [ms$^{-1}$]',c='tab:orange')\n\n\nax[1].plot(dat_wL2.TIME,dat_wL2.SHEAR[0,:])\nax[1].plot(dat_wL2.TIME,dat_wL2.SHEAR[1,:])\n\nax[1].set_ylabel(r'$\\partial u / \\partial z$ [s$^{-1}$]')\n\nax[2].plot(dat_wL2.TIME,dat_wL2.VIB[0,:])\nax[2].set_ylabel(r'VIB [ms$^{-2}$]')\n\n\nax[3].scatter(dat_wL4.TIME,dat_wL4.EPSI[0,:],label=r'$\\epsilon_1$')\nax[3].scatter(dat_wL4.TIME,dat_wL4.EPSI[1,:],label=r'$\\epsilon_2$')\nax[3].scatter(dat_wL4.TIME,dat_wL4.EPSI_FINAL,c='k',marker='x',label=r'$\\epsilon$')\n\n### EDIT HERE, only dummies used\n# identify two regions of dissipation (strong versus quiescent) \ni= 1   # strong dissipation\nj= 2   # weak dissipation\n\nax[3].axvline(pd.to_datetime(dat_wL4.TIME[i].values),c='grey',lw=1)\nax[3].axvline(pd.to_datetime(dat_wL4.TIME[j].values),c='grey',lw=1)\n\nax[3].set_yscale('log')\nax[3].set_ylabel(r'$\\epsilon \\mathrm{[W kg^{-1}]}$')\nax[3].set_xlabel('time')\n\n","key":"RBL773ypmL"},{"type":"output","id":"bxVPJraNLUT4frfD4yJcx","data":[{"output_type":"display_data","metadata":{},"data":{"image/png":{"content_type":"image/png","hash":"143632666547e41fdffe5a911f9242ee","path":"/143632666547e41fdffe5a911f9242ee.png"},"text/plain":{"content":"<Figure size 1000x800 with 5 Axes>","content_type":"text/plain"}}}],"key":"WkBZ9m5Eqe"}],"key":"we0ydlTyIz"},{"type":"block","kind":"notebook-content","data":{},"children":[{"type":"heading","depth":4,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Create model Nasmyth Spectra for chosen dissipation rates in the data","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"BR4ZhDXyIV"}],"identifier":"create-model-nasmyth-spectra-for-chosen-dissipation-rates-in-the-data","label":"Create model Nasmyth Spectra for chosen dissipation rates in the data","html_id":"create-model-nasmyth-spectra-for-chosen-dissipation-rates-in-the-data-2","implicit":true,"key":"Nq1kM3lOeK"}],"key":"eWw1DcngaW"},{"type":"block","kind":"notebook-code","data":{},"children":[{"type":"code","lang":"python","executable":true,"value":"# print dissipation values for chosen spectra and create model nasmyth shear spectra\n\nknas_strong = np.linspace(0,100,len(dat_wL3.KCYC[:,i]))\nprint(dat_wL4.EPSI_FINAL[i])\nnasmyth_strong = Nasfunc(knas_strong,dat_wL4.EPSI_FINAL[i].values)\n\nprint(dat_wL4.EPSI_FINAL[j])\nknas_weak = np.linspace(0,100,len(dat_wL3.KCYC[:,j]))\nnasmyth_weak = Nasfunc(knas_weak,dat_wL4.EPSI_FINAL[j].values)\n","key":"atQRUM1664"},{"type":"output","id":"Y1gD0lRJdNwZy19kziWJJ","data":[{"name":"stdout","output_type":"stream","text":"<xarray.DataArray 'EPSI_FINAL' ()> Size: 8B\narray(1.532142e-07)\nAttributes:\n    standard_name:  specific_turbulent_kinetic_energy_dissipation_in_sea_water\n    units:          W kg-1\n    long_name:      dissipation rate of turbulent kinetic energy per unit mas...\n<xarray.DataArray 'EPSI_FINAL' ()> Size: 8B\narray(2.353111e-07)\nAttributes:\n    standard_name:  specific_turbulent_kinetic_energy_dissipation_in_sea_water\n    units:          W kg-1\n    long_name:      dissipation rate of turbulent kinetic energy per unit mas...\n"}],"key":"IZFa1qVIFA"}],"key":"L2if9OvbId"},{"type":"block","kind":"notebook-content","data":{},"children":[{"type":"heading","depth":4,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Dissipation estimates from shear spectra","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"ODoRSOx7Tn"}],"identifier":"dissipation-estimates-from-shear-spectra","label":"Dissipation estimates from shear spectra","html_id":"dissipation-estimates-from-shear-spectra-2","implicit":true,"key":"HW3xfxQSjO"},{"type":"paragraph","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"text","value":"Look at the agreement between dissipation estimates from the two spectra. Generally, turbulence can be observed to within a factor of two.","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"Koa8iYGHcC"}],"key":"aMROVhgZjU"},{"type":"paragraph","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"children":[{"type":"text","value":"2.3) Look at the dissipation estimates from tho probes. At which dissipation rate might you expect to be less condident about the results?","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"O68BlxhPZj"}],"key":"VExOyWF2Ix"},{"type":"paragraph","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"children":[{"type":"text","value":"2.4) Plot shear spectra at the two dissipation rates that you chose earlier. How does shear spectra relate to dissipation rates?","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"key":"gCCVanNO35"}],"key":"BbsHZR0OBf"}],"key":"egfzfNWRAf"},{"type":"block","kind":"notebook-code","data":{},"children":[{"type":"code","lang":"python","executable":true,"value":"fig,ax=plt.subplots(1,2,figsize=(10,4))\nfig.subplots_adjust(wspace=0.3)\n\n## Dissipation plot\n\nax[0].scatter(dat_wL4.EPSI[0,:],dat_wL4.EPSI[1,:],marker='^',s=5)\n\nax[0].set_yscale('log')\nax[0].set_xscale('log')\n\n# Define the range for the 1-to-1 and confidence interval lines\nx_vals = np.logspace(-11, \n                     -5, 100)\n\n# Plot 1:1 line\nax[0].plot(x_vals, x_vals, 'k')\n\n# Plot factor of 2 confidence intervals\nax[0].plot(x_vals, 2 * x_vals, 'k:')\nax[0].plot(x_vals, 0.5* x_vals, 'k:')\n\nax[0].set_ylim(1e-11,1e-5)\nax[0].set_xlim(1e-11,1e-5)\n\nax[0].set_xlabel(r'$\\epsilon_1 \\mathrm{[W kg^{-1}]}$')\nax[0].set_ylabel(r'$\\epsilon_2 \\mathrm{[W kg^{-1}]}$')\n\n\n## Spectra\n\nax[1].plot(dat_wL3.KCYC[:,i],dat_wL3.SH_SPEC_CLEAN[0,:,i],c='tab:blue',lw=1,label=r'$\\Psi_{1}$')\nax[1].plot(dat_wL3.KCYC[:,i],dat_wL3.SH_SPEC_CLEAN[1,:,i],c='tab:orange',lw=1,label=r'$\\Psi_{2}$')\nax[1].plot(knas_strong,nasmyth_strong,c='grey',lw=1,label='Nasmyth Spectra')\n\nax[1].plot(dat_wL3.KCYC[:,j],dat_wL3.SH_SPEC_CLEAN[0,:,j],c='tab:blue',lw=1)\nax[1].plot(dat_wL3.KCYC[:,j],dat_wL3.SH_SPEC_CLEAN[1,:,j],c='tab:orange',lw=1)\nax[1].plot(knas_weak,nasmyth_weak,c='grey',lw=1)\n\nax[1].set_yscale('log')\nax[1].set_xscale('log')\n\nax[1].set_xlim(0.5,1e2)\nax[1].set_ylim(1e-10,1e-1)\n\nax[1].legend()\n\nax[1].set_xlabel(r'$k$ [cpm]')\nax[1].set_ylabel(r'$\\Psi$ $[s^{-2}\\mathrm{cpm}^{-1}]$')","key":"TrQstYAjHQ"},{"type":"output","id":"F4aS3x4MH-vyuaw7Ij_za","data":[{"output_type":"display_data","metadata":{},"data":{"image/png":{"content_type":"image/png","hash":"7e2990711c84ee1fe1b198339e371d64","path":"/7e2990711c84ee1fe1b198339e371d64.png"},"text/plain":{"content":"<Figure size 1000x400 with 2 Axes>","content_type":"text/plain"}}}],"key":"GkrRQvQ0Vm"}],"key":"KtvrxDVSuL"},{"type":"block","kind":"notebook-content","data":{},"children":[{"type":"heading","depth":4,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Compute the vertical turbulent heat flux","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"Nq9lMAisTB"}],"identifier":"compute-the-vertical-turbulent-heat-flux","label":"Compute the vertical turbulent heat flux","html_id":"compute-the-vertical-turbulent-heat-flux","implicit":true,"key":"SxiTtiexir"},{"type":"paragraph","position":{"start":{"line":2,"column":1},"end":{"line":2,"column":1}},"children":[{"type":"text","value":"Using the Eddy Diffusivity, ","position":{"start":{"line":2,"column":1},"end":{"line":2,"column":1}},"key":"daNuRu6bxf"},{"type":"inlineMath","value":"Kz","position":{"start":{"line":2,"column":1},"end":{"line":2,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>K</mi><mi>z</mi></mrow><annotation encoding=\"application/x-tex\">Kz</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6833em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.04398em;\">Kz</span></span></span></span>","key":"v1AR7mHwuw"},{"type":"text","value":" and following Osborn (1960), calculate the vertical turbulent heat flux.","position":{"start":{"line":2,"column":1},"end":{"line":2,"column":1}},"key":"NJ0wU7PZYh"}],"key":"cVgo91j6bX"},{"type":"paragraph","position":{"start":{"line":4,"column":1},"end":{"line":4,"column":1}},"children":[{"type":"text","value":"Assuming the Osborn model for ","position":{"start":{"line":4,"column":1},"end":{"line":4,"column":1}},"key":"vaXk31nxta"},{"type":"inlineMath","value":"Kz","position":{"start":{"line":4,"column":1},"end":{"line":4,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>K</mi><mi>z</mi></mrow><annotation encoding=\"application/x-tex\">Kz</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6833em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.04398em;\">Kz</span></span></span></span>","key":"KIgojKTivD"},{"type":"text","value":":","position":{"start":{"line":4,"column":1},"end":{"line":4,"column":1}},"key":"gmO5KyZwBP"}],"key":"XH7YRTvZBB"},{"type":"math","value":"\\mathrm{Kz}=0.2\\frac{\\epsilon}{N^2}","position":{"start":{"line":6,"column":1},"end":{"line":8,"column":1}},"html":"<span class=\"katex-display\"><span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\" display=\"block\"><semantics><mrow><mrow><mi mathvariant=\"normal\">K</mi><mi mathvariant=\"normal\">z</mi></mrow><mo>=</mo><mn>0.2</mn><mfrac><mi>ϵ</mi><msup><mi>N</mi><mn>2</mn></msup></mfrac></mrow><annotation encoding=\"application/x-tex\">\\mathrm{Kz}=0.2\\frac{\\epsilon}{N^2}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6833em;\"></span><span class=\"mord\"><span class=\"mord mathrm\">Kz</span></span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1.7936em;vertical-align:-0.686em;\"></span><span class=\"mord\">0.2</span><span class=\"mord\"><span class=\"mopen nulldelimiter\"></span><span class=\"mfrac\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:1.1076em;\"><span style=\"top:-2.314em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.10903em;\">N</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.7401em;\"><span style=\"top:-2.989em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">2</span></span></span></span></span></span></span></span></span></span><span style=\"top:-3.23em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"frac-line\" style=\"border-bottom-width:0.04em;\"></span></span><span style=\"top:-3.677em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">ϵ</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.686em;\"><span></span></span></span></span></span><span class=\"mclose nulldelimiter\"></span></span></span></span></span></span>","enumerator":"1","key":"yDEjehA6y6"},{"type":"paragraph","position":{"start":{"line":10,"column":1},"end":{"line":10,"column":1}},"children":[{"type":"text","value":"Note that because the Osborn model for eddy diffusivity is calculated as a function of ","position":{"start":{"line":10,"column":1},"end":{"line":10,"column":1}},"key":"EEKH5E0ag8"},{"type":"inlineMath","value":"N^2","position":{"start":{"line":10,"column":1},"end":{"line":10,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msup><mi>N</mi><mn>2</mn></msup></mrow><annotation encoding=\"application/x-tex\">N^2</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.8141em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.10903em;\">N</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8141em;\"><span style=\"top:-3.063em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">2</span></span></span></span></span></span></span></span></span></span></span>","key":"EuCHSEDqXf"},{"type":"text","value":", it will not be valid in conditions of very small ","position":{"start":{"line":10,"column":1},"end":{"line":10,"column":1}},"key":"UtArS0Bkvx"},{"type":"inlineMath","value":"N^2","position":{"start":{"line":10,"column":1},"end":{"line":10,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msup><mi>N</mi><mn>2</mn></msup></mrow><annotation encoding=\"application/x-tex\">N^2</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.8141em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.10903em;\">N</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8141em;\"><span style=\"top:-3.063em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">2</span></span></span></span></span></span></span></span></span></span></span>","key":"ozfJ5XpASu"},{"type":"text","value":". Where might this occur?","position":{"start":{"line":10,"column":1},"end":{"line":10,"column":1}},"key":"Fz6K7EiYCj"}],"key":"XOM8eBWpWo"},{"type":"paragraph","position":{"start":{"line":12,"column":1},"end":{"line":12,"column":1}},"children":[{"type":"text","value":"Heat flux can be approximated as:","position":{"start":{"line":12,"column":1},"end":{"line":12,"column":1}},"key":"dYrKeyWR0p"}],"key":"EZ9TGLmOpC"},{"type":"math","value":"H_f=\\rho_0 c_p \\mathrm{Kz} \\frac{dT}{dz}","position":{"start":{"line":14,"column":1},"end":{"line":16,"column":1}},"html":"<span class=\"katex-display\"><span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\" display=\"block\"><semantics><mrow><msub><mi>H</mi><mi>f</mi></msub><mo>=</mo><msub><mi>ρ</mi><mn>0</mn></msub><msub><mi>c</mi><mi>p</mi></msub><mrow><mi mathvariant=\"normal\">K</mi><mi mathvariant=\"normal\">z</mi></mrow><mfrac><mrow><mi>d</mi><mi>T</mi></mrow><mrow><mi>d</mi><mi>z</mi></mrow></mfrac></mrow><annotation encoding=\"application/x-tex\">H_f=\\rho_0 c_p \\mathrm{Kz} \\frac{dT}{dz}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.9694em;vertical-align:-0.2861em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.08125em;\">H</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3361em;\"><span style=\"top:-2.55em;margin-left:-0.0813em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.10764em;\">f</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.2861em;\"><span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:2.0574em;vertical-align:-0.686em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">ρ</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3011em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">0</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mord\"><span class=\"mord mathnormal\">c</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.1514em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">p</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.2861em;\"><span></span></span></span></span></span></span><span class=\"mord\"><span class=\"mord mathrm\">Kz</span></span><span class=\"mord\"><span class=\"mopen nulldelimiter\"></span><span class=\"mfrac\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:1.3714em;\"><span style=\"top:-2.314em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">d</span><span class=\"mord mathnormal\" style=\"margin-right:0.04398em;\">z</span></span></span><span style=\"top:-3.23em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"frac-line\" style=\"border-bottom-width:0.04em;\"></span></span><span style=\"top:-3.677em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">d</span><span class=\"mord mathnormal\" style=\"margin-right:0.13889em;\">T</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.686em;\"><span></span></span></span></span></span><span class=\"mclose nulldelimiter\"></span></span></span></span></span></span>","enumerator":"2","key":"LsyiKtOjYw"},{"type":"paragraph","position":{"start":{"line":18,"column":1},"end":{"line":18,"column":1}},"children":[{"type":"text","value":"2.5) What is the range of Eddy diffusivity? Is this comparable to expected values in the ocean?","position":{"start":{"line":18,"column":1},"end":{"line":18,"column":1}},"key":"zwPE2WmtkP"}],"key":"tMR3pL1srx"},{"type":"paragraph","position":{"start":{"line":20,"column":1},"end":{"line":20,"column":1}},"children":[{"type":"text","value":"2.6) Where is heat flux the strongest? What are possible explanations for the distribution of heat flux in this profile?","position":{"start":{"line":20,"column":1},"end":{"line":20,"column":1}},"key":"BfI4nIx5IJ"}],"key":"GPcu6fLQ3T"}],"key":"runzZCCicz"},{"type":"block","kind":"notebook-code","data":{},"children":[{"type":"code","lang":"python","executable":true,"value":"\n#interporate salinity to dissipation spectra\nds_interp = dat_wL1.SALT.interp(\n    TIME_SLOW=dat_wL4.TIME\n)\n\nSA=ds_interp\n\n# calculate density and stratification\nrho=gsw.rho(SA,dat_wL4.TEMP,dat_wL4.PRES)\n\nrho_sorted =np.sort(rho) \n\n# Compute brunt-vaisala frequency \ng=9.8\np0=1025\n# n2 = g/p0*(np.diff(rho_sorted)/np.diff(low_res_ctd.z))\ndrho_dz = np.gradient(rho_sorted, dat_wL4.PRES)\nn2 = g/p0*drho_dz\n","key":"noI5V4AjJN"},{"type":"output","id":"EXzVQDC7xY4lLQSojB3WV","data":[],"key":"A5PiP4TTFf"}],"key":"LjbtmZvuAf"},{"type":"block","kind":"notebook-code","data":{},"children":[{"type":"code","lang":"python","executable":true,"value":"# Eddy diffusivity, k=0.2 epsilon/N2 \n# Osborn Model \n\nKz= 0.2*dat_wL4.EPSI_FINAL/np.abs(n2)","key":"EqwpSjoriL"},{"type":"output","id":"Y5jLqD75tPCQprnfjF8nN","data":[],"key":"sJ1BMa7uj7"}],"key":"fhJ7BKSg0O"},{"type":"block","kind":"notebook-code","data":{},"children":[{"type":"code","lang":"python","executable":true,"value":"fig,ax=plt.subplots(1,5,figsize=(15,5),sharey=True)\n\nrho0=1000\ncp=4000\n\nax[0].plot(dat_wL4.EPSI_FINAL,dat_wL4.PRES)\nax[0].set_xscale('log')\n\nax[1].plot(Kz,dat_wL4.PRES)\nax[1].set_xscale('log')\nax[2].plot(dat_wL4.TEMP,dat_wL4.PRES)\nax[3].plot((np.gradient(dat_wL4.TEMP)/np.gradient(dat_wL4.PRES)),dat_wL4.PRES)\nax[4].plot(rho0*cp*Kz*(np.gradient(dat_wL4.TEMP)/np.gradient(dat_wL4.PRES)),dat_wL4.PRES)\nax[4].set_xlim(-5,5)\nax[3].set_ylim(180,0)\n\nax[0].set_ylabel('Depth  (m)')\nax[0].set_xlabel('$\\epsilon \\ (m^3s^{-2})$')\nax[1].set_xlabel('$K_z \\ (m^2s^{-1})$')\nax[2].set_xlabel('Temperature  (°C)')\nax[3].set_xlabel(r'$\\frac{dT}{dz}$  (°C m$^{-1}$)')\nax[4].set_xlabel('F$_h$  (W$m^{-2})$')\n\n\n","key":"hBmSCX4Z8S"},{"type":"output","id":"2vbG_iP5lks4b3XkoFvxU","data":[{"name":"stderr","output_type":"stream","text":"<>:18: SyntaxWarning: invalid escape sequence '\\e'\n<>:19: SyntaxWarning: invalid escape sequence '\\ '\n<>:18: SyntaxWarning: invalid escape sequence '\\e'\n<>:19: SyntaxWarning: invalid escape sequence '\\ '\n/var/folders/1q/qmm9yg_90xl7f60v6q7wn2fr0000gn/T/ipykernel_9487/2509822319.py:18: SyntaxWarning: invalid escape sequence '\\e'\n  ax[0].set_xlabel('$\\epsilon \\ (m^3s^{-2})$')\n/var/folders/1q/qmm9yg_90xl7f60v6q7wn2fr0000gn/T/ipykernel_9487/2509822319.py:19: SyntaxWarning: invalid escape sequence '\\ '\n  ax[1].set_xlabel('$K_z \\ (m^2s^{-1})$')\n"},{"output_type":"display_data","metadata":{},"data":{"image/png":{"content_type":"image/png","hash":"62699a26b1f1c436706623a0b6a5543c","path":"/62699a26b1f1c436706623a0b6a5543c.png"},"text/plain":{"content":"<Figure size 1500x500 with 5 Axes>","content_type":"text/plain"}}}],"key":"xgtIBUcohV"}],"key":"brxzF0I8Lm"},{"type":"block","kind":"notebook-content","data":{},"children":[{"type":"heading","depth":4,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Compare the law-of-the-wall model for turbulent dissipation in a boundary layer with the observations","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"ARHTjtEK6Z"}],"identifier":"compare-the-law-of-the-wall-model-for-turbulent-dissipation-in-a-boundary-layer-with-the-observations","label":"Compare the law-of-the-wall model for turbulent dissipation in a boundary layer with the observations","html_id":"compare-the-law-of-the-wall-model-for-turbulent-dissipation-in-a-boundary-layer-with-the-observations","implicit":true,"key":"vOTc3s51g5"},{"type":"paragraph","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"text","value":"Law of the wall:","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"NzqthQTzG4"}],"key":"zeRKrhsCz6"},{"type":"math","value":"\\epsilon = \\frac{u_*^3}{\\kappa z}","position":{"start":{"line":5,"column":1},"end":{"line":7,"column":1}},"html":"<span class=\"katex-display\"><span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\" display=\"block\"><semantics><mrow><mi>ϵ</mi><mo>=</mo><mfrac><msubsup><mi>u</mi><mo>∗</mo><mn>3</mn></msubsup><mrow><mi>κ</mi><mi>z</mi></mrow></mfrac></mrow><annotation encoding=\"application/x-tex\">\\epsilon = \\frac{u_*^3}{\\kappa z}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.4306em;\"></span><span class=\"mord mathnormal\">ϵ</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:2.1771em;vertical-align:-0.686em;\"></span><span class=\"mord\"><span class=\"mopen nulldelimiter\"></span><span class=\"mfrac\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:1.4911em;\"><span style=\"top:-2.314em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">κ</span><span class=\"mord mathnormal\" style=\"margin-right:0.04398em;\">z</span></span></span><span style=\"top:-3.23em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"frac-line\" style=\"border-bottom-width:0.04em;\"></span></span><span style=\"top:-3.677em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\"><span class=\"mord mathnormal\">u</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8141em;\"><span style=\"top:-2.453em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mbin mtight\">∗</span></span></span><span style=\"top:-3.063em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">3</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.247em;\"><span></span></span></span></span></span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.686em;\"><span></span></span></span></span></span><span class=\"mclose nulldelimiter\"></span></span></span></span></span></span>","enumerator":"3","key":"G8lsbuoXud"},{"type":"paragraph","position":{"start":{"line":9,"column":1},"end":{"line":9,"column":1}},"children":[{"type":"text","value":"2.7) What are the main assumptions of law-of-the-wall?","position":{"start":{"line":9,"column":1},"end":{"line":9,"column":1}},"key":"HBeKmNLrK5"}],"key":"Scd0RGsuVg"},{"type":"paragraph","position":{"start":{"line":11,"column":1},"end":{"line":11,"column":1}},"children":[{"type":"text","value":"2.8) Up to what depth does law-of-the-wall agree with observations?","position":{"start":{"line":11,"column":1},"end":{"line":11,"column":1}},"key":"iqfyEXAFgx"}],"key":"eEd90vvgUw"},{"type":"paragraph","position":{"start":{"line":13,"column":1},"end":{"line":13,"column":1}},"children":[{"type":"text","value":"2.9) Given ","position":{"start":{"line":13,"column":1},"end":{"line":13,"column":1}},"key":"PEwPvv3jmD"},{"type":"inlineMath","value":"B_0 = 1 \\times 10^{-8} \\ m^3 s^{-2}","position":{"start":{"line":13,"column":1},"end":{"line":13,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msub><mi>B</mi><mn>0</mn></msub><mo>=</mo><mn>1</mn><mo>×</mo><mn>1</mn><msup><mn>0</mn><mrow><mo>−</mo><mn>8</mn></mrow></msup><mtext> </mtext><msup><mi>m</mi><mn>3</mn></msup><msup><mi>s</mi><mrow><mo>−</mo><mn>2</mn></mrow></msup></mrow><annotation encoding=\"application/x-tex\">B_0 = 1 \\times 10^{-8} \\ m^3 s^{-2}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.8333em;vertical-align:-0.15em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.05017em;\">B</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3011em;\"><span style=\"top:-2.55em;margin-left:-0.0502em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">0</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.7278em;vertical-align:-0.0833em;\"></span><span class=\"mord\">1</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">×</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.8141em;\"></span><span class=\"mord\">1</span><span class=\"mord\"><span class=\"mord\">0</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8141em;\"><span style=\"top:-3.063em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mtight\">−</span><span class=\"mord mtight\">8</span></span></span></span></span></span></span></span></span><span class=\"mspace\"> </span><span class=\"mord\"><span class=\"mord mathnormal\">m</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8141em;\"><span style=\"top:-3.063em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">3</span></span></span></span></span></span></span></span><span class=\"mord\"><span class=\"mord mathnormal\">s</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8141em;\"><span style=\"top:-3.063em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mtight\">−</span><span class=\"mord mtight\">2</span></span></span></span></span></span></span></span></span></span></span></span>","key":"pqnTyFqTmL"},{"type":"text","value":", compute the Monin-Obukhov length scale and make a statement about the forcing conditions experienced while this profile was taken.","position":{"start":{"line":13,"column":1},"end":{"line":13,"column":1}},"key":"tbQZIobFXk"}],"key":"dXyqs9ftDx"}],"key":"Nuvizv9fFr"},{"type":"block","kind":"notebook-code","data":{},"children":[{"type":"code","lang":"python","executable":true,"value":"# model profile\nz=np.arange(0,80,1)\nk=0.4\nustar=0.01\neps_low=ustar**3/(k*z)\neps_low_2x=eps_low*2\neps_low_2s=eps_low*0.5","key":"AQOhJa4LKU"},{"type":"output","id":"Yzxuq9IGIJCGmvxgtO4ES","data":[{"name":"stderr","output_type":"stream","text":"/var/folders/1q/qmm9yg_90xl7f60v6q7wn2fr0000gn/T/ipykernel_9487/2175224984.py:5: RuntimeWarning: divide by zero encountered in divide\n  eps_low=ustar**3/(k*z)\n"}],"key":"DBFM1z9AgI"}],"key":"OK71ijlgPM"},{"type":"block","kind":"notebook-code","data":{},"children":[{"type":"code","lang":"python","executable":true,"value":"plt.figure()\n\nplt.plot(eps_low,z,c='k',label='law-of-the-wall')\nplt.plot(eps_low_2x,z,c='grey',ls='--')\nplt.plot(eps_low_2s,z,c='grey',ls='--')\n\n\nplt.plot(dat_wL4.EPSI_FINAL,dat_wL4.PRES,label='obs')\nplt.xscale('log')\nplt.ylim(80,0)\nplt.ylabel('z [m]')\nplt.xlabel('$\\epsilon$ [W kg$^{-1}$]')\nplt.legend()","key":"FX0Vm6L9oV"},{"type":"output","id":"mQUQwftm14snhZ1OYgZIQ","data":[{"name":"stderr","output_type":"stream","text":"<>:12: SyntaxWarning: invalid escape sequence '\\e'\n<>:12: SyntaxWarning: invalid escape sequence '\\e'\n/var/folders/1q/qmm9yg_90xl7f60v6q7wn2fr0000gn/T/ipykernel_9487/2234889368.py:12: SyntaxWarning: invalid escape sequence '\\e'\n  plt.xlabel('$\\epsilon$ [W kg$^{-1}$]')\n"},{"output_type":"display_data","metadata":{},"data":{"image/png":{"content_type":"image/png","hash":"86107443d41386fb5454a1f2ee5a8e9f","path":"/86107443d41386fb5454a1f2ee5a8e9f.png"},"text/plain":{"content":"<Figure size 640x480 with 1 Axes>","content_type":"text/plain"}}}],"key":"nFf2TXEayP"}],"key":"LT0vX1cvzd"}],"key":"liOCA6ETbg"},"references":{"cite":{"order":["lueck_best_2024","https://doi.org/10.5285/0e35f96f-57e3-540b-e063-6c86abc06660","lee_umlauf_2011","moum_comparison_1995","https://doi.org/10.5285/0ec16a65-abdf-2822-e063-6c86abc06533","giddy_vertical_2023"],"data":{"lueck_best_2024":{"label":"lueck_best_2024","enumerator":"1","doi":"10.3389/fmars.2024.1334327","html":"Lueck, R., Fer, I., Bluteau, C., Dengler, M., Holtermann, P., Inoue, R., LeBoyer, A., Nicholson, S.-A., Schulz, K., & Stevens, C. (2024). Best practices recommendations for estimating dissipation rates from shear probes. <i>Frontiers in Marine Science</i>, <i>11</i>, 1334327. <a target=\"_blank\" rel=\"noreferrer\" href=\"https://doi.org/10.3389/fmars.2024.1334327\">10.3389/fmars.2024.1334327</a>","url":"https://doi.org/10.3389/fmars.2024.1334327"},"https://doi.org/10.5285/0e35f96f-57e3-540b-e063-6c86abc06660":{"label":"https://doi.org/10.5285/0e35f96f-57e3-540b-e063-6c86abc06660","enumerator":"2","doi":"10.5285/0E35F96F-57E3-540B-E063-6C86ABC06660","html":"Holtermann, Peter. (2024). <i>ATOMIX shear probes benchmark data: data from a Sea and Sun Technology MSS microstructure profiler, western Baltic Sea.</i> NERC EDS British Oceanographic Data Centre NOC. <a target=\"_blank\" rel=\"noreferrer\" href=\"https://doi.org/10.5285/0E35F96F-57E3-540B-E063-6C86ABC06660\">10.5285/0E35F96F-57E3-540B-E063-6C86ABC06660</a>","url":"https://doi.org/10.5285/0E35F96F-57E3-540B-E063-6C86ABC06660"},"lee_umlauf_2011":{"label":"lee_umlauf_2011","enumerator":"3","doi":"10.1029/2011JC007072","html":"Van der Lee, E. M., & Umlauf, L. (2011). Internal wave mixing in the Baltic Sea: Near-inertial waves in the absence of tides. <i>Journal of Geophysical Research, Oceans</i>, <i>116</i>. <a target=\"_blank\" rel=\"noreferrer\" href=\"https://doi.org/10.1029/2011JC007072\">10.1029/2011JC007072</a>","url":"https://doi.org/10.1029/2011JC007072"},"moum_comparison_1995":{"label":"moum_comparison_1995","enumerator":"4","html":"Moum, J. N., Gregg, M. C., Lien, R. C., & Carr, M. E. (1995). Comparison of Turbulence Kinetic Energy Dissipation Rate Estimates from Two Ocean Microstructure Profilers. <i>Journal of Atmospheric and Oceanic Technology</i>, <i>12</i>(2), 346–366."},"https://doi.org/10.5285/0ec16a65-abdf-2822-e063-6c86abc06533":{"label":"https://doi.org/10.5285/0ec16a65-abdf-2822-e063-6c86abc06533","enumerator":"5","doi":"10.5285/0EC16A65-ABDF-2822-E063-6C86ABC06533","html":"Lueck, Rolf G. (2024). <i>ATOMIX shear probes benchmark data: a dissipation profile from Haro Strait, British Columbia, Canada obtained with a vertical microstructure profiler in October 2016.</i> NERC EDS British Oceanographic Data Centre NOC. <a target=\"_blank\" rel=\"noreferrer\" href=\"https://doi.org/10.5285/0EC16A65-ABDF-2822-E063-6C86ABC06533\">10.5285/0EC16A65-ABDF-2822-E063-6C86ABC06533</a>","url":"https://doi.org/10.5285/0EC16A65-ABDF-2822-E063-6C86ABC06533"},"giddy_vertical_2023":{"label":"giddy_vertical_2023","enumerator":"6","doi":"10.1175/JPO-D-22-0259.1","html":"Giddy, I. S., Fer, I., Swart, S., & Nicholson, S.-A. (2023). Vertical Convergence of Turbulent and Double-Diffusive Heat Flux Drives Warming and Erosion of Antarctic Winter Water in Summer. <i>Journal of Physical Oceanography</i>, <i>53</i>(8), 1941–1958. <a target=\"_blank\" rel=\"noreferrer\" href=\"https://doi.org/10.1175/JPO-D-22-0259.1\">10.1175/JPO-D-22-0259.1</a>","url":"https://doi.org/10.1175/JPO-D-22-0259.1"}}}}}